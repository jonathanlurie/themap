{"version":3,"sources":["node_modules/browser-pack/_prelude.js","package.json","src/index.js","src/leaflet.js","src/mapbox.js","src/geocoder_control.js","src/grid_control.js","src/feature_layer.js","src/legend_control.js","src/share_control.js","src/tile_layer.js","src/info_control.js","src/map.js","src/grid_layer.js","src/style_layer.js","src/geocoder.js","src/marker.js","src/simplestyle.js","src/config.js","src/feedback.js","src/util.js","src/format_url.js","src/request.js","src/load_tilejson.js","src/mapbox_logo.js","src/grid.js","node_modules/sanitize-caja/index.js","node_modules/mustache/mustache.js","node_modules/leaflet/dist/leaflet-src.js","node_modules/isarray/index.js","node_modules/sanitize-caja/sanitizer-bundle.js","node_modules/corslite/corslite.js"],"names":["leaflet","require","module","exports","window","L","geocoderControl","gridControl","featureLayer","legendControl","shareControl","tileLayer","infoControl","map","gridLayer","styleLayer","mapbox","VERSION","version","geocoder","marker","simplestyle","TileLayer","StyleLayer","InfoControl","ShareControl","LegendControl","GeocoderControl","GridControl","GridLayer","FeatureLayer","Map","config","sanitize","template","to_html","feedback","Icon","Default","imagePath","document","location","protocol","util","Control","extend","includes","Mixin","Events","options","proximity","position","pointZoom","keepOpen","autocomplete","queryOptions","initialize","_","Util","setOptions","this","setURL","_updateSubmit","bind","_updateAutocomplete","_chooseResult","accessToken","getURL","setID","setTileJSON","_toggle","e","DomEvent","stop","DomUtil","hasClass","_container","removeClass","_results","innerHTML","_input","blur","addClass","focus","select","_closeIfOpen","onAdd","container","create","link","results","wrap","form","input","href","type","setAttribute","addListener","_geocode","_autocomplete","disableClickPropagation","_map","_form","on","err","resp","fire","error","features","length","feature","_displayResults","i","l","Math","min","name","place_name","r","result","bbox","fitBounds","lbounds","center","setView","undefined","getZoom","max","preventDefault","value","query","getCenter","Mustache","pinnable","follow","sanitizer","touchTeaser","_currentContent","_pinned","strict_instance","Class","_layer","setTemplate","strict","_template","format","data","getTileJSON","d","_show","content","o","_popup","setContent","setLatLng","latLng","openOn","style","display","_contentWrapper","hide","closePopup","_mouseover","_mousemove","_navigateTo","url","top","_click","location_formatted","search","Browser","touch","_onPopupClose","_createClosebutton","fn","title","stopPropagation","contentWrapper","appendChild","Popup","autoPan","closeOnClick","onRemove","off","format_url","request","FeatureGroup","filter","popupOptions","closeButton","_layers","idUrl","setGeoJSON","_geojson","clearLayers","_initialize","getGeoJSON","loadURL","_request","abort","json","log","loadID","id","setFilter","getFilter","len","isArray","geometries","geometry","opts","pointToLayer","latlon","layer","GeoJSON","geometryToLayer","popupHtml","createPopup","defaultStyle","Circle","CircleMarker","setStyle","bindPopup","addLayer","_legends","_update","addLegend","text","removeLegend","hasOwnProperty","div","_loadTileJSON","_setTileJSON","_tilejson","_modal","_mask","_content","_shareClick","_clickOut","_sharing","createShareButton","buttonClass","socialMediaName","elem","createElement","createTextNode","tilejson","encodeURIComponent","webpage","image","lng","lat","embed","twitterURL","facebookURL","pinterestURL","embedValue","twitterButton","facebookButton","pinterestButton","shareHeader","shareText","shareButtons","close","target","formatPattern","formats","scalePrefix","prototype","call","strict_oneof","setFormat","redraw","setUrl","tiles","match","attribution","minZoom","minzoom","maxZoom","maxzoom","tms","scheme","bounds","getTileUrl","tilePoint","index","floor","abs","x","y","templated","replace","retina","_info","console","warn","_showInfo","getAttribution","addInfo","_onLayerAdd","_onLayerRemove","removeInfo","_active","_hidecontent","info","push","join","withAccessToken","mapboxLogoControl","LMap","element","attributionControl","setPrefix","compact","offsetWidth","addControl","_mapboxLogoControl","_updateMapFeedbackLink","whenReady","_updateLayer","legend","_loaded","zoom","_controlContainer","getElementsByClassName","hash","toFixed","key","_onLayerReady","setTimeout","addAttribution","stamp","_zoomBoundLayers","_updateZoomLevels","grid","_mouseOn","_cache","grids","active","addTo","_move","getData","latlng","callback","point","project","crs","scale","_getTile","gridX","gridY","_getTileURL","urls","getPixelBounds","z","tileBounds","divideBy","_floor","_tileShouldBeLoaded","callbacks","nwPoint","multiplyBy","sePoint","add","Point","nw","unproject","se","LatLngBounds","intersects","_formatTileURL","tileSize","zoomOffset","_getAttribution","styleURL","sources","source","split","tileJSON","indexOf","ownerIDStyle","owner","roundTo","precision","mult","pow","round","queryURL","isObject","parts","record","geocoding","types","country","res","reverseQuery","normalize","lon","q","pts","icon","fp","sizes","small","medium","large","size","symbol","color","iconUrl","charAt","iconSize","iconAnchor","popupAnchor","f","properties","strip_tags","popup","description","fallback","a","b","c","k","remap","mapping","defaults","stroke","stroke-width","stroke-opacity","fill","fill-opacity","HTTP_URL","HTTPS_URL","FORCE_HTTPS","REQUIRE_ACCESS_TOKEN","Feedback","contains","item","list","t","Error","klass","values","path","urlOrMapID","corslite","onload","JSON","parse","responseText","XMLHttpRequest","MapboxLogoControl","mapbox_logo","utfDecode","idx","charCodeAt","keys","cleanUrl","test","getScheme","toString","getPath","cleanId","html_sanitize","global","factory","nodeName","define","amd","mustache","isFunction","object","typeStr","obj","escapeRegExp","string","hasProperty","propName","testRegExp","re","regExpTest","isWhitespace","nonSpaceRe","escapeHtml","String","s","entityMap","parseTemplate","tags","compileTags","tagsToCompile","spaceRe","openingTagRe","RegExp","closingTagRe","closingCurlyRe","sections","tokens","spaces","hasTag","nonSpace","start","chr","token","openSection","scanner","Scanner","eos","pos","scanUntil","valueLength","pop","scan","tagRe","whiteRe","equalsRe","curlyRe","nestTokens","squashTokens","lastToken","squashedTokens","numTokens","section","nestedTokens","collector","tail","Context","view","parentContext","cache",".","parent","Writer","objectToString","Object","Array","&","<",">","\"","'","/","`","=","substring","lookup","names","context","lookupHit","clearCache","render","partials","renderTokens","originalTemplate","buffer","renderSection","renderInverted","renderPartial","unescapedValue","escapedValue","rawValue","subRender","self","j","slice","escape","defaultWriter","TypeError","send","oldL","noConflict","dest","src","arguments","args","apply","lastId","invokeEach","method","concat","limitExecByInterval","time","lock","execOnUnlock","wrapperFn","falseFn","formatNum","num","digits","trim","str","splitWords","getParamString","existingUrl","uppercase","params","toUpperCase","emptyImageUrl","getPrefixed","prefixes","timeoutDefer","Date","timeToCall","lastTime","requestFn","requestAnimationFrame","cancelFn","cancelAnimationFrame","clearTimeout","requestAnimFrame","immediate","cancelAnimFrame","props","NewClass","_initHooks","callInitHooks","F","proto","constructor","statics","__super__","_initHooksCalled","include","mergeOptions","addInitHook","init","eventsKey","addEventListener","event","indexKey","indexLenKey","typeIndex","events","contextId","action","hasEventListeners","removeEventListener","clearAllEventListeners","listeners","removed","splice","fireEvent","addOneTimeEventListener","handler","once","ie","ielt9","ua","navigator","userAgent","toLowerCase","webkit","chrome","phantomjs","android","android23","gecko","mobile","orientation","msPointer","PointerEvent","MSPointerEvent","pointer","pointerEnabled","devicePixelRatio","matchMedia","matches","doc","documentElement","ie3d","webkit3d","WebKitCSSMatrix","gecko3d","opera3d","any3d","L_DISABLE_3D","L_NO_TOUCH","DocumentTouch","opera","mobileWebkit","mobileWebkit3d","mobileOpera","clone","_add","subtract","_subtract","_divideBy","_multiplyBy","_round","distanceTo","sqrt","equals","Bounds","points","getBottomLeft","getTopRight","getSize","min2","max2","xIntersects","yIntersects","isValid","Transformation","_a","_b","_c","_d","transform","_transform","untransform","get","getElementById","getStyle","el","currentStyle","defaultView","css","getComputedStyle","getViewportOffset","left","docBody","body","docEl","offsetTop","offsetLeft","parseInt","offsetParent","scrollTop","scrollLeft","width","maxWidth","getBoundingClientRect","clientLeft","parentNode","documentIsLtr","_docIsLtrCached","_docIsLtr","tagName","className","classList","_getClass","classes","_setClass","remove","baseVal","setOpacity","opacity","filterName","filters","Enabled","Opacity","testProp","getTranslateString","is3d","open","getScaleString","origin","setPosition","disable3D","_leaflet_pos","TRANSFORM","getPosition","TRANSITION","TRANSITION_END","disableTextSelection","enableTextSelection","userSelectProperty","_userSelect","disableImageDrag","enableImageDrag","LatLng","alt","parseFloat","isNaN","DEG_TO_RAD","PI","RAD_TO_DEG","MAX_MARGIN","other","d2r","dLat","dLon","lat1","lat2","sin1","sin","sin2","cos","R","atan2","southWest","northEast","latlngs","latLngBounds","_southWest","_northEast","pad","bufferRatio","sw","ne","heightBuffer","widthBuffer","getSouthWest","getNorthEast","getNorthWest","getNorth","getWest","getSouthEast","getSouth","getEast","sw2","ne2","latIntersects","lngIntersects","toBBoxString","Projection","SphericalMercator","MAX_LATITUDE","tan","atan","exp","LonLat","CRS","latLngToPoint","projectedPoint","projection","transformation","pointToLatLng","untransformedPoint","Simple","EPSG3857","code","EPSG900913","EPSG4326","fadeAnimation","trackResize","markerZoomAnimation","_initContainer","_initLayout","_onResize","_initEvents","maxBounds","setMaxBounds","reset","_handlers","_tileLayersNum","_addLayers","layers","_resetView","_limitZoom","setZoom","_zoom","zoomIn","delta","zoomOut","setZoomAround","getZoomScale","viewHalf","containerPoint","latLngToContainerPoint","centerOffset","newCenter","containerPointToLatLng","getBounds","paddingTL","paddingTopLeft","padding","paddingBR","paddingBottomRight","getBoundsZoom","paddingOffset","swPoint","nePoint","fitWorld","panTo","pan","panBy","offset","_rawPanBy","_panInsideMaxBounds","panInsideBounds","_limitCenter","zoomAnimation","_tileLayersToLoad","_onTileLayerLoad","_layerAdd","removeLayer","hasLayer","eachLayer","invalidateSize","animate","oldSize","_sizeChanged","_initialCenter","newSize","oldCenter","debounceMoveend","_sizeTimer","addHandler","HandlerClass","enable","_leaflet","_clearPanes","_clearControlPos","_clearHandlers","_checkIfLoaded","_moved","layerPointToLatLng","_getCenterLayerPoint","getMinZoom","_layersMinZoom","getMaxZoom","_layersMaxZoom","Infinity","inside","boundsSize","zoomNotFound","_size","clientWidth","clientHeight","topLeftPoint","_getTopLeftPoint","getPixelOrigin","_initialTopLeftPoint","getPanes","_panes","getContainer","toZoom","getScaleZoom","LN2","latLngToLayerPoint","containerPointToLayerPoint","_getMapPanePos","layerPointToContainerPoint","layerPoint","mouseEventToContainerPoint","getMousePosition","mouseEventToLayerPoint","mouseEventToLatLng","_initPanes","_initControlPos","panes","_mapPane","mapPane","_createPane","_tilePane","tilePane","objectsPane","shadowPane","overlayPane","markerPane","popupPane","zoomHide","removeChild","preserveMapOffset","afterZoomAnim","zoomChanged","_getNewTopLeftPoint","loading","hard","_getZoomSpan","oldZoomSpan","onOff","_onMouseClick","_fireMouseEvent","_resizeRequest","_simulated","dragging","moved","boxZoom","_skipped","originalEvent","disable","_latLngToNewLayerPoint","newZoom","topLeft","_getCenterOffset","centerPoint","viewBounds","_getBoundsOffset","_limitOffset","newBounds","pxBounds","nwOffset","seOffset","dx","_rebound","dy","right","ceil","Mercator","R_MINOR","R_MAJOR","r2","tmp","eccent","con","ts","phi","dphi","EPSG3395","m","subdomains","errorTileUrl","unloadInvisibleTiles","updateWhenIdle","detectRetina","_url","_animated","_zoomAnimated","viewreset","_reset","moveend","zoomanim","_animateZoom","zoomend","_endZoomAnim","_limitedUpdate","bringToFront","pane","_setAutoZIndex","bringToBack","insertBefore","firstChild","_updateOpacity","setZIndex","zIndex","_updateZIndex","noRedraw","compare","children","edgeZIndex","isFinite","_tiles","_bgBuffer","_tileContainer","tile","_tilesToLoad","reuseTiles","_unusedTiles","_clearBgBuffer","_getTileSize","zoomN","maxNativeZoom","_addTilesFromCenterOut","_removeOtherTiles","queue","tilesToLoad","sort","fragment","createDocumentFragment","_addTile","continuousWorld","limit","_getWrapTileNum","noWrap","kArr","_removeTile","tilePos","_getTilePos","_loadTile","_getZoomForUrl","zoomReverse","_getSubdomain","_adjustTilePoint","_resetTile","_createTile","height","galleryimg","onselectstart","onmousemove","WebkitBackfaceVisibility","_tileOnLoad","onerror","_tileOnError","_tileLoaded","_clearBgBufferTimer","newUrl","WMS","defaultWmsParams","service","styles","transparent","wmsParams","_crs","_wmsVersion","projectionKey","setParams","wms","Canvas","async","_redrawTile","drawTile","_tilePoint","tileDrawn","canvas","ImageOverlay","_bounds","_image","_initImage","_onImageLoad","imageOverlay","createIcon","oldIcon","_createIcon","createShadow","_getIconUrl","img","_createImg","_setIconStyles","anchor","shadowAnchor","marginLeft","marginTop","shadowSize","scripts","getElementsByTagName","leafletRe","Marker","clickable","draggable","keyboard","zIndexOffset","riseOnHover","riseOffset","_latlng","update","_initIcon","_removeIcon","_removeShadow","getLatLng","setZIndexOffset","setIcon","_icon","_setPos","animation","classToAdd","addIcon","tabIndex","_initInteraction","_bringToFront","_resetZIndex","newShadow","_shadow","addShadow","_zIndex","opt","_onKeyPress","Handler","MarkerDrag","wasDragged","_enabled","keyCode","DivIcon","html","bgPos","backgroundPosition","divIcon","closePopupOnClick","minWidth","autoPanPadding","keepInView","_source","_isOpen","animFade","_getEvents","openPopup","_updatePosition","_adjustPan","getContent","visibility","_updateContent","_updateLayout","_zoomAnimation","preclick","_close","prefix","containerClass","_closeButton","_onCloseButtonClick","wrapper","_wrapper","_contentNode","disableScrollPropagation","_tipContainer","_tip","hasChildNodes","whiteSpace","offsetHeight","maxHeight","_containerWidth","animated","_containerBottom","_containerLeft","bottom","containerHeight","containerWidth","layerPos","containerPos","autoPanPaddingTopLeft","autoPanPaddingBottomRight","togglePopup","_popupHandlersAdded","_movePopup","setPopupContent","unbindPopup","getPopup","LayerGroup","getLayerId","invoke","methodName","getLayer","getLayers","layerGroup","EVENTS","_propagateEvent","_popupContent","_popupOptions","featureGroup","Path","CLIP_PADDING","outerWidth","outerHeight","dashArray","lineCap","lineJoin","weight","fillColor","fillOpacity","_initElements","projectLatlngs","_updatePath","_pathRoot","vml","_stroke","_fill","_updateStyle","_updatePathViewport","p","panePos","_pathViewport","SVG_NS","svg","createElementNS","createSVGRect","SVG","root","lastChild","first","getPathString","_createElement","_initPathRoot","_initPath","_initStyle","_path","pointerEvents","removeAttribute","_animatePathZoom","_endPathZoom","_updateSvgViewport","_pathZooming","vp","_openPopup","_latlngs","shape","behavior","adj","VML","namespaces","coordsize","stroked","filled","endcap","dashStyle","joinstyle","v","getContext","L_PREFER_CANVAS","CANVAS","_requestUpdate","_onClick","_onMouseMove","_updateRequest","_fireMapMoveEnd","_ctx","_canvasCtx","lineWidth","strokeStyle","fillStyle","_drawPath","len2","drawMethod","beginPath","_parts","Polygon","closePath","_checkIfEmpty","ctx","save","globalAlpha","fillRule","restore","_containsPoint","_animatingZoom","cursor","_mouseInside","_updateCanvasViewport","translate","LineUtil","simplify","tolerance","sqTolerance","_reducePoints","_simplifyDP","pointToSegmentDistance","p1","p2","_sqClosestPointOnSegment","closestPointOnSegment","ArrayConstructor","Uint8Array","markers","_simplifyDPStep","newPoints","last","sqDist","maxSqDist","reducedPoints","prev","_sqDist","clipSegment","useLastCode","codeOut","newCode","codeA","_lastCode","_getBitCode","codeB","_getEdgeIntersection","dot","Polyline","_convertLatLngs","smoothFactor","noClip","_originalPoints","_getPathPartStr","getLatLngs","setLatLngs","addLatLng","spliceLatLngs","closestLayerPoint","minDistance","minPoint","jLen","distance","overwrite","_clipPoints","segment","lu","_simplifyPoints","polyline","PolyUtil","clipPolygon","clippedPoints","edge","edges","_code","_initWithHoles","hole","_holes","_holePoints","newParts","clipped","polygon","createMulti","Klass","_options","MultiPolyline","MultiPolygon","multiPolyline","multiPolygon","Rectangle","_boundsToLatLngs","setBounds","rectangle","radius","_mRadius","setRadius","lngRadius","_getLngRadius","pointLeft","_point","_radius","latRadius","getRadius","_getLatRadius","circle","circleMarker","closed","part","w","arc","w2","geojson","addData","coordinates","coordsToLatLng","asFeature","defaultOptions","resetStyle","onEachFeature","_setLayerStyle","vectorOptions","coords","coordsToLatLngs","levelsDeep","latLngToCoords","latLngsToCoords","latLngs","getFeature","newGeometry","geoJSON","PointToGeoJSON","toGeoJSON","multiToGeoJSON","jsons","isGeometryCollection","geoJson","originalHandler","newType","_getEvent","addPointerListener","addDoubleTapListener","_checkMouse","_filterClick","attachEvent","removeListener","removePointerListener","removeDoubleTapListener","detachEvent","cancelBubble","Draggable","START","_fakeStop","returnValue","clientX","clientY","rect","clientTop","getWheelDelta","wheelDelta","detail","_skipEvents","skipped","related","relatedTarget","caller","callee","Event","timeStamp","elapsed","_lastClick","_simulatedClick","END","mousedown","touchstart","pointerdown","MSPointerDown","MOVE","dragStartTarget","_element","_dragStartTarget","_onDown","shiftKey","which","button","touches","_disabled","_moving","_startPoint","_startPos","_newPos","_onMove","_onUp","newPoint","_lastTarget","srcElement","_animRequest","addHooks","removeHooks","enabled","inertia","inertiaDeceleration","inertiaMaxSpeed","inertiaThreshold","easeLinearity","worldCopyJump","Drag","_draggable","dragstart","_onDragStart","drag","_onDrag","dragend","_onDragEnd","_onPreDrag","_onViewReset","_panAnim","_positions","_times","_lastTime","_lastPos","shift","pxCenter","pxWorldCenter","_initialWorldOffset","_worldWidth","worldWidth","halfWidth","newX1","newX2","newX","delay","noInertia","direction","duration","ease","speedVector","speed","limitedSpeed","limitedSpeedVector","decelerationDuration","noMoveStart","doubleClickZoom","DoubleClickZoom","_onDoubleClick","scrollWheelZoom","ScrollWheelZoom","_onWheelScroll","_delta","_lastMousePos","_startTime","_timer","_performZoom","_touchstart","_touchend","onTouchStart","count","trackedTouches","pointerId","now","doubleTap","onTouchEnd","prop","newTouch","touchend","endElement","POINTER_CANCEL","pre","POINTER_DOWN","POINTER_MOVE","POINTER_UP","_pointers","_pointerDocumentListener","addPointerListenerStart","addPointerListenerEnd","addPointerListenerMove","pointers","cb","pointerType","MSPOINTER_TYPE_MOUSE","alreadyInArray","changedTouches","internalCb","buttons","touchZoom","bounceAtZoomLimits","TouchZoom","_onTouchStart","_zooming","viewCenter","_startCenter","_startDist","_centerOffset","_onTouchMove","_onTouchEnd","_scale","_updateOnMove","_getScaleOrigin","oldZoom","floatZoomDelta","roundZoomDelta","tap","tapTolerance","Tap","_fireClick","_holdTimeout","_isTapValid","_simulateEvent","simulatedEvent","createEvent","initMouseEvent","screenX","screenY","dispatchEvent","BoxZoom","_pane","_onMouseDown","_startLayerPoint","_onMouseUp","_onKeyDown","_box","startPoint","box","newPos","_finish","boxZoomBounds","keyboardPanOffset","keyboardZoomOffset","Keyboard","keyCodes","down","up","_setPanOffset","_setZoomOffset","_onFocus","_onBlur","_addHooks","_removeHooks","_focused","scrollTo","_panKeys","codes","_zoomKeys","_inProgress","_marker","shadow","iconPos","removeControl","corner","_controlCorners","removeFrom","_refocusOnMap","control","createCorner","vSide","hSide","corners","Zoom","zoomInText","zoomInTitle","zoomOutText","zoomOutTitle","zoomName","_zoomInButton","_createButton","_zoomIn","_zoomOutButton","_zoomOut","_updateDisabled","zoomControl","Attribution","_attributions","removeAttribution","attribs","prefixAndAttribs","Scale","metric","imperial","_addScales","_mScale","_iScale","centerLat","halfWorldMeters","dist","maxMeters","_updateScales","_updateMetric","_updateImperial","meters","_getRoundNum","_getScaleWidth","maxMiles","miles","feet","maxFeet","ratio","pow10","Layers","collapsed","autoZIndex","baseLayers","overlays","_lastZIndex","_handlingClick","_addLayer","_onLayerChange","addBaseLayer","addOverlay","_expand","_collapse","_layersLink","_onInputClick","_baseLayersList","_separator","_overlaysList","overlay","baseLayersPresent","overlaysPresent","_addItem","_createRadioElement","checked","radioHtml","radioFragment","label","defaultChecked","layerId","inputs","inputsLen","PosAnimation","run","_el","_onTransitionEnd","_stepTimer","setInterval","_onStep","_getPos","stepPos","_transformRe","clearInterval","_tryAnimatedZoom","_tryAnimatedPan","step","_onPanTransitionStep","end","_onPanTransitionEnd","_duration","_easeOutPower","_offset","_animate","_step","_complete","_animId","_runFrame","_easeOut","progress","zoomAnimationThreshold","_catchTransitionEnd","propertyName","_onZoomTransitionEnd","_nothingToAnimate","backwards","forTouchZoom","_animateToCenter","_animateToZoom","_animating","_prepareBgBuffer","bg","initialTransform","scaleStr","front","bgLoaded","_getLoadedTilesPercentage","frontLoaded","_stopLoadingImages","complete","_defaultLocateOptions","watch","timeout","maximumAge","enableHighAccuracy","locate","_locateOptions","geolocation","_handleGeolocationError","message","onResponse","_handleGeolocationResponse","onError","_locationWatchId","watchPosition","getCurrentPosition","stopLocate","clearWatch","latitude","longitude","latAccuracy","accuracy","lngAccuracy","timestamp","arr","URI","uriStr","URI_RE_","nullIfAbsent","credentials","domain","port","uri","encodeIfExists2","URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_","encodeIfExists","URI_DISALLOWED_IN_PATH_","setRawQuery","encodeOne","setAllParameters","unescapedPart","extra","encodeURI","ch","n","normPath","collapse_dots","PARENT_DIRECTORY_HANDLER_RE","resolve","baseUri","relativeUri","absoluteUri","overridden","hasScheme","setRawScheme","getRawScheme","hasCredentials","setRawCredentials","getRawCredentials","hasDomain","setRawDomain","getRawDomain","hasPort","rawPath","getRawPath","simplifiedPath","setPort","getPort","EXTRA_PARENT_PATHS_RE","absRawPath","slash","lastIndexOf","setRawPath","hasQuery","getRawQuery","hasFragment","setRawFragment","getRawFragment","rawScheme","rawCredentials","rawDomain","rawQuery","rawFragment","scheme_","credentials_","domain_","port_","path_","query_","fragment_","paramCache_","matchPart","PARENT_DIRECTORY_HANDLER","out","decodeURIComponent","setScheme","newScheme","getCredentials","setCredentials","newCredentials","getDomain","setDomain","newDomain","newPort","Number","setPath","newPath","hasPath","getQuery","setQuery","newQuery","newParams","queryBuf","separator","checkParameterCache_","cgiParams","setParameterValues","newValueIndex","pc","removeParameter","getAllParameters","getParameterValues","paramNameUnescaped","getParameterMap","paramMap","getParameterValue","getFragment","setFragment","newFragment","utils","mimeTypeOf","base","html4","atype","NONE","URI_FRAGMENT","SCRIPT","STYLE","HTML","ID","IDREF","IDREFS","GLOBAL_NAME","LOCAL_NAME","CLASSES","FRAME_TARGET","MEDIA_QUERY","ATTRIBS","*::class","*::dir","*::draggable","*::hidden","*::id","*::inert","*::itemprop","*::itemref","*::itemscope","*::lang","*::onblur","*::onchange","*::onclick","*::ondblclick","*::onfocus","*::onkeydown","*::onkeypress","*::onkeyup","*::onload","*::onmousedown","*::onmousemove","*::onmouseout","*::onmouseover","*::onmouseup","*::onreset","*::onscroll","*::onselect","*::onsubmit","*::onunload","*::spellcheck","*::style","*::title","*::translate","a::accesskey","a::coords","a::href","a::hreflang","a::name","a::onblur","a::onfocus","a::shape","a::tabindex","a::target","a::type","area::accesskey","area::alt","area::coords","area::href","area::nohref","area::onblur","area::onfocus","area::shape","area::tabindex","area::target","audio::controls","audio::loop","audio::mediagroup","audio::muted","audio::preload","bdo::dir","blockquote::cite","br::clear","button::accesskey","button::disabled","button::name","button::onblur","button::onfocus","button::tabindex","button::type","button::value","canvas::height","canvas::width","caption::align","col::align","col::char","col::charoff","col::span","col::valign","col::width","colgroup::align","colgroup::char","colgroup::charoff","colgroup::span","colgroup::valign","colgroup::width","command::checked","command::command","command::disabled","command::icon","command::label","command::radiogroup","command::type","data::value","del::cite","del::datetime","details::open","dir::compact","div::align","dl::compact","fieldset::disabled","font::color","font::face","font::size","form::accept","form::action","form::autocomplete","form::enctype","form::method","form::name","form::novalidate","form::onreset","form::onsubmit","form::target","h1::align","h2::align","h3::align","h4::align","h5::align","h6::align","hr::align","hr::noshade","hr::size","hr::width","iframe::align","iframe::frameborder","iframe::height","iframe::marginheight","iframe::marginwidth","iframe::width","img::align","img::alt","img::border","img::height","img::hspace","img::ismap","img::name","img::src","img::usemap","img::vspace","img::width","input::accept","input::accesskey","input::align","input::alt","input::autocomplete","input::checked","input::disabled","input::inputmode","input::ismap","input::list","input::max","input::maxlength","input::min","input::multiple","input::name","input::onblur","input::onchange","input::onfocus","input::onselect","input::placeholder","input::readonly","input::required","input::size","input::src","input::step","input::tabindex","input::type","input::usemap","input::value","ins::cite","ins::datetime","label::accesskey","label::for","label::onblur","label::onfocus","legend::accesskey","legend::align","li::type","li::value","map::name","menu::compact","menu::label","menu::type","meter::high","meter::low","meter::max","meter::min","meter::value","ol::compact","ol::reversed","ol::start","ol::type","optgroup::disabled","optgroup::label","option::disabled","option::label","option::selected","option::value","output::for","output::name","p::align","pre::width","progress::max","progress::min","progress::value","q::cite","select::autocomplete","select::disabled","select::multiple","select::name","select::onblur","select::onchange","select::onfocus","select::required","select::size","select::tabindex","source::type","table::align","table::bgcolor","table::border","table::cellpadding","table::cellspacing","table::frame","table::rules","table::summary","table::width","tbody::align","tbody::char","tbody::charoff","tbody::valign","td::abbr","td::align","td::axis","td::bgcolor","td::char","td::charoff","td::colspan","td::headers","td::height","td::nowrap","td::rowspan","td::scope","td::valign","td::width","textarea::accesskey","textarea::autocomplete","textarea::cols","textarea::disabled","textarea::inputmode","textarea::name","textarea::onblur","textarea::onchange","textarea::onfocus","textarea::onselect","textarea::placeholder","textarea::readonly","textarea::required","textarea::rows","textarea::tabindex","textarea::wrap","tfoot::align","tfoot::char","tfoot::charoff","tfoot::valign","th::abbr","th::align","th::axis","th::bgcolor","th::char","th::charoff","th::colspan","th::headers","th::height","th::nowrap","th::rowspan","th::scope","th::valign","th::width","thead::align","thead::char","thead::charoff","thead::valign","tr::align","tr::bgcolor","tr::char","tr::charoff","tr::valign","track::default","track::kind","track::label","track::srclang","ul::compact","ul::type","video::controls","video::height","video::loop","video::mediagroup","video::muted","video::poster","video::preload","video::width","eflags","OPTIONAL_ENDTAG","EMPTY","CDATA","RCDATA","UNSAFE","FOLDABLE","VIRTUALIZED","ELEMENTS","abbr","acronym","address","applet","area","article","aside","audio","basefont","bdi","bdo","big","blockquote","br","caption","cite","col","colgroup","command","datalist","dd","del","details","dfn","dialog","dir","dl","dt","em","fieldset","figcaption","figure","font","footer","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","iframe","ins","isindex","kbd","keygen","li","mark","menu","meta","meter","nav","nobr","noembed","noframes","noscript","ol","optgroup","option","output","param","samp","script","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","tr","track","tt","u","ul","var","video","wbr","ELEMENT_DOM_INTERFACES","ueffects","NOT_LOADED","SAME_DOCUMENT","NEW_DOCUMENT","URIEFFECTS","ltypes","UNSANDBOXED","SANDBOXED","DATA","LOADERTYPES","lookupEntity","ENTITIES","decimalEscapeRe","fromCharCode","hexEscapeRe","entityLookupElement","safeEntityNameRe","textContent","decodeOneEntity","stripNULs","nulRe","unescapeEntities","ENTITY_RE_1","escapeAttrib","ampRe","ltRe","gtRe","quotRe","normalizeRCData","rcdata","looseAmpRe","makeSaxParser","hcopy","cdata","comment","endDoc","endTag","pcdata","startDoc","startTag","htmlText","parseCPS","htmlSplit","noMoreGT","noMoreEndComments","continuationMaker","h","initial","state","current","next","ENTITY_RE_2","continuationMarker","exec","parseEndTag","EFLAGS_TEXT","tag","parseText","parseStartTag","substr","splitWillCapture","lastPos","parseTagAndAttrs","attrs","endTagRe","buf","ATTR_RE","quote","sawQuote","abuf","aName","aValue","decodeValue","makeHtmlSanitizer","tagPolicy","stack","ignoring","emit","tagNameOrig","eflagsOrig","decision","eflagsRep","tagNameRep","onStack","orig","rep","attribName","stackElOrigTag","stackElRepTag","safeUri","effect","ltype","hints","naiveUriRewriter","parsed","ALLOWED_URI_SCHEMES","safe","logger","oldValue","newValue","change","changed","lookupAttribute","attribKey","getLoaderType","getUriEffect","sanitizeAttribs","opt_naiveUriRewriter","opt_nmTokenPolicy","opt_logger","parseCssDeclarations","sanitizedDeclarations","declaration","property","normProp","schema","cssSchema","sanitizeCssProperty","TYPE","CSS_PROP","XML_ATTR","XML_TAG","makeTagPolicy","sanitizeWithPolicy","inputHtml","outputArray","lt","LT","gt","GT","amp","AMP","quot","apos","nbsp","cors","isSuccessful","status","loaded","sent","XDomainRequest","original","that","onreadystatechange","readyState","evt","onprogress","ontimeout","onabort"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports={\"author\":\"Mapbox\",\"name\":\"mapbox.js\",\"description\":\"mapbox javascript api\",\"version\":\"2.4.0\",\"homepage\":\"http://mapbox.com/\",\"repository\":{\"type\":\"git\",\"url\":\"git://github.com/mapbox/mapbox.js.git\"},\"main\":\"src/index.js\",\"dependencies\":{\"corslite\":\"0.0.6\",\"isarray\":\"0.0.1\",\"leaflet\":\"0.7.7\",\"mustache\":\"2.2.1\",\"sanitize-caja\":\"0.1.3\"},\"scripts\":{\"test\":\"eslint --no-eslintrc -c .eslintrc src && mocha-phantomjs test/index.html\"},\"license\":\"BSD-3-Clause\",\"devDependencies\":{\"browserify\":\"^13.0.0\",\"clean-css\":\"~2.0.7\",\"eslint\":\"^0.23.0\",\"expect.js\":\"0.3.1\",\"happen\":\"0.1.3\",\"leaflet-fullscreen\":\"0.0.4\",\"leaflet-hash\":\"0.2.1\",\"marked\":\"~0.3.0\",\"minifyify\":\"^6.1.0\",\"minimist\":\"0.0.5\",\"mocha\":\"2.4.5\",\"mocha-phantomjs\":\"4.0.2\",\"sinon\":\"1.10.2\"},\"optionalDependencies\":{},\"engines\":{\"node\":\"*\"}}","'use strict';\n\nvar leaflet = require('./leaflet');\n\nrequire('./mapbox');\n\nmodule.exports = leaflet;\n","module.exports = window.L = require('leaflet/dist/leaflet-src');\n","'use strict';\n\nvar geocoderControl = require('./geocoder_control'),\n    gridControl = require('./grid_control'),\n    featureLayer = require('./feature_layer'),\n    legendControl = require('./legend_control'),\n    shareControl = require('./share_control'),\n    tileLayer = require('./tile_layer'),\n    infoControl = require('./info_control'),\n    map = require('./map'),\n    gridLayer = require('./grid_layer'),\n    styleLayer = require('./style_layer');\n\nL.mapbox = module.exports = {\n    VERSION: require('../package.json').version,\n    geocoder: require('./geocoder'),\n    marker: require('./marker'),\n    simplestyle: require('./simplestyle'),\n    tileLayer: tileLayer.tileLayer,\n    TileLayer: tileLayer.TileLayer,\n    styleLayer: styleLayer.styleLayer,\n    StyleLayer: styleLayer.StyleLayer,\n    infoControl: infoControl.infoControl,\n    InfoControl: infoControl.InfoControl,\n    shareControl: shareControl.shareControl,\n    ShareControl: shareControl.ShareControl,\n    legendControl: legendControl.legendControl,\n    LegendControl: legendControl.LegendControl,\n    geocoderControl: geocoderControl.geocoderControl,\n    GeocoderControl: geocoderControl.GeocoderControl,\n    gridControl: gridControl.gridControl,\n    GridControl: gridControl.GridControl,\n    gridLayer: gridLayer.gridLayer,\n    GridLayer: gridLayer.GridLayer,\n    featureLayer: featureLayer.featureLayer,\n    FeatureLayer: featureLayer.FeatureLayer,\n    map: map.map,\n    Map: map.Map,\n    config: require('./config'),\n    sanitize: require('sanitize-caja'),\n    template: require('mustache').to_html,\n    feedback: require('./feedback')\n};\n\n\n// Hardcode image path, because Leaflet's autodetection\n// fails, because mapbox.js is not named leaflet.js\nwindow.L.Icon.Default.imagePath =\n    // Detect bad-news protocols like file:// and hardcode\n    // to https if they're detected.\n    ((document.location.protocol === 'https:' ||\n    document.location.protocol === 'http:') ? '' : 'https:') +\n    '//api.tiles.mapbox.com/mapbox.js/' + 'v' +\n    require('../package.json').version + '/images';\n","'use strict';\n\nvar geocoder = require('./geocoder'),\n    util = require('./util');\n\nvar GeocoderControl = L.Control.extend({\n    includes: L.Mixin.Events,\n\n    options: {\n        proximity: true,\n        position: 'topleft',\n        pointZoom: 16,\n        keepOpen: false,\n        autocomplete: false,\n        queryOptions: {}\n    },\n\n    initialize: function(_, options) {\n        L.Util.setOptions(this, options);\n        this.setURL(_);\n        this._updateSubmit = L.bind(this._updateSubmit, this);\n        this._updateAutocomplete = L.bind(this._updateAutocomplete, this);\n        this._chooseResult = L.bind(this._chooseResult, this);\n    },\n\n    setURL: function(_) {\n        this.geocoder = geocoder(_, {\n            accessToken: this.options.accessToken\n        });\n        return this;\n    },\n\n    getURL: function() {\n        return this.geocoder.getURL();\n    },\n\n    setID: function(_) {\n        return this.setURL(_);\n    },\n\n    setTileJSON: function(_) {\n        return this.setURL(_.geocoder);\n    },\n\n    _toggle: function(e) {\n        if (e) L.DomEvent.stop(e);\n        if (L.DomUtil.hasClass(this._container, 'active')) {\n            L.DomUtil.removeClass(this._container, 'active');\n            this._results.innerHTML = '';\n            this._input.blur();\n        } else {\n            L.DomUtil.addClass(this._container, 'active');\n            this._input.focus();\n            this._input.select();\n        }\n    },\n\n    _closeIfOpen: function() {\n        if (L.DomUtil.hasClass(this._container, 'active') &&\n            !this.options.keepOpen) {\n            L.DomUtil.removeClass(this._container, 'active');\n            this._results.innerHTML = '';\n            this._input.blur();\n        }\n    },\n\n    onAdd: function(map) {\n\n        var container = L.DomUtil.create('div', 'leaflet-control-mapbox-geocoder leaflet-bar leaflet-control'),\n            link = L.DomUtil.create('a', 'leaflet-control-mapbox-geocoder-toggle mapbox-icon mapbox-icon-geocoder', container),\n            results = L.DomUtil.create('div', 'leaflet-control-mapbox-geocoder-results', container),\n            wrap = L.DomUtil.create('div', 'leaflet-control-mapbox-geocoder-wrap', container),\n            form = L.DomUtil.create('form', 'leaflet-control-mapbox-geocoder-form', wrap),\n            input = L.DomUtil.create('input', '', form);\n\n        link.href = '#';\n        link.innerHTML = '&nbsp;';\n\n        input.type = 'text';\n        input.setAttribute('placeholder', 'Search');\n\n        L.DomEvent.addListener(form, 'submit', this._geocode, this);\n        L.DomEvent.addListener(input, 'keyup', this._autocomplete, this);\n        L.DomEvent.disableClickPropagation(container);\n\n        this._map = map;\n        this._results = results;\n        this._input = input;\n        this._form = form;\n\n        if (this.options.keepOpen) {\n            L.DomUtil.addClass(container, 'active');\n        } else {\n            this._map.on('click', this._closeIfOpen, this);\n            L.DomEvent.addListener(link, 'click', this._toggle, this);\n        }\n\n        return container;\n    },\n\n    _updateSubmit: function(err, resp) {\n        L.DomUtil.removeClass(this._container, 'searching');\n        this._results.innerHTML = '';\n        if (err || !resp) {\n            this.fire('error', {error: err});\n        } else {\n            var features = [];\n            if (resp.results && resp.results.features) {\n                features = resp.results.features;\n            }\n            if (features.length === 1) {\n                this.fire('autoselect', { feature: features[0] });\n                this.fire('found', {results: resp.results});\n                this._chooseResult(features[0]);\n                this._closeIfOpen();\n            } else if (features.length > 1) {\n                this.fire('found', {results: resp.results});\n                this._displayResults(features);\n            } else {\n                this.fire('notfound');\n                this._displayResults(features);\n            }\n        }\n    },\n\n    _updateAutocomplete: function(err, resp) {\n        this._results.innerHTML = '';\n        if (err || !resp) {\n            this.fire('error', {error: err});\n        } else {\n            var features = [];\n            if (resp.results && resp.results.features) {\n                features = resp.results.features;\n            }\n            if (features.length) {\n                this.fire('found', {results: resp.results});\n            } else {\n                this.fire('notfound');\n            }\n            this._displayResults(features);\n        }\n    },\n\n    _displayResults: function(features) {\n        for (var i = 0, l = Math.min(features.length, 5); i < l; i++) {\n            var feature = features[i];\n            var name = feature.place_name;\n            if (!name.length) continue;\n\n            var r = L.DomUtil.create('a', '', this._results);\n            var text = ('innerText' in r) ? 'innerText' : 'textContent';\n            r[text] = name;\n            r.setAttribute('title', name);\n            r.href = '#';\n\n            (L.bind(function(feature) {\n                L.DomEvent.addListener(r, 'click', function(e) {\n                    this._chooseResult(feature);\n                    L.DomEvent.stop(e);\n                    this.fire('select', { feature: feature });\n                }, this);\n            }, this))(feature);\n        }\n        if (features.length > 5) {\n            var outof = L.DomUtil.create('span', '', this._results);\n            outof.innerHTML = 'Top 5 of ' + features.length + '  results';\n        }\n    },\n\n    _chooseResult: function(result) {\n        if (result.bbox) {\n            this._map.fitBounds(util.lbounds(result.bbox));\n        } else if (result.center) {\n            this._map.setView([result.center[1], result.center[0]], (this._map.getZoom() === undefined) ?\n                this.options.pointZoom :\n                Math.max(this._map.getZoom(), this.options.pointZoom));\n        }\n    },\n\n    _geocode: function(e) {\n        L.DomEvent.preventDefault(e);\n        if (this._input.value === '') return this._updateSubmit();\n        L.DomUtil.addClass(this._container, 'searching');\n        this.geocoder.query(L.Util.extend({\n            query: this._input.value,\n            proximity: this.options.proximity ? this._map.getCenter() : false\n        }, this.options.queryOptions), this._updateSubmit);\n    },\n\n    _autocomplete: function() {\n        if (!this.options.autocomplete) return;\n        if (this._input.value === '') return this._updateAutocomplete();\n        this.geocoder.query(L.Util.extend({\n            query: this._input.value,\n            proximity: this.options.proximity ? this._map.getCenter() : false\n        }, this.options.queryOptions), this._updateAutocomplete);\n    }\n});\n\nmodule.exports.GeocoderControl = GeocoderControl;\n\nmodule.exports.geocoderControl = function(_, options) {\n    return new GeocoderControl(_, options);\n};\n","'use strict';\n\nvar util = require('./util'),\n    Mustache = require('mustache');\n\nvar GridControl = L.Control.extend({\n\n    options: {\n        pinnable: true,\n        follow: false,\n        sanitizer: require('sanitize-caja'),\n        touchTeaser: true,\n        location: true\n    },\n\n    _currentContent: '',\n\n    // pinned means that this control is on a feature and the user has likely\n    // clicked. pinned will not become false unless the user clicks off\n    // of the feature onto another or clicks x\n    _pinned: false,\n\n    initialize: function(_, options) {\n        L.Util.setOptions(this, options);\n        util.strict_instance(_, L.Class, 'L.mapbox.gridLayer');\n        this._layer = _;\n    },\n\n    setTemplate: function(template) {\n        util.strict(template, 'string');\n        this.options.template = template;\n        return this;\n    },\n\n    _template: function(format, data) {\n        if (!data) return;\n        var template = this.options.template || this._layer.getTileJSON().template;\n        if (template) {\n            var d = {};\n            d['__' + format + '__'] = true;\n            return this.options.sanitizer(\n                Mustache.to_html(template, L.extend(d, data)));\n        }\n    },\n\n    // change the content of the tooltip HTML if it has changed, otherwise\n    // noop\n    _show: function(content, o) {\n        if (content === this._currentContent) return;\n\n        this._currentContent = content;\n\n        if (this.options.follow) {\n            this._popup.setContent(content)\n                .setLatLng(o.latLng);\n            if (this._map._popup !== this._popup) this._popup.openOn(this._map);\n        } else {\n            this._container.style.display = 'block';\n            this._contentWrapper.innerHTML = content;\n        }\n    },\n\n    hide: function() {\n        this._pinned = false;\n        this._currentContent = '';\n\n        this._map.closePopup();\n        this._container.style.display = 'none';\n        this._contentWrapper.innerHTML = '';\n\n        L.DomUtil.removeClass(this._container, 'closable');\n\n        return this;\n    },\n\n    _mouseover: function(o) {\n        if (o.data) {\n            L.DomUtil.addClass(this._map._container, 'map-clickable');\n        } else {\n            L.DomUtil.removeClass(this._map._container, 'map-clickable');\n        }\n\n        if (this._pinned) return;\n\n        var content = this._template('teaser', o.data);\n        if (content) {\n            this._show(content, o);\n        } else {\n            this.hide();\n        }\n    },\n\n    _mousemove: function(o) {\n        if (this._pinned) return;\n        if (!this.options.follow) return;\n\n        this._popup.setLatLng(o.latLng);\n    },\n\n    _navigateTo: function(url) {\n        window.top.location.href = url;\n    },\n\n    _click: function(o) {\n\n        var location_formatted = this._template('location', o.data);\n        if (this.options.location && location_formatted &&\n            location_formatted.search(/^https?:/) === 0) {\n            return this._navigateTo(this._template('location', o.data));\n        }\n\n        if (!this.options.pinnable) return;\n\n        var content = this._template('full', o.data);\n\n        if (!content && this.options.touchTeaser && L.Browser.touch) {\n            content = this._template('teaser', o.data);\n        }\n\n        if (content) {\n            L.DomUtil.addClass(this._container, 'closable');\n            this._pinned = true;\n            this._show(content, o);\n        } else if (this._pinned) {\n            L.DomUtil.removeClass(this._container, 'closable');\n            this._pinned = false;\n            this.hide();\n        }\n    },\n\n    _onPopupClose: function() {\n        this._currentContent = null;\n        this._pinned = false;\n    },\n\n    _createClosebutton: function(container, fn) {\n        var link = L.DomUtil.create('a', 'close', container);\n\n        link.innerHTML = 'close';\n        link.href = '#';\n        link.title = 'close';\n\n        L.DomEvent\n            .on(link, 'click', L.DomEvent.stopPropagation)\n            .on(link, 'mousedown', L.DomEvent.stopPropagation)\n            .on(link, 'dblclick', L.DomEvent.stopPropagation)\n            .on(link, 'click', L.DomEvent.preventDefault)\n            .on(link, 'click', fn, this);\n\n        return link;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n\n        var className = 'leaflet-control-grid map-tooltip',\n            container = L.DomUtil.create('div', className),\n            contentWrapper = L.DomUtil.create('div', 'map-tooltip-content');\n\n        // hide the container element initially\n        container.style.display = 'none';\n        this._createClosebutton(container, this.hide);\n        container.appendChild(contentWrapper);\n\n        this._contentWrapper = contentWrapper;\n        this._popup = new L.Popup({ autoPan: false, closeOnClick: false });\n\n        map.on('popupclose', this._onPopupClose, this);\n\n        L.DomEvent\n            .disableClickPropagation(container)\n            // allow people to scroll tooltips with mousewheel\n            .addListener(container, 'mousewheel', L.DomEvent.stopPropagation);\n\n        this._layer\n            .on('mouseover', this._mouseover, this)\n            .on('mousemove', this._mousemove, this)\n            .on('click', this._click, this);\n\n        return container;\n    },\n\n    onRemove: function (map) {\n\n        map.off('popupclose', this._onPopupClose, this);\n\n        this._layer\n            .off('mouseover', this._mouseover, this)\n            .off('mousemove', this._mousemove, this)\n            .off('click', this._click, this);\n    }\n});\n\nmodule.exports.GridControl = GridControl;\n\nmodule.exports.gridControl = function(_, options) {\n    return new GridControl(_, options);\n};\n","'use strict';\n\nvar util = require('./util'),\n    format_url = require('./format_url'),\n    request = require('./request'),\n    marker = require('./marker'),\n    simplestyle = require('./simplestyle');\n\n// # featureLayer\n//\n// A layer of features, loaded from Mapbox or else. Adds the ability\n// to reset features, filter them, and load them from a GeoJSON URL.\nvar FeatureLayer = L.FeatureGroup.extend({\n    options: {\n        filter: function() { return true; },\n        sanitizer: require('sanitize-caja'),\n        style: simplestyle.style,\n        popupOptions: { closeButton: false }\n    },\n\n    initialize: function(_, options) {\n        L.setOptions(this, options);\n\n        this._layers = {};\n\n        if (typeof _ === 'string') {\n            util.idUrl(_, this);\n        // javascript object of TileJSON data\n        } else if (_ && typeof _ === 'object') {\n            this.setGeoJSON(_);\n        }\n    },\n\n    setGeoJSON: function(_) {\n        this._geojson = _;\n        this.clearLayers();\n        this._initialize(_);\n        return this;\n    },\n\n    getGeoJSON: function() {\n        return this._geojson;\n    },\n\n    loadURL: function(url) {\n        if (this._request && 'abort' in this._request) this._request.abort();\n        this._request = request(url, L.bind(function(err, json) {\n            this._request = null;\n            if (err && err.type !== 'abort') {\n                util.log('could not load features at ' + url);\n                this.fire('error', {error: err});\n            } else if (json) {\n                this.setGeoJSON(json);\n                this.fire('ready');\n            }\n        }, this));\n        return this;\n    },\n\n    loadID: function(id) {\n        return this.loadURL(format_url('/v4/' + id + '/features.json', this.options.accessToken));\n    },\n\n    setFilter: function(_) {\n        this.options.filter = _;\n        if (this._geojson) {\n            this.clearLayers();\n            this._initialize(this._geojson);\n        }\n        return this;\n    },\n\n    getFilter: function() {\n        return this.options.filter;\n    },\n\n    _initialize: function(json) {\n        var features = L.Util.isArray(json) ? json : json.features,\n            i, len;\n\n        if (features) {\n            for (i = 0, len = features.length; i < len; i++) {\n                // Only add this if geometry or geometries are set and not null\n                if (features[i].geometries || features[i].geometry || features[i].features) {\n                    this._initialize(features[i]);\n                }\n            }\n        } else if (this.options.filter(json)) {\n\n            var opts = {accessToken: this.options.accessToken},\n                pointToLayer = this.options.pointToLayer || function(feature, latlon) {\n                  return marker.style(feature, latlon, opts);\n                },\n                layer = L.GeoJSON.geometryToLayer(json, pointToLayer),\n                popupHtml = marker.createPopup(json, this.options.sanitizer),\n                style = this.options.style,\n                defaultStyle = style === simplestyle.style;\n\n            if (style && 'setStyle' in layer &&\n                // if the style method is the simplestyle default, then\n                // never style L.Circle or L.CircleMarker because\n                // simplestyle has no rules over them, only over geometry\n                // primitives directly from GeoJSON\n                (!(defaultStyle && (layer instanceof L.Circle ||\n                  layer instanceof L.CircleMarker)))) {\n                if (typeof style === 'function') {\n                    style = style(json);\n                }\n                layer.setStyle(style);\n            }\n\n            layer.feature = json;\n\n            if (popupHtml) {\n                layer.bindPopup(popupHtml, this.options.popupOptions);\n            }\n\n            this.addLayer(layer);\n        }\n    }\n});\n\nmodule.exports.FeatureLayer = FeatureLayer;\n\nmodule.exports.featureLayer = function(_, options) {\n    return new FeatureLayer(_, options);\n};\n","'use strict';\n\nvar LegendControl = L.Control.extend({\n\n    options: {\n        position: 'bottomright',\n        sanitizer: require('sanitize-caja')\n    },\n\n    initialize: function(options) {\n        L.setOptions(this, options);\n        this._legends = {};\n    },\n\n    onAdd: function() {\n        this._container = L.DomUtil.create('div', 'map-legends wax-legends');\n        L.DomEvent.disableClickPropagation(this._container);\n\n        this._update();\n\n        return this._container;\n    },\n\n    addLegend: function(text) {\n        if (!text) { return this; }\n\n        if (!this._legends[text]) {\n            this._legends[text] = 0;\n        }\n\n        this._legends[text]++;\n        return this._update();\n    },\n\n    removeLegend: function(text) {\n        if (!text) { return this; }\n        if (this._legends[text]) this._legends[text]--;\n        return this._update();\n    },\n\n    _update: function() {\n        if (!this._map) { return this; }\n\n        this._container.innerHTML = '';\n        var hide = 'none';\n\n        for (var i in this._legends) {\n            if (this._legends.hasOwnProperty(i) && this._legends[i]) {\n                var div = L.DomUtil.create('div', 'map-legend wax-legend', this._container);\n                div.innerHTML = this.options.sanitizer(i);\n                hide = 'block';\n            }\n        }\n\n        // hide the control entirely unless there is at least one legend;\n        // otherwise there will be a small grey blemish on the map.\n        this._container.style.display = hide;\n\n        return this;\n    }\n});\n\nmodule.exports.LegendControl = LegendControl;\n\nmodule.exports.legendControl = function(options) {\n    return new LegendControl(options);\n};\n","'use strict';\n\nvar format_url = require('./format_url');\n\nvar ShareControl = L.Control.extend({\n    includes: [require('./load_tilejson')],\n\n    options: {\n        position: 'topleft',\n        url: ''\n    },\n\n    initialize: function(_, options) {\n        L.setOptions(this, options);\n        this._loadTileJSON(_);\n    },\n\n    _setTileJSON: function(json) {\n        this._tilejson = json;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n\n        var container = L.DomUtil.create('div', 'leaflet-control-mapbox-share leaflet-bar');\n        var link = L.DomUtil.create('a', 'mapbox-share mapbox-icon mapbox-icon-share', container);\n        link.href = '#';\n\n        this._modal = L.DomUtil.create('div', 'mapbox-modal', this._map._container);\n        this._mask = L.DomUtil.create('div', 'mapbox-modal-mask', this._modal);\n        this._content = L.DomUtil.create('div', 'mapbox-modal-content', this._modal);\n\n        L.DomEvent.addListener(link, 'click', this._shareClick, this);\n        L.DomEvent.disableClickPropagation(container);\n\n        this._map.on('mousedown', this._clickOut, this);\n\n        return container;\n    },\n\n    _clickOut: function(e) {\n        if (this._sharing) {\n            L.DomEvent.preventDefault(e);\n            L.DomUtil.removeClass(this._modal, 'active');\n            this._content.innerHTML = '';\n            this._sharing = null;\n            return;\n        }\n    },\n\n    _shareClick: function(e) {\n        L.DomEvent.stop(e);\n        if (this._sharing) return this._clickOut(e);\n\n        var tilejson = this._tilejson || this._map._tilejson || {},\n            url = encodeURIComponent(this.options.url || tilejson.webpage || window.location),\n            name = encodeURIComponent(tilejson.name),\n            image = format_url('/v4/' + tilejson.id + '/' + this._map.getCenter().lng + ',' + this._map.getCenter().lat + ',' + this._map.getZoom() + '/600x600.png', this.options.accessToken),\n            embed = format_url('/v4/' + tilejson.id + '.html', this.options.accessToken),\n            twitterURL = '//twitter.com/intent/tweet?status=' + name + ' ' + url,\n            facebookURL = '//www.facebook.com/sharer.php?u=' + url + '&t=' + name,\n            pinterestURL = '//www.pinterest.com/pin/create/button/?url=' + url + '&media=' + image + '&description=' + name,\n            embedValue = '<iframe width=\"100%\" height=\"500px\" frameBorder=\"0\" src=\"' + embed + '\"></iframe>',\n            embedLabel = 'Copy and paste this <strong>HTML code</strong> into documents to embed this map on web pages.';\n\n        function createShareButton(buttonClass, href, socialMediaName) {\n            var elem = document.createElement('a');\n            elem.setAttribute('class', buttonClass);\n            elem.setAttribute('href', href);\n            elem.setAttribute('target', '_blank');\n            socialMediaName = document.createTextNode(socialMediaName);\n            elem.appendChild(socialMediaName);\n\n            return elem;\n        }\n\n        L.DomUtil.addClass(this._modal, 'active');\n\n        this._sharing = L.DomUtil.create('div', 'mapbox-modal-body', this._content);\n\n        var twitterButton = createShareButton('mapbox-button mapbox-button-icon mapbox-icon-twitter', twitterURL, 'Twitter');\n        var facebookButton = createShareButton('mapbox-button mapbox-button-icon mapbox-icon-facebook', facebookURL, 'Facebook');\n        var pinterestButton = createShareButton('mapbox-button mapbox-button-icon mapbox-icon-pinterest', pinterestURL, 'Pinterest');\n\n        var shareHeader = document.createElement('h3');\n        var shareText = document.createTextNode('Share this map');\n        shareHeader.appendChild(shareText);\n\n        var shareButtons = document.createElement('div');\n        shareButtons.setAttribute('class', 'mapbox-share-buttons');\n        shareButtons.appendChild(facebookButton);\n        shareButtons.appendChild(twitterButton);\n        shareButtons.appendChild(pinterestButton);\n\n        this._sharing.appendChild(shareHeader);\n        this._sharing.appendChild(shareButtons);\n\n        var input = L.DomUtil.create('input', 'mapbox-embed', this._sharing);\n        input.type = 'text';\n        input.value = embedValue;\n\n        var label = L.DomUtil.create('label', 'mapbox-embed-description', this._sharing);\n        label.innerHTML = embedLabel;\n\n        var close = L.DomUtil.create('a', 'leaflet-popup-close-button', this._sharing);\n        close.href = '#';\n\n        L.DomEvent.disableClickPropagation(this._sharing);\n        L.DomEvent.addListener(close, 'click', this._clickOut, this);\n        L.DomEvent.addListener(input, 'click', function(e) {\n            e.target.focus();\n            e.target.select();\n        });\n    }\n});\n\nmodule.exports.ShareControl = ShareControl;\n\nmodule.exports.shareControl = function(_, options) {\n    return new ShareControl(_, options);\n};\n","'use strict';\n\nvar util = require('./util');\nvar formatPattern = /\\.((?:png|jpg)\\d*)(?=$|\\?)/;\n\nvar TileLayer = L.TileLayer.extend({\n    includes: [require('./load_tilejson')],\n\n    options: {\n        sanitizer: require('sanitize-caja')\n    },\n\n    // http://mapbox.com/developers/api/#image_quality\n    formats: [\n        'png', 'jpg',\n        // PNG\n        'png32', 'png64', 'png128', 'png256',\n        // JPG\n        'jpg70', 'jpg80', 'jpg90'],\n\n    scalePrefix: '@2x.',\n\n    initialize: function(_, options) {\n        L.TileLayer.prototype.initialize.call(this, undefined, options);\n\n        this._tilejson = {};\n\n        if (options && options.format) {\n            util.strict_oneof(options.format, this.formats);\n        }\n\n        this._loadTileJSON(_);\n    },\n\n    setFormat: function(_) {\n        util.strict(_, 'string');\n        this.options.format = _;\n        this.redraw();\n        return this;\n    },\n\n    // disable the setUrl function, which is not available on mapbox tilelayers\n    setUrl: null,\n\n    _setTileJSON: function(json) {\n        util.strict(json, 'object');\n\n        this.options.format = this.options.format ||\n            json.tiles[0].match(formatPattern)[1];\n\n        L.extend(this.options, {\n            tiles: json.tiles,\n            attribution: this.options.sanitizer(json.attribution),\n            minZoom: json.minzoom || 0,\n            maxZoom: json.maxzoom || 18,\n            tms: json.scheme === 'tms',\n            bounds: json.bounds && util.lbounds(json.bounds)\n        });\n\n        this._tilejson = json;\n        this.redraw();\n        return this;\n    },\n\n    getTileJSON: function() {\n        return this._tilejson;\n    },\n\n    // this is an exception to mapbox.js naming rules because it's called\n    // by `L.map`\n    getTileUrl: function(tilePoint) {\n        var tiles = this.options.tiles,\n            index = Math.floor(Math.abs(tilePoint.x + tilePoint.y) % tiles.length),\n            url = tiles[index];\n\n        var templated = L.Util.template(url, tilePoint);\n        if (!templated) {\n            return templated;\n        } else {\n            return templated.replace(formatPattern,\n                (L.Browser.retina ? this.scalePrefix : '.') + this.options.format);\n        }\n    },\n\n    // TileJSON.TileLayers are added to the map immediately, so that they get\n    // the desired z-index, but do not update until the TileJSON has been loaded.\n    _update: function() {\n        if (this.options.tiles) {\n            L.TileLayer.prototype._update.call(this);\n        }\n    }\n});\n\nmodule.exports.TileLayer = TileLayer;\n\nmodule.exports.tileLayer = function(_, options) {\n    return new TileLayer(_, options);\n};\n","'use strict';\n\nvar InfoControl = L.Control.extend({\n    options: {\n        position: 'bottomright',\n        sanitizer: require('sanitize-caja')\n    },\n\n    initialize: function(options) {\n        L.setOptions(this, options);\n        this._info = {};\n        console.warn('infoControl has been deprecated and will be removed in mapbox.js v3.0.0. Use the default attribution control instead, which is now responsive.');\n    },\n\n    onAdd: function(map) {\n        this._container = L.DomUtil.create('div', 'mapbox-control-info mapbox-small');\n        this._content = L.DomUtil.create('div', 'map-info-container', this._container);\n\n        var link = L.DomUtil.create('a', 'mapbox-info-toggle mapbox-icon mapbox-icon-info', this._container);\n        link.href = '#';\n\n        L.DomEvent.addListener(link, 'click', this._showInfo, this);\n        L.DomEvent.disableClickPropagation(this._container);\n\n        for (var i in map._layers) {\n            if (map._layers[i].getAttribution) {\n                this.addInfo(map._layers[i].getAttribution());\n            }\n        }\n\n        map\n            .on('layeradd', this._onLayerAdd, this)\n            .on('layerremove', this._onLayerRemove, this);\n\n        this._update();\n        return this._container;\n    },\n\n    onRemove: function(map) {\n        map\n            .off('layeradd', this._onLayerAdd, this)\n            .off('layerremove', this._onLayerRemove, this);\n    },\n\n    addInfo: function(text) {\n        if (!text) return this;\n        if (!this._info[text]) this._info[text] = 0;\n        this._info[text] = true;\n        return this._update();\n    },\n\n    removeInfo: function (text) {\n        if (!text) return this;\n        if (this._info[text]) this._info[text] = false;\n        return this._update();\n    },\n\n    _showInfo: function(e) {\n        L.DomEvent.preventDefault(e);\n        if (this._active === true) return this._hidecontent();\n\n        L.DomUtil.addClass(this._container, 'active');\n        this._active = true;\n        this._update();\n    },\n\n    _hidecontent: function() {\n        this._content.innerHTML = '';\n        this._active = false;\n        L.DomUtil.removeClass(this._container, 'active');\n        return;\n    },\n\n    _update: function() {\n        if (!this._map) { return this; }\n        this._content.innerHTML = '';\n        var hide = 'none';\n        var info = [];\n\n        for (var i in this._info) {\n            if (this._info.hasOwnProperty(i) && this._info[i]) {\n                info.push(this.options.sanitizer(i));\n                hide = 'block';\n            }\n        }\n\n        this._content.innerHTML += info.join(' | ');\n\n        // If there are no results in _info then hide this.\n        this._container.style.display = hide;\n        return this;\n    },\n\n    _onLayerAdd: function(e) {\n        if (e.layer.getAttribution && e.layer.getAttribution()) {\n            this.addInfo(e.layer.getAttribution());\n        } else if ('on' in e.layer && e.layer.getAttribution) {\n            e.layer.on('ready', L.bind(function() {\n                this.addInfo(e.layer.getAttribution());\n            }, this));\n        }\n    },\n\n    _onLayerRemove: function (e) {\n        if (e.layer.getAttribution) {\n            this.removeInfo(e.layer.getAttribution());\n        }\n    }\n});\n\nmodule.exports.InfoControl = InfoControl;\n\nmodule.exports.infoControl = function(options) {\n    return new InfoControl(options);\n};\n","'use strict';\n\nvar tileLayer = require('./tile_layer').tileLayer,\n    featureLayer = require('./feature_layer').featureLayer,\n    gridLayer = require('./grid_layer').gridLayer,\n    gridControl = require('./grid_control').gridControl,\n    infoControl = require('./info_control').infoControl,\n    shareControl = require('./share_control').shareControl,\n    legendControl = require('./legend_control').legendControl,\n    mapboxLogoControl = require('./mapbox_logo').mapboxLogoControl,\n    feedback = require('./feedback');\n\nfunction withAccessToken(options, accessToken) {\n    if (!accessToken || options.accessToken)\n        return options;\n    return L.extend({accessToken: accessToken}, options);\n}\n\nvar LMap = L.Map.extend({\n    includes: [require('./load_tilejson')],\n\n    options: {\n        tileLayer: {},\n        featureLayer: {},\n        gridLayer: {},\n        legendControl: {},\n        gridControl: {},\n        infoControl: false,\n        shareControl: false,\n        sanitizer: require('sanitize-caja')\n    },\n\n    _tilejson: {},\n\n    initialize: function(element, _, options) {\n\n        L.Map.prototype.initialize.call(this, element,\n            L.extend({}, L.Map.prototype.options, options));\n\n        // Disable the default 'Leaflet' text\n        if (this.attributionControl) {\n            this.attributionControl.setPrefix('');\n\n            var compact = this.options.attributionControl.compact;\n            // Set a compact display if map container width is < 640 or\n            // compact is set to `true` in attributionControl options.\n            if (compact || (compact !== false && this._container.offsetWidth <= 640)) {\n                L.DomUtil.addClass(this.attributionControl._container, 'leaflet-compact-attribution');\n            }\n\n            if (compact === undefined) {\n                this.on('resize', function() {\n                    if (this._container.offsetWidth > 640) {\n                        L.DomUtil.removeClass(this.attributionControl._container, 'leaflet-compact-attribution');\n                    } else {\n                        L.DomUtil.addClass(this.attributionControl._container, 'leaflet-compact-attribution');\n                    }\n                });\n            }\n        }\n\n        if (this.options.tileLayer) {\n            this.tileLayer = tileLayer(undefined,\n                withAccessToken(this.options.tileLayer, this.options.accessToken));\n            this.addLayer(this.tileLayer);\n        }\n\n        if (this.options.featureLayer) {\n            this.featureLayer = featureLayer(undefined,\n                withAccessToken(this.options.featureLayer, this.options.accessToken));\n            this.addLayer(this.featureLayer);\n        }\n\n        if (this.options.gridLayer) {\n            this.gridLayer = gridLayer(undefined,\n                withAccessToken(this.options.gridLayer, this.options.accessToken));\n            this.addLayer(this.gridLayer);\n        }\n\n        if (this.options.gridLayer && this.options.gridControl) {\n            this.gridControl = gridControl(this.gridLayer, this.options.gridControl);\n            this.addControl(this.gridControl);\n        }\n\n        if (this.options.infoControl) {\n            this.infoControl = infoControl(this.options.infoControl);\n            this.addControl(this.infoControl);\n        }\n\n        if (this.options.legendControl) {\n            this.legendControl = legendControl(this.options.legendControl);\n            this.addControl(this.legendControl);\n        }\n\n        if (this.options.shareControl) {\n            this.shareControl = shareControl(undefined,\n                withAccessToken(this.options.shareControl, this.options.accessToken));\n            this.addControl(this.shareControl);\n        }\n\n        this._mapboxLogoControl = mapboxLogoControl(this.options.mapboxLogoControl);\n        this.addControl(this._mapboxLogoControl);\n\n        this._loadTileJSON(_);\n\n        this.on('layeradd', this._onLayerAdd, this)\n            .on('layerremove', this._onLayerRemove, this)\n            .on('moveend', this._updateMapFeedbackLink, this);\n\n        this.whenReady(function () {\n            feedback.on('change', this._updateMapFeedbackLink, this);\n        });\n\n        this.on('unload', function () {\n            feedback.off('change', this._updateMapFeedbackLink, this);\n        });\n    },\n\n    // use a javascript object of tilejson data to configure this layer\n    _setTileJSON: function(_) {\n        this._tilejson = _;\n        this._initialize(_);\n        return this;\n    },\n\n    getTileJSON: function() {\n        return this._tilejson;\n    },\n\n    _initialize: function(json) {\n        if (this.tileLayer) {\n            this.tileLayer._setTileJSON(json);\n            this._updateLayer(this.tileLayer);\n        }\n\n        if (this.featureLayer && !this.featureLayer.getGeoJSON() && json.data && json.data[0]) {\n            this.featureLayer.loadURL(json.data[0]);\n        }\n\n        if (this.gridLayer) {\n            this.gridLayer._setTileJSON(json);\n            this._updateLayer(this.gridLayer);\n        }\n\n        if (this.infoControl && json.attribution) {\n            this.infoControl.addInfo(this.options.sanitizer(json.attribution));\n            this._updateMapFeedbackLink();\n        }\n\n        if (this.legendControl && json.legend) {\n            this.legendControl.addLegend(json.legend);\n        }\n\n        if (this.shareControl) {\n            this.shareControl._setTileJSON(json);\n        }\n\n        this._mapboxLogoControl._setTileJSON(json);\n\n        if (!this._loaded && json.center) {\n            var zoom = this.getZoom() !== undefined ? this.getZoom() : json.center[2],\n                center = L.latLng(json.center[1], json.center[0]);\n\n            this.setView(center, zoom);\n        }\n    },\n\n    _updateMapFeedbackLink: function() {\n        if (!this._controlContainer.getElementsByClassName) return;\n        var link = this._controlContainer.getElementsByClassName('mapbox-improve-map');\n        if (link.length && this._loaded) {\n            var center = this.getCenter().wrap();\n            var tilejson = this._tilejson || {};\n            var id = tilejson.id || '';\n\n            var hash = '#' + id + '/' +\n                center.lng.toFixed(3) + '/' +\n                center.lat.toFixed(3) + '/' +\n                this.getZoom();\n\n            for (var key in feedback.data) {\n                hash += '/' + key + '=' + feedback.data[key];\n            }\n\n            for (var i = 0; i < link.length; i++) {\n                link[i].hash = hash;\n            }\n        }\n    },\n\n    _onLayerAdd: function(e) {\n        if ('on' in e.layer) {\n            e.layer.on('ready', this._onLayerReady, this);\n        }\n        window.setTimeout(L.bind(this._updateMapFeedbackLink, this), 0); // Update after attribution control resets the HTML.\n    },\n\n    _onLayerRemove: function(e) {\n        if ('on' in e.layer) {\n            e.layer.off('ready', this._onLayerReady, this);\n        }\n        window.setTimeout(L.bind(this._updateMapFeedbackLink, this), 0); // Update after attribution control resets the HTML.\n    },\n\n    _onLayerReady: function(e) {\n        this._updateLayer(e.target);\n    },\n\n    _updateLayer: function(layer) {\n        if (!layer.options) return;\n\n        if (this.infoControl && this._loaded) {\n            this.infoControl.addInfo(layer.options.infoControl);\n        }\n\n        if (this.attributionControl && this._loaded && layer.getAttribution) {\n            this.attributionControl.addAttribution(layer.getAttribution());\n        }\n\n        if (!(L.stamp(layer) in this._zoomBoundLayers) &&\n                (layer.options.maxZoom || layer.options.minZoom)) {\n            this._zoomBoundLayers[L.stamp(layer)] = layer;\n        }\n\n        this._updateMapFeedbackLink();\n        this._updateZoomLevels();\n    }\n});\n\nmodule.exports.Map = LMap;\n\nmodule.exports.map = function(element, _, options) {\n    return new LMap(element, _, options);\n};\n","'use strict';\n\nvar util = require('./util'),\n    request = require('./request'),\n    grid = require('./grid');\n\n// forked from danzel/L.UTFGrid\nvar GridLayer = L.Class.extend({\n    includes: [L.Mixin.Events, require('./load_tilejson')],\n\n    options: {\n        template: function() { return ''; }\n    },\n\n    _mouseOn: null,\n    _tilejson: {},\n    _cache: {},\n\n    initialize: function(_, options) {\n        L.Util.setOptions(this, options);\n        this._loadTileJSON(_);\n    },\n\n    _setTileJSON: function(json) {\n        util.strict(json, 'object');\n\n        L.extend(this.options, {\n            grids: json.grids,\n            minZoom: json.minzoom,\n            maxZoom: json.maxzoom,\n            bounds: json.bounds && util.lbounds(json.bounds)\n        });\n\n        this._tilejson = json;\n        this._cache = {};\n        this._update();\n\n        return this;\n    },\n\n    getTileJSON: function() {\n        return this._tilejson;\n    },\n\n    active: function() {\n        return !!(this._map && this.options.grids && this.options.grids.length);\n    },\n\n    addTo: function (map) {\n        map.addLayer(this);\n        return this;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this._update();\n\n        this._map\n            .on('click', this._click, this)\n            .on('mousemove', this._move, this)\n            .on('moveend', this._update, this);\n    },\n\n    onRemove: function() {\n        this._map\n            .off('click', this._click, this)\n            .off('mousemove', this._move, this)\n            .off('moveend', this._update, this);\n    },\n\n    getData: function(latlng, callback) {\n        if (!this.active()) return;\n\n        var map = this._map,\n            point = map.project(latlng.wrap()),\n            tileSize = 256,\n            resolution = 4,\n            x = Math.floor(point.x / tileSize),\n            y = Math.floor(point.y / tileSize),\n            max = map.options.crs.scale(map.getZoom()) / tileSize;\n\n        x = (x + max) % max;\n        y = (y + max) % max;\n\n        this._getTile(map.getZoom(), x, y, function(grid) {\n            var gridX = Math.floor((point.x - (x * tileSize)) / resolution),\n                gridY = Math.floor((point.y - (y * tileSize)) / resolution);\n\n            callback(grid(gridX, gridY));\n        });\n\n        return this;\n    },\n\n    _click: function(e) {\n        this.getData(e.latlng, L.bind(function(data) {\n            this.fire('click', {\n                latLng: e.latlng,\n                data: data\n            });\n        }, this));\n    },\n\n    _move: function(e) {\n        this.getData(e.latlng, L.bind(function(data) {\n            if (data !== this._mouseOn) {\n                if (this._mouseOn) {\n                    this.fire('mouseout', {\n                        latLng: e.latlng,\n                        data: this._mouseOn\n                    });\n                }\n\n                this.fire('mouseover', {\n                    latLng: e.latlng,\n                    data: data\n                });\n\n                this._mouseOn = data;\n            } else {\n                this.fire('mousemove', {\n                    latLng: e.latlng,\n                    data: data\n                });\n            }\n        }, this));\n    },\n\n    _getTileURL: function(tilePoint) {\n        var urls = this.options.grids,\n            index = (tilePoint.x + tilePoint.y) % urls.length,\n            url = urls[index];\n\n        return L.Util.template(url, tilePoint);\n    },\n\n    // Load up all required json grid files\n    _update: function() {\n        if (!this.active()) return;\n\n        var bounds = this._map.getPixelBounds(),\n            z = this._map.getZoom(),\n            tileSize = 256;\n\n        if (z > this.options.maxZoom || z < this.options.minZoom) return;\n\n        var tileBounds = L.bounds(\n                bounds.min.divideBy(tileSize)._floor(),\n                bounds.max.divideBy(tileSize)._floor()),\n            max = this._map.options.crs.scale(z) / tileSize;\n\n        for (var x = tileBounds.min.x; x <= tileBounds.max.x; x++) {\n            for (var y = tileBounds.min.y; y <= tileBounds.max.y; y++) {\n                // x wrapped\n                this._getTile(z, ((x % max) + max) % max, ((y % max) + max) % max);\n            }\n        }\n    },\n\n    _getTile: function(z, x, y, callback) {\n        var key = z + '_' + x + '_' + y,\n            tilePoint = L.point(x, y);\n\n        tilePoint.z = z;\n\n        if (!this._tileShouldBeLoaded(tilePoint)) {\n            return;\n        }\n\n        if (key in this._cache) {\n            if (!callback) return;\n\n            if (typeof this._cache[key] === 'function') {\n                callback(this._cache[key]); // Already loaded\n            } else {\n                this._cache[key].push(callback); // Pending\n            }\n\n            return;\n        }\n\n        this._cache[key] = [];\n\n        if (callback) {\n            this._cache[key].push(callback);\n        }\n\n        request(this._getTileURL(tilePoint), L.bind(function(err, json) {\n            var callbacks = this._cache[key];\n            this._cache[key] = grid(json);\n            for (var i = 0; i < callbacks.length; ++i) {\n                callbacks[i](this._cache[key]);\n            }\n        }, this));\n    },\n\n    _tileShouldBeLoaded: function(tilePoint) {\n        if (tilePoint.z > this.options.maxZoom || tilePoint.z < this.options.minZoom) {\n            return false;\n        }\n\n        if (this.options.bounds) {\n            var tileSize = 256,\n                nwPoint = tilePoint.multiplyBy(tileSize),\n                sePoint = nwPoint.add(new L.Point(tileSize, tileSize)),\n                nw = this._map.unproject(nwPoint),\n                se = this._map.unproject(sePoint),\n                bounds = new L.LatLngBounds([nw, se]);\n\n            if (!this.options.bounds.intersects(bounds)) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n});\n\nmodule.exports.GridLayer = GridLayer;\n\nmodule.exports.gridLayer = function(_, options) {\n    return new GridLayer(_, options);\n};\n","'use strict';\n\nvar util = require('./util');\nvar format_url = require('./format_url');\nvar request = require('./request');\n\nvar StyleLayer = L.TileLayer.extend({\n\n    options: {\n        sanitizer: require('sanitize-caja')\n    },\n\n    initialize: function(_, options) {\n        L.TileLayer.prototype.initialize.call(this, undefined, options);\n\n        this.options.tiles = this._formatTileURL(_);\n        this.options.tileSize = 512;\n        this.options.zoomOffset = -1;\n        this.options.tms = false;\n\n        this._getAttribution(_);\n    },\n\n    _getAttribution: function(_) {\n        var styleURL = format_url.style(_, this.options && this.options.accessToken);\n        request(styleURL, L.bind(function(err, style) {\n            if (err) {\n                util.log('could not load Mapbox style at ' + styleURL);\n                this.fire('error', {error: err});\n            }\n            var sources = [];\n            for (var id in style.sources) {\n                var source = style.sources[id].url.split('mapbox://')[1];\n                sources.push(source);\n            }\n            request(format_url.tileJSON(sources.join(), this.options.accessToken), L.bind(function(err, json) {\n                if (err) {\n                    util.log('could not load TileJSON at ' + _);\n                    this.fire('error', {error: err});\n                } else if (json) {\n                    util.strict(json, 'object');\n\n                    this.options.attribution = this.options.sanitizer(json.attribution);\n\n                    this._tilejson = json;\n                    this.fire('ready');\n                }\n            }, this));\n        }, this));\n    },\n\n    // disable the setUrl function, which is not available on mapbox tilelayers\n    setUrl: null,\n\n    _formatTileURL: function(style) {\n        var retina = L.Browser.retina ? '@2x' : '';\n        if (typeof style === 'string') {\n            if (style.indexOf('mapbox://styles/') === -1) {\n                util.log('Incorrectly formatted Mapbox style at ' + style);\n                this.fire('error');\n            }\n            var ownerIDStyle = style.split('mapbox://styles/')[1];\n            return format_url('/styles/v1/' + ownerIDStyle + '/tiles/{z}/{x}/{y}' + retina, this.options.accessToken);\n        } else if (typeof style === 'object') {\n            return format_url('/styles/v1/' + style.owner + '/' + style.id + '/tiles/{z}/{x}/{y}' + retina, this.options.accessToken);\n        }\n    },\n\n    // this is an exception to mapbox.js naming rules because it's called\n    // by `L.map`\n    getTileUrl: function(tilePoint) {\n        var templated = L.Util.template(this.options.tiles, tilePoint);\n        return templated;\n    }\n});\n\nmodule.exports.StyleLayer = StyleLayer;\n\nmodule.exports.styleLayer = function(_, options) {\n    return new StyleLayer(_, options);\n};\n","'use strict';\n\nvar isArray = require('isarray'),\n    util = require('./util'),\n    format_url = require('./format_url'),\n    feedback = require('./feedback'),\n    request = require('./request');\n\n// Low-level geocoding interface - wraps specific API calls and their\n// return values.\nmodule.exports = function(url, options) {\n    if (!options) options = {};\n    var geocoder = {};\n\n    util.strict(url, 'string');\n\n    if (url.indexOf('/') === -1) {\n        url = format_url('/geocoding/v5/' + url + '/{query}.json', options.accessToken, 5);\n    }\n\n    function roundTo(latLng, precision) {\n        var mult = Math.pow(10, precision);\n        latLng.lat = Math.round(latLng.lat * mult) / mult;\n        latLng.lng = Math.round(latLng.lng * mult) / mult;\n        return latLng;\n    }\n\n    geocoder.getURL = function() {\n        return url;\n    };\n\n    geocoder.queryURL = function(_) {\n        var isObject = !(isArray(_) || typeof _ === 'string'),\n            query = isObject ? _.query : _;\n\n        if (isArray(query)) {\n            var parts = [];\n            for (var i = 0; i < query.length; i++) {\n                parts[i] = encodeURIComponent(query[i]);\n            }\n            query = parts.join(';');\n        } else {\n            query = encodeURIComponent(query);\n        }\n\n        feedback.record({ geocoding: query });\n\n        var url = L.Util.template(geocoder.getURL(), {query: query});\n\n        if (isObject) {\n            if (_.types) {\n                if (isArray(_.types)) {\n                    url += '&types=' + _.types.join();\n                } else {\n                    url += '&types=' + _.types;\n                }\n            }\n\n            if (_.country) {\n                if (isArray(_.country)) {\n                    url += '&country=' + _.country.join();\n                } else {\n                    url += '&country=' + _.country;\n                }\n            }\n\n            if (_.proximity) {\n                var proximity = roundTo(L.latLng(_.proximity), 3);\n                url += '&proximity=' + proximity.lng + ',' + proximity.lat;\n            }\n\n            if (typeof _.autocomplete === 'boolean') {\n                url += '&autocomplete=' + _.autocomplete;\n            }\n        }\n\n        return url;\n    };\n\n    geocoder.query = function(_, callback) {\n        util.strict(callback, 'function');\n\n        request(geocoder.queryURL(_), function(err, json) {\n            if (json && (json.length || json.features)) {\n                var res = {\n                    results: json\n                };\n                if (json.features && json.features.length) {\n                    res.latlng = [\n                        json.features[0].center[1],\n                        json.features[0].center[0]];\n\n                    if (json.features[0].bbox) {\n                        res.bounds = json.features[0].bbox;\n                        res.lbounds = util.lbounds(res.bounds);\n                    }\n                }\n                callback(null, res);\n            } else callback(err || true);\n        });\n\n        return geocoder;\n    };\n\n    // a reverse geocode:\n    //\n    //  geocoder.reverseQuery([80, 20])\n    geocoder.reverseQuery = function(_, callback) {\n        var q = '';\n\n        // sort through different ways people represent lat and lon pairs\n        function normalize(x) {\n            var latLng;\n            if (x.lat !== undefined && x.lng !== undefined) {\n                latLng = L.latLng(x.lat, x.lng);\n            } else if (x.lat !== undefined && x.lon !== undefined) {\n                latLng = L.latLng(x.lat, x.lon);\n            } else {\n                latLng = L.latLng(x[1], x[0]);\n            }\n            latLng = roundTo(latLng, 5);\n            return latLng.lng + ',' + latLng.lat;\n        }\n\n        if (_.length && _[0].length) {\n            for (var i = 0, pts = []; i < _.length; i++) {\n                pts.push(normalize(_[i]));\n            }\n            q = pts.join(';');\n        } else {\n            q = normalize(_);\n        }\n\n        request(geocoder.queryURL(q), function(err, json) {\n            callback(err, json);\n        });\n\n        return geocoder;\n    };\n\n    return geocoder;\n};\n","'use strict';\n\nvar format_url = require('./format_url'),\n    util = require('./util'),\n    sanitize = require('sanitize-caja');\n\n// mapbox-related markers functionality\n// provide an icon from mapbox's simple-style spec and hosted markers\n// service\nfunction icon(fp, options) {\n    fp = fp || {};\n\n    var sizes = {\n            small: [20, 50],\n            medium: [30, 70],\n            large: [35, 90]\n        },\n        size = fp['marker-size'] || 'medium',\n        symbol = ('marker-symbol' in fp && fp['marker-symbol'] !== '') ? '-' + fp['marker-symbol'] : '',\n        color = (fp['marker-color'] || '7e7e7e').replace('#', '');\n\n    return L.icon({\n        iconUrl: format_url('/v4/marker/' +\n            'pin-' + size.charAt(0) + symbol + '+' + color +\n            // detect and use retina markers, which are x2 resolution\n            (L.Browser.retina ? '@2x' : '') + '.png', options && options.accessToken),\n        iconSize: sizes[size],\n        iconAnchor: [sizes[size][0] / 2, sizes[size][1] / 2],\n        popupAnchor: [0, -sizes[size][1] / 2]\n    });\n}\n\n// a factory that provides markers for Leaflet from Mapbox's\n// [simple-style specification](https://github.com/mapbox/simplestyle-spec)\n// and [Markers API](http://mapbox.com/developers/api/#markers).\nfunction style(f, latlon, options) {\n    return L.marker(latlon, {\n        icon: icon(f.properties, options),\n        title: util.strip_tags(\n            sanitize((f.properties && f.properties.title) || ''))\n    });\n}\n\n// Sanitize and format properties of a GeoJSON Feature object in order\n// to form the HTML string used as the argument for `L.createPopup`\nfunction createPopup(f, sanitizer) {\n    if (!f || !f.properties) return '';\n    var popup = '';\n\n    if (f.properties.title) {\n        popup += '<div class=\"marker-title\">' + f.properties.title + '</div>';\n    }\n\n    if (f.properties.description) {\n        popup += '<div class=\"marker-description\">' + f.properties.description + '</div>';\n    }\n\n    return (sanitizer || sanitize)(popup);\n}\n\nmodule.exports = {\n    icon: icon,\n    style: style,\n    createPopup: createPopup\n};\n","'use strict';\n\n// an implementation of the simplestyle spec for polygon and linestring features\n// https://github.com/mapbox/simplestyle-spec\nvar defaults = {\n    stroke: '#555555',\n    'stroke-width': 2,\n    'stroke-opacity': 1,\n    fill: '#555555',\n    'fill-opacity': 0.5\n};\n\nvar mapping = [\n    ['stroke', 'color'],\n    ['stroke-width', 'weight'],\n    ['stroke-opacity', 'opacity'],\n    ['fill', 'fillColor'],\n    ['fill-opacity', 'fillOpacity']\n];\n\nfunction fallback(a, b) {\n    var c = {};\n    for (var k in b) {\n        if (a[k] === undefined) c[k] = b[k];\n        else c[k] = a[k];\n    }\n    return c;\n}\n\nfunction remap(a) {\n    var d = {};\n    for (var i = 0; i < mapping.length; i++) {\n        d[mapping[i][1]] = a[mapping[i][0]];\n    }\n    return d;\n}\n\nfunction style(feature) {\n    return remap(fallback(feature.properties || {}, defaults));\n}\n\nmodule.exports = {\n    style: style,\n    defaults: defaults\n};\n","'use strict';\n\nmodule.exports = {\n    HTTP_URL: 'http://a.tiles.mapbox.com/v4',\n    HTTPS_URL: 'https://a.tiles.mapbox.com/v4',\n    FORCE_HTTPS: false,\n    REQUIRE_ACCESS_TOKEN: true\n};\n","'use strict';\n\nvar Feedback = L.Class.extend({\n    includes: L.Mixin.Events,\n    data: {},\n    record: function(data) {\n        L.extend(this.data, data);\n        this.fire('change');\n    }\n});\n\nmodule.exports = new Feedback();\n","'use strict';\n\nfunction contains(item, list) {\n    if (!list || !list.length) return false;\n    for (var i = 0; i < list.length; i++) {\n        if (list[i] === item) return true;\n    }\n    return false;\n}\n\nmodule.exports = {\n    idUrl: function(_, t) {\n        if (_.indexOf('/') === -1) t.loadID(_);\n        else t.loadURL(_);\n    },\n    log: function(_) {\n        if (typeof console === 'object' &&\n            typeof console.error === 'function') {\n            console.error(_);\n        }\n    },\n    strict: function(_, type) {\n        if (typeof _ !== type) {\n            throw new Error('Invalid argument: ' + type + ' expected');\n        }\n    },\n    strict_instance: function(_, klass, name) {\n        if (!(_ instanceof klass)) {\n            throw new Error('Invalid argument: ' + name + ' expected');\n        }\n    },\n    strict_oneof: function(_, values) {\n        if (!contains(_, values)) {\n            throw new Error('Invalid argument: ' + _ + ' given, valid values are ' +\n                values.join(', '));\n        }\n    },\n    strip_tags: function(_) {\n        return _.replace(/<[^<]+>/g, '');\n    },\n    lbounds: function(_) {\n        // leaflet-compatible bounds, since leaflet does not do geojson\n        return new L.LatLngBounds([[_[1], _[0]], [_[3], _[2]]]);\n    }\n};\n","'use strict';\n\nvar config = require('./config'),\n    version = require('../package.json').version;\n\nmodule.exports = function(path, accessToken) {\n    accessToken = accessToken || L.mapbox.accessToken;\n\n    if (!accessToken && config.REQUIRE_ACCESS_TOKEN) {\n        throw new Error('An API access token is required to use Mapbox.js. ' +\n            'See https://www.mapbox.com/mapbox.js/api/v' + version + '/api-access-tokens/');\n    }\n\n    var url = (document.location.protocol === 'https:' || config.FORCE_HTTPS) ? config.HTTPS_URL : config.HTTP_URL;\n    url = url.replace(/\\/v4$/, '');\n    url += path;\n\n    if (config.REQUIRE_ACCESS_TOKEN) {\n        if (accessToken[0] === 's') {\n            throw new Error('Use a public access token (pk.*) with Mapbox.js, not a secret access token (sk.*). ' +\n                'See https://www.mapbox.com/mapbox.js/api/v' + version + '/api-access-tokens/');\n        }\n\n        url += url.indexOf('?') !== -1 ? '&access_token=' : '?access_token=';\n        url += accessToken;\n    }\n\n    return url;\n};\n\nmodule.exports.tileJSON = function(urlOrMapID, accessToken) {\n\n    if (urlOrMapID.indexOf('mapbox://styles') === 0) {\n        throw new Error('Styles created with Mapbox Studio need to be used with ' +\n            'L.mapbox.styleLayer, not L.mapbox.tileLayer');\n    }\n\n    if (urlOrMapID.indexOf('/') !== -1)\n        return urlOrMapID;\n\n    var url = module.exports('/v4/' + urlOrMapID + '.json', accessToken);\n\n    // TileJSON requests need a secure flag appended to their URLs so\n    // that the server knows to send SSL-ified resource references.\n    if (url.indexOf('https') === 0)\n        url += '&secure';\n\n    return url;\n};\n\n\nmodule.exports.style = function(styleURL, accessToken) {\n    if (styleURL.indexOf('mapbox://styles/') === -1) throw new Error('Incorrectly formatted Mapbox style at ' + styleURL);\n\n    var ownerIDStyle = styleURL.split('mapbox://styles/')[1];\n    var url = module.exports('/styles/v1/' + ownerIDStyle, accessToken)\n        .replace('http://', 'https://');\n\n    return url;\n};\n","'use strict';\n\nvar corslite = require('corslite'),\n    strict = require('./util').strict,\n    config = require('./config');\n\nvar protocol = /^(https?:)?(?=\\/\\/(.|api)\\.tiles\\.mapbox\\.com\\/)/;\n\nmodule.exports = function(url, callback) {\n    strict(url, 'string');\n    strict(callback, 'function');\n\n    url = url.replace(protocol, function(match, protocol) {\n        if (!('withCredentials' in new window.XMLHttpRequest())) {\n            // XDomainRequest in use; doesn't support cross-protocol requests\n            return document.location.protocol;\n        } else if (protocol === 'https:' || document.location.protocol === 'https:' || config.FORCE_HTTPS) {\n            return 'https:';\n        } else {\n            return 'http:';\n        }\n    });\n\n    function onload(err, resp) {\n        if (!err && resp) {\n            resp = JSON.parse(resp.responseText);\n        }\n        callback(err, resp);\n    }\n\n    return corslite(url, onload);\n};\n","'use strict';\n\nvar request = require('./request'),\n    format_url = require('./format_url'),\n    util = require('./util');\n\nmodule.exports = {\n    _loadTileJSON: function(_) {\n        if (typeof _ === 'string') {\n            _ = format_url.tileJSON(_, this.options && this.options.accessToken);\n            request(_, L.bind(function(err, json) {\n                if (err) {\n                    util.log('could not load TileJSON at ' + _);\n                    this.fire('error', {error: err});\n                } else if (json) {\n                    this._setTileJSON(json);\n                    this.fire('ready');\n                }\n            }, this));\n        } else if (_ && typeof _ === 'object') {\n            this._setTileJSON(_);\n        }\n    }\n};\n","'use strict';\n\nvar MapboxLogoControl = L.Control.extend({\n\n    options: {\n        position: 'bottomleft'\n    },\n\n    initialize: function(options) {\n        L.setOptions(this, options);\n    },\n\n    onAdd: function() {\n        this._container = L.DomUtil.create('div', 'mapbox-logo');\n        return this._container;\n    },\n\n    _setTileJSON: function(json) {\n        // Check if account referenced by the accessToken\n        // is asscociated with the Mapbox Logo\n        // as determined by mapbox-maps.\n        if (json.mapbox_logo) {\n            L.DomUtil.addClass(this._container, 'mapbox-logo-true');\n        }\n    }\n});\n\nmodule.exports.MapboxLogoControl = MapboxLogoControl;\n\nmodule.exports.mapboxLogoControl = function(options) {\n    return new MapboxLogoControl(options);\n};\n","'use strict';\n\nfunction utfDecode(c) {\n    if (c >= 93) c--;\n    if (c >= 35) c--;\n    return c - 32;\n}\n\nmodule.exports = function(data) {\n    return function(x, y) {\n        if (!data) return;\n        var idx = utfDecode(data.grid[y].charCodeAt(x)),\n            key = data.keys[idx];\n        return data.data[key];\n    };\n};\n","var html_sanitize = require('./sanitizer-bundle.js');\n\nmodule.exports = function(_) {\n    if (!_) return '';\n    return html_sanitize(_, cleanUrl, cleanId);\n};\n\n// https://bugzilla.mozilla.org/show_bug.cgi?id=255107\nfunction cleanUrl(url) {\n    'use strict';\n    if (/^https?/.test(url.getScheme())) return url.toString();\n    if (/^mailto?/.test(url.getScheme())) return url.toString();\n    if ('data' == url.getScheme() && /^image/.test(url.getPath())) {\n        return url.toString();\n    }\n}\n\nfunction cleanId(id) { return id; }\n","/*!\n * mustache.js - Logic-less {{mustache}} templates with JavaScript\n * http://github.com/janl/mustache.js\n */\n\n/*global define: false Mustache: true*/\n\n(function defineMustache (global, factory) {\n  if (typeof exports === 'object' && exports && typeof exports.nodeName !== 'string') {\n    factory(exports); // CommonJS\n  } else if (typeof define === 'function' && define.amd) {\n    define(['exports'], factory); // AMD\n  } else {\n    global.Mustache = {};\n    factory(global.Mustache); // script, wsh, asp\n  }\n}(this, function mustacheFactory (mustache) {\n\n  var objectToString = Object.prototype.toString;\n  var isArray = Array.isArray || function isArrayPolyfill (object) {\n    return objectToString.call(object) === '[object Array]';\n  };\n\n  function isFunction (object) {\n    return typeof object === 'function';\n  }\n\n  /**\n   * More correct typeof string handling array\n   * which normally returns typeof 'object'\n   */\n  function typeStr (obj) {\n    return isArray(obj) ? 'array' : typeof obj;\n  }\n\n  function escapeRegExp (string) {\n    return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, '\\\\$&');\n  }\n\n  /**\n   * Null safe way of checking whether or not an object,\n   * including its prototype, has a given property\n   */\n  function hasProperty (obj, propName) {\n    return obj != null && typeof obj === 'object' && (propName in obj);\n  }\n\n  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577\n  // See https://github.com/janl/mustache.js/issues/189\n  var regExpTest = RegExp.prototype.test;\n  function testRegExp (re, string) {\n    return regExpTest.call(re, string);\n  }\n\n  var nonSpaceRe = /\\S/;\n  function isWhitespace (string) {\n    return !testRegExp(nonSpaceRe, string);\n  }\n\n  var entityMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '/': '&#x2F;',\n    '`': '&#x60;',\n    '=': '&#x3D;'\n  };\n\n  function escapeHtml (string) {\n    return String(string).replace(/[&<>\"'`=\\/]/g, function fromEntityMap (s) {\n      return entityMap[s];\n    });\n  }\n\n  var whiteRe = /\\s*/;\n  var spaceRe = /\\s+/;\n  var equalsRe = /\\s*=/;\n  var curlyRe = /\\s*\\}/;\n  var tagRe = /#|\\^|\\/|>|\\{|&|=|!/;\n\n  /**\n   * Breaks up the given `template` string into a tree of tokens. If the `tags`\n   * argument is given here it must be an array with two string values: the\n   * opening and closing tags used in the template (e.g. [ \"<%\", \"%>\" ]). Of\n   * course, the default is to use mustaches (i.e. mustache.tags).\n   *\n   * A token is an array with at least 4 elements. The first element is the\n   * mustache symbol that was used inside the tag, e.g. \"#\" or \"&\". If the tag\n   * did not contain a symbol (i.e. {{myValue}}) this element is \"name\". For\n   * all text that appears outside a symbol this element is \"text\".\n   *\n   * The second element of a token is its \"value\". For mustache tags this is\n   * whatever else was inside the tag besides the opening symbol. For text tokens\n   * this is the text itself.\n   *\n   * The third and fourth elements of the token are the start and end indices,\n   * respectively, of the token in the original template.\n   *\n   * Tokens that are the root node of a subtree contain two more elements: 1) an\n   * array of tokens in the subtree and 2) the index in the original template at\n   * which the closing tag for that section begins.\n   */\n  function parseTemplate (template, tags) {\n    if (!template)\n      return [];\n\n    var sections = [];     // Stack to hold section tokens\n    var tokens = [];       // Buffer to hold the tokens\n    var spaces = [];       // Indices of whitespace tokens on the current line\n    var hasTag = false;    // Is there a {{tag}} on the current line?\n    var nonSpace = false;  // Is there a non-space char on the current line?\n\n    // Strips all whitespace tokens array for the current line\n    // if there was a {{#tag}} on it and otherwise only space.\n    function stripSpace () {\n      if (hasTag && !nonSpace) {\n        while (spaces.length)\n          delete tokens[spaces.pop()];\n      } else {\n        spaces = [];\n      }\n\n      hasTag = false;\n      nonSpace = false;\n    }\n\n    var openingTagRe, closingTagRe, closingCurlyRe;\n    function compileTags (tagsToCompile) {\n      if (typeof tagsToCompile === 'string')\n        tagsToCompile = tagsToCompile.split(spaceRe, 2);\n\n      if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)\n        throw new Error('Invalid tags: ' + tagsToCompile);\n\n      openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\\\s*');\n      closingTagRe = new RegExp('\\\\s*' + escapeRegExp(tagsToCompile[1]));\n      closingCurlyRe = new RegExp('\\\\s*' + escapeRegExp('}' + tagsToCompile[1]));\n    }\n\n    compileTags(tags || mustache.tags);\n\n    var scanner = new Scanner(template);\n\n    var start, type, value, chr, token, openSection;\n    while (!scanner.eos()) {\n      start = scanner.pos;\n\n      // Match any text between tags.\n      value = scanner.scanUntil(openingTagRe);\n\n      if (value) {\n        for (var i = 0, valueLength = value.length; i < valueLength; ++i) {\n          chr = value.charAt(i);\n\n          if (isWhitespace(chr)) {\n            spaces.push(tokens.length);\n          } else {\n            nonSpace = true;\n          }\n\n          tokens.push([ 'text', chr, start, start + 1 ]);\n          start += 1;\n\n          // Check for whitespace on the current line.\n          if (chr === '\\n')\n            stripSpace();\n        }\n      }\n\n      // Match the opening tag.\n      if (!scanner.scan(openingTagRe))\n        break;\n\n      hasTag = true;\n\n      // Get the tag type.\n      type = scanner.scan(tagRe) || 'name';\n      scanner.scan(whiteRe);\n\n      // Get the tag value.\n      if (type === '=') {\n        value = scanner.scanUntil(equalsRe);\n        scanner.scan(equalsRe);\n        scanner.scanUntil(closingTagRe);\n      } else if (type === '{') {\n        value = scanner.scanUntil(closingCurlyRe);\n        scanner.scan(curlyRe);\n        scanner.scanUntil(closingTagRe);\n        type = '&';\n      } else {\n        value = scanner.scanUntil(closingTagRe);\n      }\n\n      // Match the closing tag.\n      if (!scanner.scan(closingTagRe))\n        throw new Error('Unclosed tag at ' + scanner.pos);\n\n      token = [ type, value, start, scanner.pos ];\n      tokens.push(token);\n\n      if (type === '#' || type === '^') {\n        sections.push(token);\n      } else if (type === '/') {\n        // Check section nesting.\n        openSection = sections.pop();\n\n        if (!openSection)\n          throw new Error('Unopened section \"' + value + '\" at ' + start);\n\n        if (openSection[1] !== value)\n          throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + start);\n      } else if (type === 'name' || type === '{' || type === '&') {\n        nonSpace = true;\n      } else if (type === '=') {\n        // Set the tags for the next time around.\n        compileTags(value);\n      }\n    }\n\n    // Make sure there are no open sections when we're done.\n    openSection = sections.pop();\n\n    if (openSection)\n      throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + scanner.pos);\n\n    return nestTokens(squashTokens(tokens));\n  }\n\n  /**\n   * Combines the values of consecutive text tokens in the given `tokens` array\n   * to a single token.\n   */\n  function squashTokens (tokens) {\n    var squashedTokens = [];\n\n    var token, lastToken;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      if (token) {\n        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {\n          lastToken[1] += token[1];\n          lastToken[3] = token[3];\n        } else {\n          squashedTokens.push(token);\n          lastToken = token;\n        }\n      }\n    }\n\n    return squashedTokens;\n  }\n\n  /**\n   * Forms the given array of `tokens` into a nested tree structure where\n   * tokens that represent a section have two additional items: 1) an array of\n   * all tokens that appear in that section and 2) the index in the original\n   * template that represents the end of that section.\n   */\n  function nestTokens (tokens) {\n    var nestedTokens = [];\n    var collector = nestedTokens;\n    var sections = [];\n\n    var token, section;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      switch (token[0]) {\n        case '#':\n        case '^':\n          collector.push(token);\n          sections.push(token);\n          collector = token[4] = [];\n          break;\n        case '/':\n          section = sections.pop();\n          section[5] = token[2];\n          collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;\n          break;\n        default:\n          collector.push(token);\n      }\n    }\n\n    return nestedTokens;\n  }\n\n  /**\n   * A simple string scanner that is used by the template parser to find\n   * tokens in template strings.\n   */\n  function Scanner (string) {\n    this.string = string;\n    this.tail = string;\n    this.pos = 0;\n  }\n\n  /**\n   * Returns `true` if the tail is empty (end of string).\n   */\n  Scanner.prototype.eos = function eos () {\n    return this.tail === '';\n  };\n\n  /**\n   * Tries to match the given regular expression at the current position.\n   * Returns the matched text if it can match, the empty string otherwise.\n   */\n  Scanner.prototype.scan = function scan (re) {\n    var match = this.tail.match(re);\n\n    if (!match || match.index !== 0)\n      return '';\n\n    var string = match[0];\n\n    this.tail = this.tail.substring(string.length);\n    this.pos += string.length;\n\n    return string;\n  };\n\n  /**\n   * Skips all text until the given regular expression can be matched. Returns\n   * the skipped string, which is the entire tail if no match can be made.\n   */\n  Scanner.prototype.scanUntil = function scanUntil (re) {\n    var index = this.tail.search(re), match;\n\n    switch (index) {\n      case -1:\n        match = this.tail;\n        this.tail = '';\n        break;\n      case 0:\n        match = '';\n        break;\n      default:\n        match = this.tail.substring(0, index);\n        this.tail = this.tail.substring(index);\n    }\n\n    this.pos += match.length;\n\n    return match;\n  };\n\n  /**\n   * Represents a rendering context by wrapping a view object and\n   * maintaining a reference to the parent context.\n   */\n  function Context (view, parentContext) {\n    this.view = view;\n    this.cache = { '.': this.view };\n    this.parent = parentContext;\n  }\n\n  /**\n   * Creates a new context using the given view with this context\n   * as the parent.\n   */\n  Context.prototype.push = function push (view) {\n    return new Context(view, this);\n  };\n\n  /**\n   * Returns the value of the given name in this context, traversing\n   * up the context hierarchy if the value is absent in this context's view.\n   */\n  Context.prototype.lookup = function lookup (name) {\n    var cache = this.cache;\n\n    var value;\n    if (cache.hasOwnProperty(name)) {\n      value = cache[name];\n    } else {\n      var context = this, names, index, lookupHit = false;\n\n      while (context) {\n        if (name.indexOf('.') > 0) {\n          value = context.view;\n          names = name.split('.');\n          index = 0;\n\n          /**\n           * Using the dot notion path in `name`, we descend through the\n           * nested objects.\n           *\n           * To be certain that the lookup has been successful, we have to\n           * check if the last object in the path actually has the property\n           * we are looking for. We store the result in `lookupHit`.\n           *\n           * This is specially necessary for when the value has been set to\n           * `undefined` and we want to avoid looking up parent contexts.\n           **/\n          while (value != null && index < names.length) {\n            if (index === names.length - 1)\n              lookupHit = hasProperty(value, names[index]);\n\n            value = value[names[index++]];\n          }\n        } else {\n          value = context.view[name];\n          lookupHit = hasProperty(context.view, name);\n        }\n\n        if (lookupHit)\n          break;\n\n        context = context.parent;\n      }\n\n      cache[name] = value;\n    }\n\n    if (isFunction(value))\n      value = value.call(this.view);\n\n    return value;\n  };\n\n  /**\n   * A Writer knows how to take a stream of tokens and render them to a\n   * string, given a context. It also maintains a cache of templates to\n   * avoid the need to parse the same template twice.\n   */\n  function Writer () {\n    this.cache = {};\n  }\n\n  /**\n   * Clears all cached templates in this writer.\n   */\n  Writer.prototype.clearCache = function clearCache () {\n    this.cache = {};\n  };\n\n  /**\n   * Parses and caches the given `template` and returns the array of tokens\n   * that is generated from the parse.\n   */\n  Writer.prototype.parse = function parse (template, tags) {\n    var cache = this.cache;\n    var tokens = cache[template];\n\n    if (tokens == null)\n      tokens = cache[template] = parseTemplate(template, tags);\n\n    return tokens;\n  };\n\n  /**\n   * High-level method that is used to render the given `template` with\n   * the given `view`.\n   *\n   * The optional `partials` argument may be an object that contains the\n   * names and templates of partials that are used in the template. It may\n   * also be a function that is used to load partial templates on the fly\n   * that takes a single argument: the name of the partial.\n   */\n  Writer.prototype.render = function render (template, view, partials) {\n    var tokens = this.parse(template);\n    var context = (view instanceof Context) ? view : new Context(view);\n    return this.renderTokens(tokens, context, partials, template);\n  };\n\n  /**\n   * Low-level method that renders the given array of `tokens` using\n   * the given `context` and `partials`.\n   *\n   * Note: The `originalTemplate` is only ever used to extract the portion\n   * of the original template that was contained in a higher-order section.\n   * If the template doesn't use higher-order sections, this argument may\n   * be omitted.\n   */\n  Writer.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate) {\n    var buffer = '';\n\n    var token, symbol, value;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      value = undefined;\n      token = tokens[i];\n      symbol = token[0];\n\n      if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate);\n      else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate);\n      else if (symbol === '>') value = this.renderPartial(token, context, partials, originalTemplate);\n      else if (symbol === '&') value = this.unescapedValue(token, context);\n      else if (symbol === 'name') value = this.escapedValue(token, context);\n      else if (symbol === 'text') value = this.rawValue(token);\n\n      if (value !== undefined)\n        buffer += value;\n    }\n\n    return buffer;\n  };\n\n  Writer.prototype.renderSection = function renderSection (token, context, partials, originalTemplate) {\n    var self = this;\n    var buffer = '';\n    var value = context.lookup(token[1]);\n\n    // This function is used to render an arbitrary template\n    // in the current context by higher-order sections.\n    function subRender (template) {\n      return self.render(template, context, partials);\n    }\n\n    if (!value) return;\n\n    if (isArray(value)) {\n      for (var j = 0, valueLength = value.length; j < valueLength; ++j) {\n        buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate);\n      }\n    } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {\n      buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate);\n    } else if (isFunction(value)) {\n      if (typeof originalTemplate !== 'string')\n        throw new Error('Cannot use higher-order sections without the original template');\n\n      // Extract the portion of the original template that the section contains.\n      value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);\n\n      if (value != null)\n        buffer += value;\n    } else {\n      buffer += this.renderTokens(token[4], context, partials, originalTemplate);\n    }\n    return buffer;\n  };\n\n  Writer.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate) {\n    var value = context.lookup(token[1]);\n\n    // Use JavaScript's definition of falsy. Include empty arrays.\n    // See https://github.com/janl/mustache.js/issues/186\n    if (!value || (isArray(value) && value.length === 0))\n      return this.renderTokens(token[4], context, partials, originalTemplate);\n  };\n\n  Writer.prototype.renderPartial = function renderPartial (token, context, partials) {\n    if (!partials) return;\n\n    var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];\n    if (value != null)\n      return this.renderTokens(this.parse(value), context, partials, value);\n  };\n\n  Writer.prototype.unescapedValue = function unescapedValue (token, context) {\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return value;\n  };\n\n  Writer.prototype.escapedValue = function escapedValue (token, context) {\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return mustache.escape(value);\n  };\n\n  Writer.prototype.rawValue = function rawValue (token) {\n    return token[1];\n  };\n\n  mustache.name = 'mustache.js';\n  mustache.version = '2.2.1';\n  mustache.tags = [ '{{', '}}' ];\n\n  // All high-level mustache.* functions use this writer.\n  var defaultWriter = new Writer();\n\n  /**\n   * Clears all cached templates in the default writer.\n   */\n  mustache.clearCache = function clearCache () {\n    return defaultWriter.clearCache();\n  };\n\n  /**\n   * Parses and caches the given template in the default writer and returns the\n   * array of tokens it contains. Doing this ahead of time avoids the need to\n   * parse templates on the fly as they are rendered.\n   */\n  mustache.parse = function parse (template, tags) {\n    return defaultWriter.parse(template, tags);\n  };\n\n  /**\n   * Renders the `template` with the given `view` and `partials` using the\n   * default writer.\n   */\n  mustache.render = function render (template, view, partials) {\n    if (typeof template !== 'string') {\n      throw new TypeError('Invalid template! Template should be a \"string\" ' +\n                          'but \"' + typeStr(template) + '\" was given as the first ' +\n                          'argument for mustache#render(template, view, partials)');\n    }\n\n    return defaultWriter.render(template, view, partials);\n  };\n\n  // This is here for backwards compatibility with 0.4.x.,\n  /*eslint-disable */ // eslint wants camel cased function name\n  mustache.to_html = function to_html (template, view, partials, send) {\n    /*eslint-enable*/\n\n    var result = mustache.render(template, view, partials);\n\n    if (isFunction(send)) {\n      send(result);\n    } else {\n      return result;\n    }\n  };\n\n  // Export the escaping function so that the user may override it.\n  // See https://github.com/janl/mustache.js/issues/244\n  mustache.escape = escapeHtml;\n\n  // Export these mainly for testing, but also for advanced usage.\n  mustache.Scanner = Scanner;\n  mustache.Context = Context;\n  mustache.Writer = Writer;\n\n}));\n","/*\n Leaflet, a JavaScript library for mobile-friendly interactive maps. http://leafletjs.com\n (c) 2010-2013, Vladimir Agafonkin\n (c) 2010-2011, CloudMade\n*/\n(function (window, document, undefined) {\r\nvar oldL = window.L,\r\n    L = {};\r\n\r\nL.version = '0.7.7';\r\n\r\n// define Leaflet for Node module pattern loaders, including Browserify\r\nif (typeof module === 'object' && typeof module.exports === 'object') {\r\n\tmodule.exports = L;\r\n\r\n// define Leaflet as an AMD module\r\n} else if (typeof define === 'function' && define.amd) {\r\n\tdefine(L);\r\n}\r\n\r\n// define Leaflet as a global L variable, saving the original L to restore later if needed\r\n\r\nL.noConflict = function () {\r\n\twindow.L = oldL;\r\n\treturn this;\r\n};\r\n\r\nwindow.L = L;\r\n\n\n/*\r\n * L.Util contains various utility functions used throughout Leaflet code.\r\n */\r\n\r\nL.Util = {\r\n\textend: function (dest) { // (Object[, Object, ...]) ->\r\n\t\tvar sources = Array.prototype.slice.call(arguments, 1),\r\n\t\t    i, j, len, src;\r\n\r\n\t\tfor (j = 0, len = sources.length; j < len; j++) {\r\n\t\t\tsrc = sources[j] || {};\r\n\t\t\tfor (i in src) {\r\n\t\t\t\tif (src.hasOwnProperty(i)) {\r\n\t\t\t\t\tdest[i] = src[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn dest;\r\n\t},\r\n\r\n\tbind: function (fn, obj) { // (Function, Object) -> Function\r\n\t\tvar args = arguments.length > 2 ? Array.prototype.slice.call(arguments, 2) : null;\r\n\t\treturn function () {\r\n\t\t\treturn fn.apply(obj, args || arguments);\r\n\t\t};\r\n\t},\r\n\r\n\tstamp: (function () {\r\n\t\tvar lastId = 0,\r\n\t\t    key = '_leaflet_id';\r\n\t\treturn function (obj) {\r\n\t\t\tobj[key] = obj[key] || ++lastId;\r\n\t\t\treturn obj[key];\r\n\t\t};\r\n\t}()),\r\n\r\n\tinvokeEach: function (obj, method, context) {\r\n\t\tvar i, args;\r\n\r\n\t\tif (typeof obj === 'object') {\r\n\t\t\targs = Array.prototype.slice.call(arguments, 3);\r\n\r\n\t\t\tfor (i in obj) {\r\n\t\t\t\tmethod.apply(context, [i, obj[i]].concat(args));\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t},\r\n\r\n\tlimitExecByInterval: function (fn, time, context) {\r\n\t\tvar lock, execOnUnlock;\r\n\r\n\t\treturn function wrapperFn() {\r\n\t\t\tvar args = arguments;\r\n\r\n\t\t\tif (lock) {\r\n\t\t\t\texecOnUnlock = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlock = true;\r\n\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tlock = false;\r\n\r\n\t\t\t\tif (execOnUnlock) {\r\n\t\t\t\t\twrapperFn.apply(context, args);\r\n\t\t\t\t\texecOnUnlock = false;\r\n\t\t\t\t}\r\n\t\t\t}, time);\r\n\r\n\t\t\tfn.apply(context, args);\r\n\t\t};\r\n\t},\r\n\r\n\tfalseFn: function () {\r\n\t\treturn false;\r\n\t},\r\n\r\n\tformatNum: function (num, digits) {\r\n\t\tvar pow = Math.pow(10, digits || 5);\r\n\t\treturn Math.round(num * pow) / pow;\r\n\t},\r\n\r\n\ttrim: function (str) {\r\n\t\treturn str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\r\n\t},\r\n\r\n\tsplitWords: function (str) {\r\n\t\treturn L.Util.trim(str).split(/\\s+/);\r\n\t},\r\n\r\n\tsetOptions: function (obj, options) {\r\n\t\tobj.options = L.extend({}, obj.options, options);\r\n\t\treturn obj.options;\r\n\t},\r\n\r\n\tgetParamString: function (obj, existingUrl, uppercase) {\r\n\t\tvar params = [];\r\n\t\tfor (var i in obj) {\r\n\t\t\tparams.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\r\n\t\t}\r\n\t\treturn ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\r\n\t},\r\n\ttemplate: function (str, data) {\r\n\t\treturn str.replace(/\\{ *([\\w_]+) *\\}/g, function (str, key) {\r\n\t\t\tvar value = data[key];\r\n\t\t\tif (value === undefined) {\r\n\t\t\t\tthrow new Error('No value provided for variable ' + str);\r\n\t\t\t} else if (typeof value === 'function') {\r\n\t\t\t\tvalue = value(data);\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t});\r\n\t},\r\n\r\n\tisArray: Array.isArray || function (obj) {\r\n\t\treturn (Object.prototype.toString.call(obj) === '[object Array]');\r\n\t},\r\n\r\n\temptyImageUrl: 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs='\r\n};\r\n\r\n(function () {\r\n\r\n\t// inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\r\n\r\n\tfunction getPrefixed(name) {\r\n\t\tvar i, fn,\r\n\t\t    prefixes = ['webkit', 'moz', 'o', 'ms'];\r\n\r\n\t\tfor (i = 0; i < prefixes.length && !fn; i++) {\r\n\t\t\tfn = window[prefixes[i] + name];\r\n\t\t}\r\n\r\n\t\treturn fn;\r\n\t}\r\n\r\n\tvar lastTime = 0;\r\n\r\n\tfunction timeoutDefer(fn) {\r\n\t\tvar time = +new Date(),\r\n\t\t    timeToCall = Math.max(0, 16 - (time - lastTime));\r\n\r\n\t\tlastTime = time + timeToCall;\r\n\t\treturn window.setTimeout(fn, timeToCall);\r\n\t}\r\n\r\n\tvar requestFn = window.requestAnimationFrame ||\r\n\t        getPrefixed('RequestAnimationFrame') || timeoutDefer;\r\n\r\n\tvar cancelFn = window.cancelAnimationFrame ||\r\n\t        getPrefixed('CancelAnimationFrame') ||\r\n\t        getPrefixed('CancelRequestAnimationFrame') ||\r\n\t        function (id) { window.clearTimeout(id); };\r\n\r\n\r\n\tL.Util.requestAnimFrame = function (fn, context, immediate, element) {\r\n\t\tfn = L.bind(fn, context);\r\n\r\n\t\tif (immediate && requestFn === timeoutDefer) {\r\n\t\t\tfn();\r\n\t\t} else {\r\n\t\t\treturn requestFn.call(window, fn, element);\r\n\t\t}\r\n\t};\r\n\r\n\tL.Util.cancelAnimFrame = function (id) {\r\n\t\tif (id) {\r\n\t\t\tcancelFn.call(window, id);\r\n\t\t}\r\n\t};\r\n\r\n}());\r\n\r\n// shortcuts for most used utility functions\r\nL.extend = L.Util.extend;\r\nL.bind = L.Util.bind;\r\nL.stamp = L.Util.stamp;\r\nL.setOptions = L.Util.setOptions;\r\n\n\n/*\r\n * L.Class powers the OOP facilities of the library.\r\n * Thanks to John Resig and Dean Edwards for inspiration!\r\n */\r\n\r\nL.Class = function () {};\r\n\r\nL.Class.extend = function (props) {\r\n\r\n\t// extended class with the new prototype\r\n\tvar NewClass = function () {\r\n\r\n\t\t// call the constructor\r\n\t\tif (this.initialize) {\r\n\t\t\tthis.initialize.apply(this, arguments);\r\n\t\t}\r\n\r\n\t\t// call all constructor hooks\r\n\t\tif (this._initHooks) {\r\n\t\t\tthis.callInitHooks();\r\n\t\t}\r\n\t};\r\n\r\n\t// instantiate class without calling constructor\r\n\tvar F = function () {};\r\n\tF.prototype = this.prototype;\r\n\r\n\tvar proto = new F();\r\n\tproto.constructor = NewClass;\r\n\r\n\tNewClass.prototype = proto;\r\n\r\n\t//inherit parent's statics\r\n\tfor (var i in this) {\r\n\t\tif (this.hasOwnProperty(i) && i !== 'prototype') {\r\n\t\t\tNewClass[i] = this[i];\r\n\t\t}\r\n\t}\r\n\r\n\t// mix static properties into the class\r\n\tif (props.statics) {\r\n\t\tL.extend(NewClass, props.statics);\r\n\t\tdelete props.statics;\r\n\t}\r\n\r\n\t// mix includes into the prototype\r\n\tif (props.includes) {\r\n\t\tL.Util.extend.apply(null, [proto].concat(props.includes));\r\n\t\tdelete props.includes;\r\n\t}\r\n\r\n\t// merge options\r\n\tif (props.options && proto.options) {\r\n\t\tprops.options = L.extend({}, proto.options, props.options);\r\n\t}\r\n\r\n\t// mix given properties into the prototype\r\n\tL.extend(proto, props);\r\n\r\n\tproto._initHooks = [];\r\n\r\n\tvar parent = this;\r\n\t// jshint camelcase: false\r\n\tNewClass.__super__ = parent.prototype;\r\n\r\n\t// add method for calling all hooks\r\n\tproto.callInitHooks = function () {\r\n\r\n\t\tif (this._initHooksCalled) { return; }\r\n\r\n\t\tif (parent.prototype.callInitHooks) {\r\n\t\t\tparent.prototype.callInitHooks.call(this);\r\n\t\t}\r\n\r\n\t\tthis._initHooksCalled = true;\r\n\r\n\t\tfor (var i = 0, len = proto._initHooks.length; i < len; i++) {\r\n\t\t\tproto._initHooks[i].call(this);\r\n\t\t}\r\n\t};\r\n\r\n\treturn NewClass;\r\n};\r\n\r\n\r\n// method for adding properties to prototype\r\nL.Class.include = function (props) {\r\n\tL.extend(this.prototype, props);\r\n};\r\n\r\n// merge new default options to the Class\r\nL.Class.mergeOptions = function (options) {\r\n\tL.extend(this.prototype.options, options);\r\n};\r\n\r\n// add a constructor hook\r\nL.Class.addInitHook = function (fn) { // (Function) || (String, args...)\r\n\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\r\n\tvar init = typeof fn === 'function' ? fn : function () {\r\n\t\tthis[fn].apply(this, args);\r\n\t};\r\n\r\n\tthis.prototype._initHooks = this.prototype._initHooks || [];\r\n\tthis.prototype._initHooks.push(init);\r\n};\r\n\n\n/*\r\n * L.Mixin.Events is used to add custom events functionality to Leaflet classes.\r\n */\r\n\r\nvar eventsKey = '_leaflet_events';\r\n\r\nL.Mixin = {};\r\n\r\nL.Mixin.Events = {\r\n\r\n\taddEventListener: function (types, fn, context) { // (String, Function[, Object]) or (Object[, Object])\r\n\r\n\t\t// types can be a map of types/handlers\r\n\t\tif (L.Util.invokeEach(types, this.addEventListener, this, fn, context)) { return this; }\r\n\r\n\t\tvar events = this[eventsKey] = this[eventsKey] || {},\r\n\t\t    contextId = context && context !== this && L.stamp(context),\r\n\t\t    i, len, event, type, indexKey, indexLenKey, typeIndex;\r\n\r\n\t\t// types can be a string of space-separated words\r\n\t\ttypes = L.Util.splitWords(types);\r\n\r\n\t\tfor (i = 0, len = types.length; i < len; i++) {\r\n\t\t\tevent = {\r\n\t\t\t\taction: fn,\r\n\t\t\t\tcontext: context || this\r\n\t\t\t};\r\n\t\t\ttype = types[i];\r\n\r\n\t\t\tif (contextId) {\r\n\t\t\t\t// store listeners of a particular context in a separate hash (if it has an id)\r\n\t\t\t\t// gives a major performance boost when removing thousands of map layers\r\n\r\n\t\t\t\tindexKey = type + '_idx';\r\n\t\t\t\tindexLenKey = indexKey + '_len';\r\n\r\n\t\t\t\ttypeIndex = events[indexKey] = events[indexKey] || {};\r\n\r\n\t\t\t\tif (!typeIndex[contextId]) {\r\n\t\t\t\t\ttypeIndex[contextId] = [];\r\n\r\n\t\t\t\t\t// keep track of the number of keys in the index to quickly check if it's empty\r\n\t\t\t\t\tevents[indexLenKey] = (events[indexLenKey] || 0) + 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttypeIndex[contextId].push(event);\r\n\r\n\r\n\t\t\t} else {\r\n\t\t\t\tevents[type] = events[type] || [];\r\n\t\t\t\tevents[type].push(event);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\thasEventListeners: function (type) { // (String) -> Boolean\r\n\t\tvar events = this[eventsKey];\r\n\t\treturn !!events && ((type in events && events[type].length > 0) ||\r\n\t\t                    (type + '_idx' in events && events[type + '_idx_len'] > 0));\r\n\t},\r\n\r\n\tremoveEventListener: function (types, fn, context) { // ([String, Function, Object]) or (Object[, Object])\r\n\r\n\t\tif (!this[eventsKey]) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tif (!types) {\r\n\t\t\treturn this.clearAllEventListeners();\r\n\t\t}\r\n\r\n\t\tif (L.Util.invokeEach(types, this.removeEventListener, this, fn, context)) { return this; }\r\n\r\n\t\tvar events = this[eventsKey],\r\n\t\t    contextId = context && context !== this && L.stamp(context),\r\n\t\t    i, len, type, listeners, j, indexKey, indexLenKey, typeIndex, removed;\r\n\r\n\t\ttypes = L.Util.splitWords(types);\r\n\r\n\t\tfor (i = 0, len = types.length; i < len; i++) {\r\n\t\t\ttype = types[i];\r\n\t\t\tindexKey = type + '_idx';\r\n\t\t\tindexLenKey = indexKey + '_len';\r\n\r\n\t\t\ttypeIndex = events[indexKey];\r\n\r\n\t\t\tif (!fn) {\r\n\t\t\t\t// clear all listeners for a type if function isn't specified\r\n\t\t\t\tdelete events[type];\r\n\t\t\t\tdelete events[indexKey];\r\n\t\t\t\tdelete events[indexLenKey];\r\n\r\n\t\t\t} else {\r\n\t\t\t\tlisteners = contextId && typeIndex ? typeIndex[contextId] : events[type];\r\n\r\n\t\t\t\tif (listeners) {\r\n\t\t\t\t\tfor (j = listeners.length - 1; j >= 0; j--) {\r\n\t\t\t\t\t\tif ((listeners[j].action === fn) && (!context || (listeners[j].context === context))) {\r\n\t\t\t\t\t\t\tremoved = listeners.splice(j, 1);\r\n\t\t\t\t\t\t\t// set the old action to a no-op, because it is possible\r\n\t\t\t\t\t\t\t// that the listener is being iterated over as part of a dispatch\r\n\t\t\t\t\t\t\tremoved[0].action = L.Util.falseFn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (context && typeIndex && (listeners.length === 0)) {\r\n\t\t\t\t\t\tdelete typeIndex[contextId];\r\n\t\t\t\t\t\tevents[indexLenKey]--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tclearAllEventListeners: function () {\r\n\t\tdelete this[eventsKey];\r\n\t\treturn this;\r\n\t},\r\n\r\n\tfireEvent: function (type, data) { // (String[, Object])\r\n\t\tif (!this.hasEventListeners(type)) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar event = L.Util.extend({}, data, { type: type, target: this });\r\n\r\n\t\tvar events = this[eventsKey],\r\n\t\t    listeners, i, len, typeIndex, contextId;\r\n\r\n\t\tif (events[type]) {\r\n\t\t\t// make sure adding/removing listeners inside other listeners won't cause infinite loop\r\n\t\t\tlisteners = events[type].slice();\r\n\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tlisteners[i].action.call(listeners[i].context, event);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// fire event for the context-indexed listeners as well\r\n\t\ttypeIndex = events[type + '_idx'];\r\n\r\n\t\tfor (contextId in typeIndex) {\r\n\t\t\tlisteners = typeIndex[contextId].slice();\r\n\r\n\t\t\tif (listeners) {\r\n\t\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\t\tlisteners[i].action.call(listeners[i].context, event);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\taddOneTimeEventListener: function (types, fn, context) {\r\n\r\n\t\tif (L.Util.invokeEach(types, this.addOneTimeEventListener, this, fn, context)) { return this; }\r\n\r\n\t\tvar handler = L.bind(function () {\r\n\t\t\tthis\r\n\t\t\t    .removeEventListener(types, fn, context)\r\n\t\t\t    .removeEventListener(types, handler, context);\r\n\t\t}, this);\r\n\r\n\t\treturn this\r\n\t\t    .addEventListener(types, fn, context)\r\n\t\t    .addEventListener(types, handler, context);\r\n\t}\r\n};\r\n\r\nL.Mixin.Events.on = L.Mixin.Events.addEventListener;\r\nL.Mixin.Events.off = L.Mixin.Events.removeEventListener;\r\nL.Mixin.Events.once = L.Mixin.Events.addOneTimeEventListener;\r\nL.Mixin.Events.fire = L.Mixin.Events.fireEvent;\r\n\n\n/*\r\n * L.Browser handles different browser and feature detections for internal Leaflet use.\r\n */\r\n\r\n(function () {\r\n\r\n\tvar ie = 'ActiveXObject' in window,\r\n\t\tielt9 = ie && !document.addEventListener,\r\n\r\n\t    // terrible browser detection to work around Safari / iOS / Android browser bugs\r\n\t    ua = navigator.userAgent.toLowerCase(),\r\n\t    webkit = ua.indexOf('webkit') !== -1,\r\n\t    chrome = ua.indexOf('chrome') !== -1,\r\n\t    phantomjs = ua.indexOf('phantom') !== -1,\r\n\t    android = ua.indexOf('android') !== -1,\r\n\t    android23 = ua.search('android [23]') !== -1,\r\n\t\tgecko = ua.indexOf('gecko') !== -1,\r\n\r\n\t    mobile = typeof orientation !== undefined + '',\r\n\t    msPointer = !window.PointerEvent && window.MSPointerEvent,\r\n\t\tpointer = (window.PointerEvent && window.navigator.pointerEnabled) ||\r\n\t\t\t\t  msPointer,\r\n\t    retina = ('devicePixelRatio' in window && window.devicePixelRatio > 1) ||\r\n\t             ('matchMedia' in window && window.matchMedia('(min-resolution:144dpi)') &&\r\n\t              window.matchMedia('(min-resolution:144dpi)').matches),\r\n\r\n\t    doc = document.documentElement,\r\n\t    ie3d = ie && ('transition' in doc.style),\r\n\t    webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23,\r\n\t    gecko3d = 'MozPerspective' in doc.style,\r\n\t    opera3d = 'OTransition' in doc.style,\r\n\t    any3d = !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d || opera3d) && !phantomjs;\r\n\r\n\tvar touch = !window.L_NO_TOUCH && !phantomjs && (pointer || 'ontouchstart' in window ||\r\n\t\t(window.DocumentTouch && document instanceof window.DocumentTouch));\r\n\r\n\tL.Browser = {\r\n\t\tie: ie,\r\n\t\tielt9: ielt9,\r\n\t\twebkit: webkit,\r\n\t\tgecko: gecko && !webkit && !window.opera && !ie,\r\n\r\n\t\tandroid: android,\r\n\t\tandroid23: android23,\r\n\r\n\t\tchrome: chrome,\r\n\r\n\t\tie3d: ie3d,\r\n\t\twebkit3d: webkit3d,\r\n\t\tgecko3d: gecko3d,\r\n\t\topera3d: opera3d,\r\n\t\tany3d: any3d,\r\n\r\n\t\tmobile: mobile,\r\n\t\tmobileWebkit: mobile && webkit,\r\n\t\tmobileWebkit3d: mobile && webkit3d,\r\n\t\tmobileOpera: mobile && window.opera,\r\n\r\n\t\ttouch: touch,\r\n\t\tmsPointer: msPointer,\r\n\t\tpointer: pointer,\r\n\r\n\t\tretina: retina\r\n\t};\r\n\r\n}());\r\n\n\n/*\r\n * L.Point represents a point with x and y coordinates.\r\n */\r\n\r\nL.Point = function (/*Number*/ x, /*Number*/ y, /*Boolean*/ round) {\r\n\tthis.x = (round ? Math.round(x) : x);\r\n\tthis.y = (round ? Math.round(y) : y);\r\n};\r\n\r\nL.Point.prototype = {\r\n\r\n\tclone: function () {\r\n\t\treturn new L.Point(this.x, this.y);\r\n\t},\r\n\r\n\t// non-destructive, returns a new point\r\n\tadd: function (point) {\r\n\t\treturn this.clone()._add(L.point(point));\r\n\t},\r\n\r\n\t// destructive, used directly for performance in situations where it's safe to modify existing point\r\n\t_add: function (point) {\r\n\t\tthis.x += point.x;\r\n\t\tthis.y += point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsubtract: function (point) {\r\n\t\treturn this.clone()._subtract(L.point(point));\r\n\t},\r\n\r\n\t_subtract: function (point) {\r\n\t\tthis.x -= point.x;\r\n\t\tthis.y -= point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\tdivideBy: function (num) {\r\n\t\treturn this.clone()._divideBy(num);\r\n\t},\r\n\r\n\t_divideBy: function (num) {\r\n\t\tthis.x /= num;\r\n\t\tthis.y /= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\tmultiplyBy: function (num) {\r\n\t\treturn this.clone()._multiplyBy(num);\r\n\t},\r\n\r\n\t_multiplyBy: function (num) {\r\n\t\tthis.x *= num;\r\n\t\tthis.y *= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\tround: function () {\r\n\t\treturn this.clone()._round();\r\n\t},\r\n\r\n\t_round: function () {\r\n\t\tthis.x = Math.round(this.x);\r\n\t\tthis.y = Math.round(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\tfloor: function () {\r\n\t\treturn this.clone()._floor();\r\n\t},\r\n\r\n\t_floor: function () {\r\n\t\tthis.x = Math.floor(this.x);\r\n\t\tthis.y = Math.floor(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\tdistanceTo: function (point) {\r\n\t\tpoint = L.point(point);\r\n\r\n\t\tvar x = point.x - this.x,\r\n\t\t    y = point.y - this.y;\r\n\r\n\t\treturn Math.sqrt(x * x + y * y);\r\n\t},\r\n\r\n\tequals: function (point) {\r\n\t\tpoint = L.point(point);\r\n\r\n\t\treturn point.x === this.x &&\r\n\t\t       point.y === this.y;\r\n\t},\r\n\r\n\tcontains: function (point) {\r\n\t\tpoint = L.point(point);\r\n\r\n\t\treturn Math.abs(point.x) <= Math.abs(this.x) &&\r\n\t\t       Math.abs(point.y) <= Math.abs(this.y);\r\n\t},\r\n\r\n\ttoString: function () {\r\n\t\treturn 'Point(' +\r\n\t\t        L.Util.formatNum(this.x) + ', ' +\r\n\t\t        L.Util.formatNum(this.y) + ')';\r\n\t}\r\n};\r\n\r\nL.point = function (x, y, round) {\r\n\tif (x instanceof L.Point) {\r\n\t\treturn x;\r\n\t}\r\n\tif (L.Util.isArray(x)) {\r\n\t\treturn new L.Point(x[0], x[1]);\r\n\t}\r\n\tif (x === undefined || x === null) {\r\n\t\treturn x;\r\n\t}\r\n\treturn new L.Point(x, y, round);\r\n};\r\n\n\n/*\r\n * L.Bounds represents a rectangular area on the screen in pixel coordinates.\r\n */\r\n\r\nL.Bounds = function (a, b) { //(Point, Point) or Point[]\r\n\tif (!a) { return; }\r\n\r\n\tvar points = b ? [a, b] : a;\r\n\r\n\tfor (var i = 0, len = points.length; i < len; i++) {\r\n\t\tthis.extend(points[i]);\r\n\t}\r\n};\r\n\r\nL.Bounds.prototype = {\r\n\t// extend the bounds to contain the given point\r\n\textend: function (point) { // (Point)\r\n\t\tpoint = L.point(point);\r\n\r\n\t\tif (!this.min && !this.max) {\r\n\t\t\tthis.min = point.clone();\r\n\t\t\tthis.max = point.clone();\r\n\t\t} else {\r\n\t\t\tthis.min.x = Math.min(point.x, this.min.x);\r\n\t\t\tthis.max.x = Math.max(point.x, this.max.x);\r\n\t\t\tthis.min.y = Math.min(point.y, this.min.y);\r\n\t\t\tthis.max.y = Math.max(point.y, this.max.y);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tgetCenter: function (round) { // (Boolean) -> Point\r\n\t\treturn new L.Point(\r\n\t\t        (this.min.x + this.max.x) / 2,\r\n\t\t        (this.min.y + this.max.y) / 2, round);\r\n\t},\r\n\r\n\tgetBottomLeft: function () { // -> Point\r\n\t\treturn new L.Point(this.min.x, this.max.y);\r\n\t},\r\n\r\n\tgetTopRight: function () { // -> Point\r\n\t\treturn new L.Point(this.max.x, this.min.y);\r\n\t},\r\n\r\n\tgetSize: function () {\r\n\t\treturn this.max.subtract(this.min);\r\n\t},\r\n\r\n\tcontains: function (obj) { // (Bounds) or (Point) -> Boolean\r\n\t\tvar min, max;\r\n\r\n\t\tif (typeof obj[0] === 'number' || obj instanceof L.Point) {\r\n\t\t\tobj = L.point(obj);\r\n\t\t} else {\r\n\t\t\tobj = L.bounds(obj);\r\n\t\t}\r\n\r\n\t\tif (obj instanceof L.Bounds) {\r\n\t\t\tmin = obj.min;\r\n\t\t\tmax = obj.max;\r\n\t\t} else {\r\n\t\t\tmin = max = obj;\r\n\t\t}\r\n\r\n\t\treturn (min.x >= this.min.x) &&\r\n\t\t       (max.x <= this.max.x) &&\r\n\t\t       (min.y >= this.min.y) &&\r\n\t\t       (max.y <= this.max.y);\r\n\t},\r\n\r\n\tintersects: function (bounds) { // (Bounds) -> Boolean\r\n\t\tbounds = L.bounds(bounds);\r\n\r\n\t\tvar min = this.min,\r\n\t\t    max = this.max,\r\n\t\t    min2 = bounds.min,\r\n\t\t    max2 = bounds.max,\r\n\t\t    xIntersects = (max2.x >= min.x) && (min2.x <= max.x),\r\n\t\t    yIntersects = (max2.y >= min.y) && (min2.y <= max.y);\r\n\r\n\t\treturn xIntersects && yIntersects;\r\n\t},\r\n\r\n\tisValid: function () {\r\n\t\treturn !!(this.min && this.max);\r\n\t}\r\n};\r\n\r\nL.bounds = function (a, b) { // (Bounds) or (Point, Point) or (Point[])\r\n\tif (!a || a instanceof L.Bounds) {\r\n\t\treturn a;\r\n\t}\r\n\treturn new L.Bounds(a, b);\r\n};\r\n\n\n/*\r\n * L.Transformation is an utility class to perform simple point transformations through a 2d-matrix.\r\n */\r\n\r\nL.Transformation = function (a, b, c, d) {\r\n\tthis._a = a;\r\n\tthis._b = b;\r\n\tthis._c = c;\r\n\tthis._d = d;\r\n};\r\n\r\nL.Transformation.prototype = {\r\n\ttransform: function (point, scale) { // (Point, Number) -> Point\r\n\t\treturn this._transform(point.clone(), scale);\r\n\t},\r\n\r\n\t// destructive transform (faster)\r\n\t_transform: function (point, scale) {\r\n\t\tscale = scale || 1;\r\n\t\tpoint.x = scale * (this._a * point.x + this._b);\r\n\t\tpoint.y = scale * (this._c * point.y + this._d);\r\n\t\treturn point;\r\n\t},\r\n\r\n\tuntransform: function (point, scale) {\r\n\t\tscale = scale || 1;\r\n\t\treturn new L.Point(\r\n\t\t        (point.x / scale - this._b) / this._a,\r\n\t\t        (point.y / scale - this._d) / this._c);\r\n\t}\r\n};\r\n\n\n/*\r\n * L.DomUtil contains various utility functions for working with DOM.\r\n */\r\n\r\nL.DomUtil = {\r\n\tget: function (id) {\r\n\t\treturn (typeof id === 'string' ? document.getElementById(id) : id);\r\n\t},\r\n\r\n\tgetStyle: function (el, style) {\r\n\r\n\t\tvar value = el.style[style];\r\n\r\n\t\tif (!value && el.currentStyle) {\r\n\t\t\tvalue = el.currentStyle[style];\r\n\t\t}\r\n\r\n\t\tif ((!value || value === 'auto') && document.defaultView) {\r\n\t\t\tvar css = document.defaultView.getComputedStyle(el, null);\r\n\t\t\tvalue = css ? css[style] : null;\r\n\t\t}\r\n\r\n\t\treturn value === 'auto' ? null : value;\r\n\t},\r\n\r\n\tgetViewportOffset: function (element) {\r\n\r\n\t\tvar top = 0,\r\n\t\t    left = 0,\r\n\t\t    el = element,\r\n\t\t    docBody = document.body,\r\n\t\t    docEl = document.documentElement,\r\n\t\t    pos;\r\n\r\n\t\tdo {\r\n\t\t\ttop  += el.offsetTop  || 0;\r\n\t\t\tleft += el.offsetLeft || 0;\r\n\r\n\t\t\t//add borders\r\n\t\t\ttop += parseInt(L.DomUtil.getStyle(el, 'borderTopWidth'), 10) || 0;\r\n\t\t\tleft += parseInt(L.DomUtil.getStyle(el, 'borderLeftWidth'), 10) || 0;\r\n\r\n\t\t\tpos = L.DomUtil.getStyle(el, 'position');\r\n\r\n\t\t\tif (el.offsetParent === docBody && pos === 'absolute') { break; }\r\n\r\n\t\t\tif (pos === 'fixed') {\r\n\t\t\t\ttop  += docBody.scrollTop  || docEl.scrollTop  || 0;\r\n\t\t\t\tleft += docBody.scrollLeft || docEl.scrollLeft || 0;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (pos === 'relative' && !el.offsetLeft) {\r\n\t\t\t\tvar width = L.DomUtil.getStyle(el, 'width'),\r\n\t\t\t\t    maxWidth = L.DomUtil.getStyle(el, 'max-width'),\r\n\t\t\t\t    r = el.getBoundingClientRect();\r\n\r\n\t\t\t\tif (width !== 'none' || maxWidth !== 'none') {\r\n\t\t\t\t\tleft += r.left + el.clientLeft;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//calculate full y offset since we're breaking out of the loop\r\n\t\t\t\ttop += r.top + (docBody.scrollTop  || docEl.scrollTop  || 0);\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tel = el.offsetParent;\r\n\r\n\t\t} while (el);\r\n\r\n\t\tel = element;\r\n\r\n\t\tdo {\r\n\t\t\tif (el === docBody) { break; }\r\n\r\n\t\t\ttop  -= el.scrollTop  || 0;\r\n\t\t\tleft -= el.scrollLeft || 0;\r\n\r\n\t\t\tel = el.parentNode;\r\n\t\t} while (el);\r\n\r\n\t\treturn new L.Point(left, top);\r\n\t},\r\n\r\n\tdocumentIsLtr: function () {\r\n\t\tif (!L.DomUtil._docIsLtrCached) {\r\n\t\t\tL.DomUtil._docIsLtrCached = true;\r\n\t\t\tL.DomUtil._docIsLtr = L.DomUtil.getStyle(document.body, 'direction') === 'ltr';\r\n\t\t}\r\n\t\treturn L.DomUtil._docIsLtr;\r\n\t},\r\n\r\n\tcreate: function (tagName, className, container) {\r\n\r\n\t\tvar el = document.createElement(tagName);\r\n\t\tel.className = className;\r\n\r\n\t\tif (container) {\r\n\t\t\tcontainer.appendChild(el);\r\n\t\t}\r\n\r\n\t\treturn el;\r\n\t},\r\n\r\n\thasClass: function (el, name) {\r\n\t\tif (el.classList !== undefined) {\r\n\t\t\treturn el.classList.contains(name);\r\n\t\t}\r\n\t\tvar className = L.DomUtil._getClass(el);\r\n\t\treturn className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\r\n\t},\r\n\r\n\taddClass: function (el, name) {\r\n\t\tif (el.classList !== undefined) {\r\n\t\t\tvar classes = L.Util.splitWords(name);\r\n\t\t\tfor (var i = 0, len = classes.length; i < len; i++) {\r\n\t\t\t\tel.classList.add(classes[i]);\r\n\t\t\t}\r\n\t\t} else if (!L.DomUtil.hasClass(el, name)) {\r\n\t\t\tvar className = L.DomUtil._getClass(el);\r\n\t\t\tL.DomUtil._setClass(el, (className ? className + ' ' : '') + name);\r\n\t\t}\r\n\t},\r\n\r\n\tremoveClass: function (el, name) {\r\n\t\tif (el.classList !== undefined) {\r\n\t\t\tel.classList.remove(name);\r\n\t\t} else {\r\n\t\t\tL.DomUtil._setClass(el, L.Util.trim((' ' + L.DomUtil._getClass(el) + ' ').replace(' ' + name + ' ', ' ')));\r\n\t\t}\r\n\t},\r\n\r\n\t_setClass: function (el, name) {\r\n\t\tif (el.className.baseVal === undefined) {\r\n\t\t\tel.className = name;\r\n\t\t} else {\r\n\t\t\t// in case of SVG element\r\n\t\t\tel.className.baseVal = name;\r\n\t\t}\r\n\t},\r\n\r\n\t_getClass: function (el) {\r\n\t\treturn el.className.baseVal === undefined ? el.className : el.className.baseVal;\r\n\t},\r\n\r\n\tsetOpacity: function (el, value) {\r\n\r\n\t\tif ('opacity' in el.style) {\r\n\t\t\tel.style.opacity = value;\r\n\r\n\t\t} else if ('filter' in el.style) {\r\n\r\n\t\t\tvar filter = false,\r\n\t\t\t    filterName = 'DXImageTransform.Microsoft.Alpha';\r\n\r\n\t\t\t// filters collection throws an error if we try to retrieve a filter that doesn't exist\r\n\t\t\ttry {\r\n\t\t\t\tfilter = el.filters.item(filterName);\r\n\t\t\t} catch (e) {\r\n\t\t\t\t// don't set opacity to 1 if we haven't already set an opacity,\r\n\t\t\t\t// it isn't needed and breaks transparent pngs.\r\n\t\t\t\tif (value === 1) { return; }\r\n\t\t\t}\r\n\r\n\t\t\tvalue = Math.round(value * 100);\r\n\r\n\t\t\tif (filter) {\r\n\t\t\t\tfilter.Enabled = (value !== 100);\r\n\t\t\t\tfilter.Opacity = value;\r\n\t\t\t} else {\r\n\t\t\t\tel.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\ttestProp: function (props) {\r\n\r\n\t\tvar style = document.documentElement.style;\r\n\r\n\t\tfor (var i = 0; i < props.length; i++) {\r\n\t\t\tif (props[i] in style) {\r\n\t\t\t\treturn props[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\tgetTranslateString: function (point) {\r\n\t\t// on WebKit browsers (Chrome/Safari/iOS Safari/Android) using translate3d instead of translate\r\n\t\t// makes animation smoother as it ensures HW accel is used. Firefox 13 doesn't care\r\n\t\t// (same speed either way), Opera 12 doesn't support translate3d\r\n\r\n\t\tvar is3d = L.Browser.webkit3d,\r\n\t\t    open = 'translate' + (is3d ? '3d' : '') + '(',\r\n\t\t    close = (is3d ? ',0' : '') + ')';\r\n\r\n\t\treturn open + point.x + 'px,' + point.y + 'px' + close;\r\n\t},\r\n\r\n\tgetScaleString: function (scale, origin) {\r\n\r\n\t\tvar preTranslateStr = L.DomUtil.getTranslateString(origin.add(origin.multiplyBy(-1 * scale))),\r\n\t\t    scaleStr = ' scale(' + scale + ') ';\r\n\r\n\t\treturn preTranslateStr + scaleStr;\r\n\t},\r\n\r\n\tsetPosition: function (el, point, disable3D) { // (HTMLElement, Point[, Boolean])\r\n\r\n\t\t// jshint camelcase: false\r\n\t\tel._leaflet_pos = point;\r\n\r\n\t\tif (!disable3D && L.Browser.any3d) {\r\n\t\t\tel.style[L.DomUtil.TRANSFORM] =  L.DomUtil.getTranslateString(point);\r\n\t\t} else {\r\n\t\t\tel.style.left = point.x + 'px';\r\n\t\t\tel.style.top = point.y + 'px';\r\n\t\t}\r\n\t},\r\n\r\n\tgetPosition: function (el) {\r\n\t\t// this method is only used for elements previously positioned using setPosition,\r\n\t\t// so it's safe to cache the position for performance\r\n\r\n\t\t// jshint camelcase: false\r\n\t\treturn el._leaflet_pos;\r\n\t}\r\n};\r\n\r\n\r\n// prefix style property names\r\n\r\nL.DomUtil.TRANSFORM = L.DomUtil.testProp(\r\n        ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\r\n\r\n// webkitTransition comes first because some browser versions that drop vendor prefix don't do\r\n// the same for the transitionend event, in particular the Android 4.1 stock browser\r\n\r\nL.DomUtil.TRANSITION = L.DomUtil.testProp(\r\n        ['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);\r\n\r\nL.DomUtil.TRANSITION_END =\r\n        L.DomUtil.TRANSITION === 'webkitTransition' || L.DomUtil.TRANSITION === 'OTransition' ?\r\n        L.DomUtil.TRANSITION + 'End' : 'transitionend';\r\n\r\n(function () {\r\n    if ('onselectstart' in document) {\r\n        L.extend(L.DomUtil, {\r\n            disableTextSelection: function () {\r\n                L.DomEvent.on(window, 'selectstart', L.DomEvent.preventDefault);\r\n            },\r\n\r\n            enableTextSelection: function () {\r\n                L.DomEvent.off(window, 'selectstart', L.DomEvent.preventDefault);\r\n            }\r\n        });\r\n    } else {\r\n        var userSelectProperty = L.DomUtil.testProp(\r\n            ['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);\r\n\r\n        L.extend(L.DomUtil, {\r\n            disableTextSelection: function () {\r\n                if (userSelectProperty) {\r\n                    var style = document.documentElement.style;\r\n                    this._userSelect = style[userSelectProperty];\r\n                    style[userSelectProperty] = 'none';\r\n                }\r\n            },\r\n\r\n            enableTextSelection: function () {\r\n                if (userSelectProperty) {\r\n                    document.documentElement.style[userSelectProperty] = this._userSelect;\r\n                    delete this._userSelect;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\tL.extend(L.DomUtil, {\r\n\t\tdisableImageDrag: function () {\r\n\t\t\tL.DomEvent.on(window, 'dragstart', L.DomEvent.preventDefault);\r\n\t\t},\r\n\r\n\t\tenableImageDrag: function () {\r\n\t\t\tL.DomEvent.off(window, 'dragstart', L.DomEvent.preventDefault);\r\n\t\t}\r\n\t});\r\n})();\r\n\n\n/*\r\n * L.LatLng represents a geographical point with latitude and longitude coordinates.\r\n */\r\n\r\nL.LatLng = function (lat, lng, alt) { // (Number, Number, Number)\r\n\tlat = parseFloat(lat);\r\n\tlng = parseFloat(lng);\r\n\r\n\tif (isNaN(lat) || isNaN(lng)) {\r\n\t\tthrow new Error('Invalid LatLng object: (' + lat + ', ' + lng + ')');\r\n\t}\r\n\r\n\tthis.lat = lat;\r\n\tthis.lng = lng;\r\n\r\n\tif (alt !== undefined) {\r\n\t\tthis.alt = parseFloat(alt);\r\n\t}\r\n};\r\n\r\nL.extend(L.LatLng, {\r\n\tDEG_TO_RAD: Math.PI / 180,\r\n\tRAD_TO_DEG: 180 / Math.PI,\r\n\tMAX_MARGIN: 1.0E-9 // max margin of error for the \"equals\" check\r\n});\r\n\r\nL.LatLng.prototype = {\r\n\tequals: function (obj) { // (LatLng) -> Boolean\r\n\t\tif (!obj) { return false; }\r\n\r\n\t\tobj = L.latLng(obj);\r\n\r\n\t\tvar margin = Math.max(\r\n\t\t        Math.abs(this.lat - obj.lat),\r\n\t\t        Math.abs(this.lng - obj.lng));\r\n\r\n\t\treturn margin <= L.LatLng.MAX_MARGIN;\r\n\t},\r\n\r\n\ttoString: function (precision) { // (Number) -> String\r\n\t\treturn 'LatLng(' +\r\n\t\t        L.Util.formatNum(this.lat, precision) + ', ' +\r\n\t\t        L.Util.formatNum(this.lng, precision) + ')';\r\n\t},\r\n\r\n\t// Haversine distance formula, see http://en.wikipedia.org/wiki/Haversine_formula\r\n\t// TODO move to projection code, LatLng shouldn't know about Earth\r\n\tdistanceTo: function (other) { // (LatLng) -> Number\r\n\t\tother = L.latLng(other);\r\n\r\n\t\tvar R = 6378137, // earth radius in meters\r\n\t\t    d2r = L.LatLng.DEG_TO_RAD,\r\n\t\t    dLat = (other.lat - this.lat) * d2r,\r\n\t\t    dLon = (other.lng - this.lng) * d2r,\r\n\t\t    lat1 = this.lat * d2r,\r\n\t\t    lat2 = other.lat * d2r,\r\n\t\t    sin1 = Math.sin(dLat / 2),\r\n\t\t    sin2 = Math.sin(dLon / 2);\r\n\r\n\t\tvar a = sin1 * sin1 + sin2 * sin2 * Math.cos(lat1) * Math.cos(lat2);\r\n\r\n\t\treturn R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n\t},\r\n\r\n\twrap: function (a, b) { // (Number, Number) -> LatLng\r\n\t\tvar lng = this.lng;\r\n\r\n\t\ta = a || -180;\r\n\t\tb = b ||  180;\r\n\r\n\t\tlng = (lng + b) % (b - a) + (lng < a || lng === b ? b : a);\r\n\r\n\t\treturn new L.LatLng(this.lat, lng);\r\n\t}\r\n};\r\n\r\nL.latLng = function (a, b) { // (LatLng) or ([Number, Number]) or (Number, Number)\r\n\tif (a instanceof L.LatLng) {\r\n\t\treturn a;\r\n\t}\r\n\tif (L.Util.isArray(a)) {\r\n\t\tif (typeof a[0] === 'number' || typeof a[0] === 'string') {\r\n\t\t\treturn new L.LatLng(a[0], a[1], a[2]);\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\tif (a === undefined || a === null) {\r\n\t\treturn a;\r\n\t}\r\n\tif (typeof a === 'object' && 'lat' in a) {\r\n\t\treturn new L.LatLng(a.lat, 'lng' in a ? a.lng : a.lon);\r\n\t}\r\n\tif (b === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\treturn new L.LatLng(a, b);\r\n};\r\n\r\n\n\n/*\r\n * L.LatLngBounds represents a rectangular area on the map in geographical coordinates.\r\n */\r\n\r\nL.LatLngBounds = function (southWest, northEast) { // (LatLng, LatLng) or (LatLng[])\r\n\tif (!southWest) { return; }\r\n\r\n\tvar latlngs = northEast ? [southWest, northEast] : southWest;\r\n\r\n\tfor (var i = 0, len = latlngs.length; i < len; i++) {\r\n\t\tthis.extend(latlngs[i]);\r\n\t}\r\n};\r\n\r\nL.LatLngBounds.prototype = {\r\n\t// extend the bounds to contain the given point or bounds\r\n\textend: function (obj) { // (LatLng) or (LatLngBounds)\r\n\t\tif (!obj) { return this; }\r\n\r\n\t\tvar latLng = L.latLng(obj);\r\n\t\tif (latLng !== null) {\r\n\t\t\tobj = latLng;\r\n\t\t} else {\r\n\t\t\tobj = L.latLngBounds(obj);\r\n\t\t}\r\n\r\n\t\tif (obj instanceof L.LatLng) {\r\n\t\t\tif (!this._southWest && !this._northEast) {\r\n\t\t\t\tthis._southWest = new L.LatLng(obj.lat, obj.lng);\r\n\t\t\t\tthis._northEast = new L.LatLng(obj.lat, obj.lng);\r\n\t\t\t} else {\r\n\t\t\t\tthis._southWest.lat = Math.min(obj.lat, this._southWest.lat);\r\n\t\t\t\tthis._southWest.lng = Math.min(obj.lng, this._southWest.lng);\r\n\r\n\t\t\t\tthis._northEast.lat = Math.max(obj.lat, this._northEast.lat);\r\n\t\t\t\tthis._northEast.lng = Math.max(obj.lng, this._northEast.lng);\r\n\t\t\t}\r\n\t\t} else if (obj instanceof L.LatLngBounds) {\r\n\t\t\tthis.extend(obj._southWest);\r\n\t\t\tthis.extend(obj._northEast);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// extend the bounds by a percentage\r\n\tpad: function (bufferRatio) { // (Number) -> LatLngBounds\r\n\t\tvar sw = this._southWest,\r\n\t\t    ne = this._northEast,\r\n\t\t    heightBuffer = Math.abs(sw.lat - ne.lat) * bufferRatio,\r\n\t\t    widthBuffer = Math.abs(sw.lng - ne.lng) * bufferRatio;\r\n\r\n\t\treturn new L.LatLngBounds(\r\n\t\t        new L.LatLng(sw.lat - heightBuffer, sw.lng - widthBuffer),\r\n\t\t        new L.LatLng(ne.lat + heightBuffer, ne.lng + widthBuffer));\r\n\t},\r\n\r\n\tgetCenter: function () { // -> LatLng\r\n\t\treturn new L.LatLng(\r\n\t\t        (this._southWest.lat + this._northEast.lat) / 2,\r\n\t\t        (this._southWest.lng + this._northEast.lng) / 2);\r\n\t},\r\n\r\n\tgetSouthWest: function () {\r\n\t\treturn this._southWest;\r\n\t},\r\n\r\n\tgetNorthEast: function () {\r\n\t\treturn this._northEast;\r\n\t},\r\n\r\n\tgetNorthWest: function () {\r\n\t\treturn new L.LatLng(this.getNorth(), this.getWest());\r\n\t},\r\n\r\n\tgetSouthEast: function () {\r\n\t\treturn new L.LatLng(this.getSouth(), this.getEast());\r\n\t},\r\n\r\n\tgetWest: function () {\r\n\t\treturn this._southWest.lng;\r\n\t},\r\n\r\n\tgetSouth: function () {\r\n\t\treturn this._southWest.lat;\r\n\t},\r\n\r\n\tgetEast: function () {\r\n\t\treturn this._northEast.lng;\r\n\t},\r\n\r\n\tgetNorth: function () {\r\n\t\treturn this._northEast.lat;\r\n\t},\r\n\r\n\tcontains: function (obj) { // (LatLngBounds) or (LatLng) -> Boolean\r\n\t\tif (typeof obj[0] === 'number' || obj instanceof L.LatLng) {\r\n\t\t\tobj = L.latLng(obj);\r\n\t\t} else {\r\n\t\t\tobj = L.latLngBounds(obj);\r\n\t\t}\r\n\r\n\t\tvar sw = this._southWest,\r\n\t\t    ne = this._northEast,\r\n\t\t    sw2, ne2;\r\n\r\n\t\tif (obj instanceof L.LatLngBounds) {\r\n\t\t\tsw2 = obj.getSouthWest();\r\n\t\t\tne2 = obj.getNorthEast();\r\n\t\t} else {\r\n\t\t\tsw2 = ne2 = obj;\r\n\t\t}\r\n\r\n\t\treturn (sw2.lat >= sw.lat) && (ne2.lat <= ne.lat) &&\r\n\t\t       (sw2.lng >= sw.lng) && (ne2.lng <= ne.lng);\r\n\t},\r\n\r\n\tintersects: function (bounds) { // (LatLngBounds)\r\n\t\tbounds = L.latLngBounds(bounds);\r\n\r\n\t\tvar sw = this._southWest,\r\n\t\t    ne = this._northEast,\r\n\t\t    sw2 = bounds.getSouthWest(),\r\n\t\t    ne2 = bounds.getNorthEast(),\r\n\r\n\t\t    latIntersects = (ne2.lat >= sw.lat) && (sw2.lat <= ne.lat),\r\n\t\t    lngIntersects = (ne2.lng >= sw.lng) && (sw2.lng <= ne.lng);\r\n\r\n\t\treturn latIntersects && lngIntersects;\r\n\t},\r\n\r\n\ttoBBoxString: function () {\r\n\t\treturn [this.getWest(), this.getSouth(), this.getEast(), this.getNorth()].join(',');\r\n\t},\r\n\r\n\tequals: function (bounds) { // (LatLngBounds)\r\n\t\tif (!bounds) { return false; }\r\n\r\n\t\tbounds = L.latLngBounds(bounds);\r\n\r\n\t\treturn this._southWest.equals(bounds.getSouthWest()) &&\r\n\t\t       this._northEast.equals(bounds.getNorthEast());\r\n\t},\r\n\r\n\tisValid: function () {\r\n\t\treturn !!(this._southWest && this._northEast);\r\n\t}\r\n};\r\n\r\n//TODO International date line?\r\n\r\nL.latLngBounds = function (a, b) { // (LatLngBounds) or (LatLng, LatLng)\r\n\tif (!a || a instanceof L.LatLngBounds) {\r\n\t\treturn a;\r\n\t}\r\n\treturn new L.LatLngBounds(a, b);\r\n};\r\n\n\n/*\r\n * L.Projection contains various geographical projections used by CRS classes.\r\n */\r\n\r\nL.Projection = {};\r\n\n\n/*\r\n * Spherical Mercator is the most popular map projection, used by EPSG:3857 CRS used by default.\r\n */\r\n\r\nL.Projection.SphericalMercator = {\r\n\tMAX_LATITUDE: 85.0511287798,\r\n\r\n\tproject: function (latlng) { // (LatLng) -> Point\r\n\t\tvar d = L.LatLng.DEG_TO_RAD,\r\n\t\t    max = this.MAX_LATITUDE,\r\n\t\t    lat = Math.max(Math.min(max, latlng.lat), -max),\r\n\t\t    x = latlng.lng * d,\r\n\t\t    y = lat * d;\r\n\r\n\t\ty = Math.log(Math.tan((Math.PI / 4) + (y / 2)));\r\n\r\n\t\treturn new L.Point(x, y);\r\n\t},\r\n\r\n\tunproject: function (point) { // (Point, Boolean) -> LatLng\r\n\t\tvar d = L.LatLng.RAD_TO_DEG,\r\n\t\t    lng = point.x * d,\r\n\t\t    lat = (2 * Math.atan(Math.exp(point.y)) - (Math.PI / 2)) * d;\r\n\r\n\t\treturn new L.LatLng(lat, lng);\r\n\t}\r\n};\r\n\n\n/*\r\n * Simple equirectangular (Plate Carree) projection, used by CRS like EPSG:4326 and Simple.\r\n */\r\n\r\nL.Projection.LonLat = {\r\n\tproject: function (latlng) {\r\n\t\treturn new L.Point(latlng.lng, latlng.lat);\r\n\t},\r\n\r\n\tunproject: function (point) {\r\n\t\treturn new L.LatLng(point.y, point.x);\r\n\t}\r\n};\r\n\n\n/*\r\n * L.CRS is a base object for all defined CRS (Coordinate Reference Systems) in Leaflet.\r\n */\r\n\r\nL.CRS = {\r\n\tlatLngToPoint: function (latlng, zoom) { // (LatLng, Number) -> Point\r\n\t\tvar projectedPoint = this.projection.project(latlng),\r\n\t\t    scale = this.scale(zoom);\r\n\r\n\t\treturn this.transformation._transform(projectedPoint, scale);\r\n\t},\r\n\r\n\tpointToLatLng: function (point, zoom) { // (Point, Number[, Boolean]) -> LatLng\r\n\t\tvar scale = this.scale(zoom),\r\n\t\t    untransformedPoint = this.transformation.untransform(point, scale);\r\n\r\n\t\treturn this.projection.unproject(untransformedPoint);\r\n\t},\r\n\r\n\tproject: function (latlng) {\r\n\t\treturn this.projection.project(latlng);\r\n\t},\r\n\r\n\tscale: function (zoom) {\r\n\t\treturn 256 * Math.pow(2, zoom);\r\n\t},\r\n\r\n\tgetSize: function (zoom) {\r\n\t\tvar s = this.scale(zoom);\r\n\t\treturn L.point(s, s);\r\n\t}\r\n};\r\n\n\n/*\n * A simple CRS that can be used for flat non-Earth maps like panoramas or game maps.\n */\n\nL.CRS.Simple = L.extend({}, L.CRS, {\n\tprojection: L.Projection.LonLat,\n\ttransformation: new L.Transformation(1, 0, -1, 0),\n\n\tscale: function (zoom) {\n\t\treturn Math.pow(2, zoom);\n\t}\n});\n\n\n/*\r\n * L.CRS.EPSG3857 (Spherical Mercator) is the most common CRS for web mapping\r\n * and is used by Leaflet by default.\r\n */\r\n\r\nL.CRS.EPSG3857 = L.extend({}, L.CRS, {\r\n\tcode: 'EPSG:3857',\r\n\r\n\tprojection: L.Projection.SphericalMercator,\r\n\ttransformation: new L.Transformation(0.5 / Math.PI, 0.5, -0.5 / Math.PI, 0.5),\r\n\r\n\tproject: function (latlng) { // (LatLng) -> Point\r\n\t\tvar projectedPoint = this.projection.project(latlng),\r\n\t\t    earthRadius = 6378137;\r\n\t\treturn projectedPoint.multiplyBy(earthRadius);\r\n\t}\r\n});\r\n\r\nL.CRS.EPSG900913 = L.extend({}, L.CRS.EPSG3857, {\r\n\tcode: 'EPSG:900913'\r\n});\r\n\n\n/*\r\n * L.CRS.EPSG4326 is a CRS popular among advanced GIS specialists.\r\n */\r\n\r\nL.CRS.EPSG4326 = L.extend({}, L.CRS, {\r\n\tcode: 'EPSG:4326',\r\n\r\n\tprojection: L.Projection.LonLat,\r\n\ttransformation: new L.Transformation(1 / 360, 0.5, -1 / 360, 0.5)\r\n});\r\n\n\n/*\r\n * L.Map is the central class of the API - it is used to create a map.\r\n */\r\n\r\nL.Map = L.Class.extend({\r\n\r\n\tincludes: L.Mixin.Events,\r\n\r\n\toptions: {\r\n\t\tcrs: L.CRS.EPSG3857,\r\n\r\n\t\t/*\r\n\t\tcenter: LatLng,\r\n\t\tzoom: Number,\r\n\t\tlayers: Array,\r\n\t\t*/\r\n\r\n\t\tfadeAnimation: L.DomUtil.TRANSITION && !L.Browser.android23,\r\n\t\ttrackResize: true,\r\n\t\tmarkerZoomAnimation: L.DomUtil.TRANSITION && L.Browser.any3d\r\n\t},\r\n\r\n\tinitialize: function (id, options) { // (HTMLElement or String, Object)\r\n\t\toptions = L.setOptions(this, options);\r\n\r\n\r\n\t\tthis._initContainer(id);\r\n\t\tthis._initLayout();\r\n\r\n\t\t// hack for https://github.com/Leaflet/Leaflet/issues/1980\r\n\t\tthis._onResize = L.bind(this._onResize, this);\r\n\r\n\t\tthis._initEvents();\r\n\r\n\t\tif (options.maxBounds) {\r\n\t\t\tthis.setMaxBounds(options.maxBounds);\r\n\t\t}\r\n\r\n\t\tif (options.center && options.zoom !== undefined) {\r\n\t\t\tthis.setView(L.latLng(options.center), options.zoom, {reset: true});\r\n\t\t}\r\n\r\n\t\tthis._handlers = [];\r\n\r\n\t\tthis._layers = {};\r\n\t\tthis._zoomBoundLayers = {};\r\n\t\tthis._tileLayersNum = 0;\r\n\r\n\t\tthis.callInitHooks();\r\n\r\n\t\tthis._addLayers(options.layers);\r\n\t},\r\n\r\n\r\n\t// public methods that modify map state\r\n\r\n\t// replaced by animation-powered implementation in Map.PanAnimation.js\r\n\tsetView: function (center, zoom) {\r\n\t\tzoom = zoom === undefined ? this.getZoom() : zoom;\r\n\t\tthis._resetView(L.latLng(center), this._limitZoom(zoom));\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetZoom: function (zoom, options) {\r\n\t\tif (!this._loaded) {\r\n\t\t\tthis._zoom = this._limitZoom(zoom);\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\treturn this.setView(this.getCenter(), zoom, {zoom: options});\r\n\t},\r\n\r\n\tzoomIn: function (delta, options) {\r\n\t\treturn this.setZoom(this._zoom + (delta || 1), options);\r\n\t},\r\n\r\n\tzoomOut: function (delta, options) {\r\n\t\treturn this.setZoom(this._zoom - (delta || 1), options);\r\n\t},\r\n\r\n\tsetZoomAround: function (latlng, zoom, options) {\r\n\t\tvar scale = this.getZoomScale(zoom),\r\n\t\t    viewHalf = this.getSize().divideBy(2),\r\n\t\t    containerPoint = latlng instanceof L.Point ? latlng : this.latLngToContainerPoint(latlng),\r\n\r\n\t\t    centerOffset = containerPoint.subtract(viewHalf).multiplyBy(1 - 1 / scale),\r\n\t\t    newCenter = this.containerPointToLatLng(viewHalf.add(centerOffset));\r\n\r\n\t\treturn this.setView(newCenter, zoom, {zoom: options});\r\n\t},\r\n\r\n\tfitBounds: function (bounds, options) {\r\n\r\n\t\toptions = options || {};\r\n\t\tbounds = bounds.getBounds ? bounds.getBounds() : L.latLngBounds(bounds);\r\n\r\n\t\tvar paddingTL = L.point(options.paddingTopLeft || options.padding || [0, 0]),\r\n\t\t    paddingBR = L.point(options.paddingBottomRight || options.padding || [0, 0]),\r\n\r\n\t\t    zoom = this.getBoundsZoom(bounds, false, paddingTL.add(paddingBR));\r\n\r\n\t\tzoom = (options.maxZoom) ? Math.min(options.maxZoom, zoom) : zoom;\r\n\r\n\t\tvar paddingOffset = paddingBR.subtract(paddingTL).divideBy(2),\r\n\r\n\t\t    swPoint = this.project(bounds.getSouthWest(), zoom),\r\n\t\t    nePoint = this.project(bounds.getNorthEast(), zoom),\r\n\t\t    center = this.unproject(swPoint.add(nePoint).divideBy(2).add(paddingOffset), zoom);\r\n\r\n\t\treturn this.setView(center, zoom, options);\r\n\t},\r\n\r\n\tfitWorld: function (options) {\r\n\t\treturn this.fitBounds([[-90, -180], [90, 180]], options);\r\n\t},\r\n\r\n\tpanTo: function (center, options) { // (LatLng)\r\n\t\treturn this.setView(center, this._zoom, {pan: options});\r\n\t},\r\n\r\n\tpanBy: function (offset) { // (Point)\r\n\t\t// replaced with animated panBy in Map.PanAnimation.js\r\n\t\tthis.fire('movestart');\r\n\r\n\t\tthis._rawPanBy(L.point(offset));\r\n\r\n\t\tthis.fire('move');\r\n\t\treturn this.fire('moveend');\r\n\t},\r\n\r\n\tsetMaxBounds: function (bounds) {\r\n\t\tbounds = L.latLngBounds(bounds);\r\n\r\n\t\tthis.options.maxBounds = bounds;\r\n\r\n\t\tif (!bounds) {\r\n\t\t\treturn this.off('moveend', this._panInsideMaxBounds, this);\r\n\t\t}\r\n\r\n\t\tif (this._loaded) {\r\n\t\t\tthis._panInsideMaxBounds();\r\n\t\t}\r\n\r\n\t\treturn this.on('moveend', this._panInsideMaxBounds, this);\r\n\t},\r\n\r\n\tpanInsideBounds: function (bounds, options) {\r\n\t\tvar center = this.getCenter(),\r\n\t\t\tnewCenter = this._limitCenter(center, this._zoom, bounds);\r\n\r\n\t\tif (center.equals(newCenter)) { return this; }\r\n\r\n\t\treturn this.panTo(newCenter, options);\r\n\t},\r\n\r\n\taddLayer: function (layer) {\r\n\t\t// TODO method is too big, refactor\r\n\r\n\t\tvar id = L.stamp(layer);\r\n\r\n\t\tif (this._layers[id]) { return this; }\r\n\r\n\t\tthis._layers[id] = layer;\r\n\r\n\t\t// TODO getMaxZoom, getMinZoom in ILayer (instead of options)\r\n\t\tif (layer.options && (!isNaN(layer.options.maxZoom) || !isNaN(layer.options.minZoom))) {\r\n\t\t\tthis._zoomBoundLayers[id] = layer;\r\n\t\t\tthis._updateZoomLevels();\r\n\t\t}\r\n\r\n\t\t// TODO looks ugly, refactor!!!\r\n\t\tif (this.options.zoomAnimation && L.TileLayer && (layer instanceof L.TileLayer)) {\r\n\t\t\tthis._tileLayersNum++;\r\n\t\t\tthis._tileLayersToLoad++;\r\n\t\t\tlayer.on('load', this._onTileLayerLoad, this);\r\n\t\t}\r\n\r\n\t\tif (this._loaded) {\r\n\t\t\tthis._layerAdd(layer);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tremoveLayer: function (layer) {\r\n\t\tvar id = L.stamp(layer);\r\n\r\n\t\tif (!this._layers[id]) { return this; }\r\n\r\n\t\tif (this._loaded) {\r\n\t\t\tlayer.onRemove(this);\r\n\t\t}\r\n\r\n\t\tdelete this._layers[id];\r\n\r\n\t\tif (this._loaded) {\r\n\t\t\tthis.fire('layerremove', {layer: layer});\r\n\t\t}\r\n\r\n\t\tif (this._zoomBoundLayers[id]) {\r\n\t\t\tdelete this._zoomBoundLayers[id];\r\n\t\t\tthis._updateZoomLevels();\r\n\t\t}\r\n\r\n\t\t// TODO looks ugly, refactor\r\n\t\tif (this.options.zoomAnimation && L.TileLayer && (layer instanceof L.TileLayer)) {\r\n\t\t\tthis._tileLayersNum--;\r\n\t\t\tthis._tileLayersToLoad--;\r\n\t\t\tlayer.off('load', this._onTileLayerLoad, this);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\thasLayer: function (layer) {\r\n\t\tif (!layer) { return false; }\r\n\r\n\t\treturn (L.stamp(layer) in this._layers);\r\n\t},\r\n\r\n\teachLayer: function (method, context) {\r\n\t\tfor (var i in this._layers) {\r\n\t\t\tmethod.call(context, this._layers[i]);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tinvalidateSize: function (options) {\r\n\t\tif (!this._loaded) { return this; }\r\n\r\n\t\toptions = L.extend({\r\n\t\t\tanimate: false,\r\n\t\t\tpan: true\r\n\t\t}, options === true ? {animate: true} : options);\r\n\r\n\t\tvar oldSize = this.getSize();\r\n\t\tthis._sizeChanged = true;\r\n\t\tthis._initialCenter = null;\r\n\r\n\t\tvar newSize = this.getSize(),\r\n\t\t    oldCenter = oldSize.divideBy(2).round(),\r\n\t\t    newCenter = newSize.divideBy(2).round(),\r\n\t\t    offset = oldCenter.subtract(newCenter);\r\n\r\n\t\tif (!offset.x && !offset.y) { return this; }\r\n\r\n\t\tif (options.animate && options.pan) {\r\n\t\t\tthis.panBy(offset);\r\n\r\n\t\t} else {\r\n\t\t\tif (options.pan) {\r\n\t\t\t\tthis._rawPanBy(offset);\r\n\t\t\t}\r\n\r\n\t\t\tthis.fire('move');\r\n\r\n\t\t\tif (options.debounceMoveend) {\r\n\t\t\t\tclearTimeout(this._sizeTimer);\r\n\t\t\t\tthis._sizeTimer = setTimeout(L.bind(this.fire, this, 'moveend'), 200);\r\n\t\t\t} else {\r\n\t\t\t\tthis.fire('moveend');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.fire('resize', {\r\n\t\t\toldSize: oldSize,\r\n\t\t\tnewSize: newSize\r\n\t\t});\r\n\t},\r\n\r\n\t// TODO handler.addTo\r\n\taddHandler: function (name, HandlerClass) {\r\n\t\tif (!HandlerClass) { return this; }\r\n\r\n\t\tvar handler = this[name] = new HandlerClass(this);\r\n\r\n\t\tthis._handlers.push(handler);\r\n\r\n\t\tif (this.options[name]) {\r\n\t\t\thandler.enable();\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tremove: function () {\r\n\t\tif (this._loaded) {\r\n\t\t\tthis.fire('unload');\r\n\t\t}\r\n\r\n\t\tthis._initEvents('off');\r\n\r\n\t\ttry {\r\n\t\t\t// throws error in IE6-8\r\n\t\t\tdelete this._container._leaflet;\r\n\t\t} catch (e) {\r\n\t\t\tthis._container._leaflet = undefined;\r\n\t\t}\r\n\r\n\t\tthis._clearPanes();\r\n\t\tif (this._clearControlPos) {\r\n\t\t\tthis._clearControlPos();\r\n\t\t}\r\n\r\n\t\tthis._clearHandlers();\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\r\n\t// public methods for getting map state\r\n\r\n\tgetCenter: function () { // (Boolean) -> LatLng\r\n\t\tthis._checkIfLoaded();\r\n\r\n\t\tif (this._initialCenter && !this._moved()) {\r\n\t\t\treturn this._initialCenter;\r\n\t\t}\r\n\t\treturn this.layerPointToLatLng(this._getCenterLayerPoint());\r\n\t},\r\n\r\n\tgetZoom: function () {\r\n\t\treturn this._zoom;\r\n\t},\r\n\r\n\tgetBounds: function () {\r\n\t\tvar bounds = this.getPixelBounds(),\r\n\t\t    sw = this.unproject(bounds.getBottomLeft()),\r\n\t\t    ne = this.unproject(bounds.getTopRight());\r\n\r\n\t\treturn new L.LatLngBounds(sw, ne);\r\n\t},\r\n\r\n\tgetMinZoom: function () {\r\n\t\treturn this.options.minZoom === undefined ?\r\n\t\t\t(this._layersMinZoom === undefined ? 0 : this._layersMinZoom) :\r\n\t\t\tthis.options.minZoom;\r\n\t},\r\n\r\n\tgetMaxZoom: function () {\r\n\t\treturn this.options.maxZoom === undefined ?\r\n\t\t\t(this._layersMaxZoom === undefined ? Infinity : this._layersMaxZoom) :\r\n\t\t\tthis.options.maxZoom;\r\n\t},\r\n\r\n\tgetBoundsZoom: function (bounds, inside, padding) { // (LatLngBounds[, Boolean, Point]) -> Number\r\n\t\tbounds = L.latLngBounds(bounds);\r\n\r\n\t\tvar zoom = this.getMinZoom() - (inside ? 1 : 0),\r\n\t\t    maxZoom = this.getMaxZoom(),\r\n\t\t    size = this.getSize(),\r\n\r\n\t\t    nw = bounds.getNorthWest(),\r\n\t\t    se = bounds.getSouthEast(),\r\n\r\n\t\t    zoomNotFound = true,\r\n\t\t    boundsSize;\r\n\r\n\t\tpadding = L.point(padding || [0, 0]);\r\n\r\n\t\tdo {\r\n\t\t\tzoom++;\r\n\t\t\tboundsSize = this.project(se, zoom).subtract(this.project(nw, zoom)).add(padding);\r\n\t\t\tzoomNotFound = !inside ? size.contains(boundsSize) : boundsSize.x < size.x || boundsSize.y < size.y;\r\n\r\n\t\t} while (zoomNotFound && zoom <= maxZoom);\r\n\r\n\t\tif (zoomNotFound && inside) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn inside ? zoom : zoom - 1;\r\n\t},\r\n\r\n\tgetSize: function () {\r\n\t\tif (!this._size || this._sizeChanged) {\r\n\t\t\tthis._size = new L.Point(\r\n\t\t\t\tthis._container.clientWidth,\r\n\t\t\t\tthis._container.clientHeight);\r\n\r\n\t\t\tthis._sizeChanged = false;\r\n\t\t}\r\n\t\treturn this._size.clone();\r\n\t},\r\n\r\n\tgetPixelBounds: function () {\r\n\t\tvar topLeftPoint = this._getTopLeftPoint();\r\n\t\treturn new L.Bounds(topLeftPoint, topLeftPoint.add(this.getSize()));\r\n\t},\r\n\r\n\tgetPixelOrigin: function () {\r\n\t\tthis._checkIfLoaded();\r\n\t\treturn this._initialTopLeftPoint;\r\n\t},\r\n\r\n\tgetPanes: function () {\r\n\t\treturn this._panes;\r\n\t},\r\n\r\n\tgetContainer: function () {\r\n\t\treturn this._container;\r\n\t},\r\n\r\n\r\n\t// TODO replace with universal implementation after refactoring projections\r\n\r\n\tgetZoomScale: function (toZoom) {\r\n\t\tvar crs = this.options.crs;\r\n\t\treturn crs.scale(toZoom) / crs.scale(this._zoom);\r\n\t},\r\n\r\n\tgetScaleZoom: function (scale) {\r\n\t\treturn this._zoom + (Math.log(scale) / Math.LN2);\r\n\t},\r\n\r\n\r\n\t// conversion methods\r\n\r\n\tproject: function (latlng, zoom) { // (LatLng[, Number]) -> Point\r\n\t\tzoom = zoom === undefined ? this._zoom : zoom;\r\n\t\treturn this.options.crs.latLngToPoint(L.latLng(latlng), zoom);\r\n\t},\r\n\r\n\tunproject: function (point, zoom) { // (Point[, Number]) -> LatLng\r\n\t\tzoom = zoom === undefined ? this._zoom : zoom;\r\n\t\treturn this.options.crs.pointToLatLng(L.point(point), zoom);\r\n\t},\r\n\r\n\tlayerPointToLatLng: function (point) { // (Point)\r\n\t\tvar projectedPoint = L.point(point).add(this.getPixelOrigin());\r\n\t\treturn this.unproject(projectedPoint);\r\n\t},\r\n\r\n\tlatLngToLayerPoint: function (latlng) { // (LatLng)\r\n\t\tvar projectedPoint = this.project(L.latLng(latlng))._round();\r\n\t\treturn projectedPoint._subtract(this.getPixelOrigin());\r\n\t},\r\n\r\n\tcontainerPointToLayerPoint: function (point) { // (Point)\r\n\t\treturn L.point(point).subtract(this._getMapPanePos());\r\n\t},\r\n\r\n\tlayerPointToContainerPoint: function (point) { // (Point)\r\n\t\treturn L.point(point).add(this._getMapPanePos());\r\n\t},\r\n\r\n\tcontainerPointToLatLng: function (point) {\r\n\t\tvar layerPoint = this.containerPointToLayerPoint(L.point(point));\r\n\t\treturn this.layerPointToLatLng(layerPoint);\r\n\t},\r\n\r\n\tlatLngToContainerPoint: function (latlng) {\r\n\t\treturn this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(latlng)));\r\n\t},\r\n\r\n\tmouseEventToContainerPoint: function (e) { // (MouseEvent)\r\n\t\treturn L.DomEvent.getMousePosition(e, this._container);\r\n\t},\r\n\r\n\tmouseEventToLayerPoint: function (e) { // (MouseEvent)\r\n\t\treturn this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e));\r\n\t},\r\n\r\n\tmouseEventToLatLng: function (e) { // (MouseEvent)\r\n\t\treturn this.layerPointToLatLng(this.mouseEventToLayerPoint(e));\r\n\t},\r\n\r\n\r\n\t// map initialization methods\r\n\r\n\t_initContainer: function (id) {\r\n\t\tvar container = this._container = L.DomUtil.get(id);\r\n\r\n\t\tif (!container) {\r\n\t\t\tthrow new Error('Map container not found.');\r\n\t\t} else if (container._leaflet) {\r\n\t\t\tthrow new Error('Map container is already initialized.');\r\n\t\t}\r\n\r\n\t\tcontainer._leaflet = true;\r\n\t},\r\n\r\n\t_initLayout: function () {\r\n\t\tvar container = this._container;\r\n\r\n\t\tL.DomUtil.addClass(container, 'leaflet-container' +\r\n\t\t\t(L.Browser.touch ? ' leaflet-touch' : '') +\r\n\t\t\t(L.Browser.retina ? ' leaflet-retina' : '') +\r\n\t\t\t(L.Browser.ielt9 ? ' leaflet-oldie' : '') +\r\n\t\t\t(this.options.fadeAnimation ? ' leaflet-fade-anim' : ''));\r\n\r\n\t\tvar position = L.DomUtil.getStyle(container, 'position');\r\n\r\n\t\tif (position !== 'absolute' && position !== 'relative' && position !== 'fixed') {\r\n\t\t\tcontainer.style.position = 'relative';\r\n\t\t}\r\n\r\n\t\tthis._initPanes();\r\n\r\n\t\tif (this._initControlPos) {\r\n\t\t\tthis._initControlPos();\r\n\t\t}\r\n\t},\r\n\r\n\t_initPanes: function () {\r\n\t\tvar panes = this._panes = {};\r\n\r\n\t\tthis._mapPane = panes.mapPane = this._createPane('leaflet-map-pane', this._container);\r\n\r\n\t\tthis._tilePane = panes.tilePane = this._createPane('leaflet-tile-pane', this._mapPane);\r\n\t\tpanes.objectsPane = this._createPane('leaflet-objects-pane', this._mapPane);\r\n\t\tpanes.shadowPane = this._createPane('leaflet-shadow-pane');\r\n\t\tpanes.overlayPane = this._createPane('leaflet-overlay-pane');\r\n\t\tpanes.markerPane = this._createPane('leaflet-marker-pane');\r\n\t\tpanes.popupPane = this._createPane('leaflet-popup-pane');\r\n\r\n\t\tvar zoomHide = ' leaflet-zoom-hide';\r\n\r\n\t\tif (!this.options.markerZoomAnimation) {\r\n\t\t\tL.DomUtil.addClass(panes.markerPane, zoomHide);\r\n\t\t\tL.DomUtil.addClass(panes.shadowPane, zoomHide);\r\n\t\t\tL.DomUtil.addClass(panes.popupPane, zoomHide);\r\n\t\t}\r\n\t},\r\n\r\n\t_createPane: function (className, container) {\r\n\t\treturn L.DomUtil.create('div', className, container || this._panes.objectsPane);\r\n\t},\r\n\r\n\t_clearPanes: function () {\r\n\t\tthis._container.removeChild(this._mapPane);\r\n\t},\r\n\r\n\t_addLayers: function (layers) {\r\n\t\tlayers = layers ? (L.Util.isArray(layers) ? layers : [layers]) : [];\r\n\r\n\t\tfor (var i = 0, len = layers.length; i < len; i++) {\r\n\t\t\tthis.addLayer(layers[i]);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t// private methods that modify map state\r\n\r\n\t_resetView: function (center, zoom, preserveMapOffset, afterZoomAnim) {\r\n\r\n\t\tvar zoomChanged = (this._zoom !== zoom);\r\n\r\n\t\tif (!afterZoomAnim) {\r\n\t\t\tthis.fire('movestart');\r\n\r\n\t\t\tif (zoomChanged) {\r\n\t\t\t\tthis.fire('zoomstart');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._zoom = zoom;\r\n\t\tthis._initialCenter = center;\r\n\r\n\t\tthis._initialTopLeftPoint = this._getNewTopLeftPoint(center);\r\n\r\n\t\tif (!preserveMapOffset) {\r\n\t\t\tL.DomUtil.setPosition(this._mapPane, new L.Point(0, 0));\r\n\t\t} else {\r\n\t\t\tthis._initialTopLeftPoint._add(this._getMapPanePos());\r\n\t\t}\r\n\r\n\t\tthis._tileLayersToLoad = this._tileLayersNum;\r\n\r\n\t\tvar loading = !this._loaded;\r\n\t\tthis._loaded = true;\r\n\r\n\t\tthis.fire('viewreset', {hard: !preserveMapOffset});\r\n\r\n\t\tif (loading) {\r\n\t\t\tthis.fire('load');\r\n\t\t\tthis.eachLayer(this._layerAdd, this);\r\n\t\t}\r\n\r\n\t\tthis.fire('move');\r\n\r\n\t\tif (zoomChanged || afterZoomAnim) {\r\n\t\t\tthis.fire('zoomend');\r\n\t\t}\r\n\r\n\t\tthis.fire('moveend', {hard: !preserveMapOffset});\r\n\t},\r\n\r\n\t_rawPanBy: function (offset) {\r\n\t\tL.DomUtil.setPosition(this._mapPane, this._getMapPanePos().subtract(offset));\r\n\t},\r\n\r\n\t_getZoomSpan: function () {\r\n\t\treturn this.getMaxZoom() - this.getMinZoom();\r\n\t},\r\n\r\n\t_updateZoomLevels: function () {\r\n\t\tvar i,\r\n\t\t\tminZoom = Infinity,\r\n\t\t\tmaxZoom = -Infinity,\r\n\t\t\toldZoomSpan = this._getZoomSpan();\r\n\r\n\t\tfor (i in this._zoomBoundLayers) {\r\n\t\t\tvar layer = this._zoomBoundLayers[i];\r\n\t\t\tif (!isNaN(layer.options.minZoom)) {\r\n\t\t\t\tminZoom = Math.min(minZoom, layer.options.minZoom);\r\n\t\t\t}\r\n\t\t\tif (!isNaN(layer.options.maxZoom)) {\r\n\t\t\t\tmaxZoom = Math.max(maxZoom, layer.options.maxZoom);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (i === undefined) { // we have no tilelayers\r\n\t\t\tthis._layersMaxZoom = this._layersMinZoom = undefined;\r\n\t\t} else {\r\n\t\t\tthis._layersMaxZoom = maxZoom;\r\n\t\t\tthis._layersMinZoom = minZoom;\r\n\t\t}\r\n\r\n\t\tif (oldZoomSpan !== this._getZoomSpan()) {\r\n\t\t\tthis.fire('zoomlevelschange');\r\n\t\t}\r\n\t},\r\n\r\n\t_panInsideMaxBounds: function () {\r\n\t\tthis.panInsideBounds(this.options.maxBounds);\r\n\t},\r\n\r\n\t_checkIfLoaded: function () {\r\n\t\tif (!this._loaded) {\r\n\t\t\tthrow new Error('Set map center and zoom first.');\r\n\t\t}\r\n\t},\r\n\r\n\t// map events\r\n\r\n\t_initEvents: function (onOff) {\r\n\t\tif (!L.DomEvent) { return; }\r\n\r\n\t\tonOff = onOff || 'on';\r\n\r\n\t\tL.DomEvent[onOff](this._container, 'click', this._onMouseClick, this);\r\n\r\n\t\tvar events = ['dblclick', 'mousedown', 'mouseup', 'mouseenter',\r\n\t\t              'mouseleave', 'mousemove', 'contextmenu'],\r\n\t\t    i, len;\r\n\r\n\t\tfor (i = 0, len = events.length; i < len; i++) {\r\n\t\t\tL.DomEvent[onOff](this._container, events[i], this._fireMouseEvent, this);\r\n\t\t}\r\n\r\n\t\tif (this.options.trackResize) {\r\n\t\t\tL.DomEvent[onOff](window, 'resize', this._onResize, this);\r\n\t\t}\r\n\t},\r\n\r\n\t_onResize: function () {\r\n\t\tL.Util.cancelAnimFrame(this._resizeRequest);\r\n\t\tthis._resizeRequest = L.Util.requestAnimFrame(\r\n\t\t        function () { this.invalidateSize({debounceMoveend: true}); }, this, false, this._container);\r\n\t},\r\n\r\n\t_onMouseClick: function (e) {\r\n\t\tif (!this._loaded || (!e._simulated &&\r\n\t\t        ((this.dragging && this.dragging.moved()) ||\r\n\t\t         (this.boxZoom  && this.boxZoom.moved()))) ||\r\n\t\t            L.DomEvent._skipped(e)) { return; }\r\n\r\n\t\tthis.fire('preclick');\r\n\t\tthis._fireMouseEvent(e);\r\n\t},\r\n\r\n\t_fireMouseEvent: function (e) {\r\n\t\tif (!this._loaded || L.DomEvent._skipped(e)) { return; }\r\n\r\n\t\tvar type = e.type;\r\n\r\n\t\ttype = (type === 'mouseenter' ? 'mouseover' : (type === 'mouseleave' ? 'mouseout' : type));\r\n\r\n\t\tif (!this.hasEventListeners(type)) { return; }\r\n\r\n\t\tif (type === 'contextmenu') {\r\n\t\t\tL.DomEvent.preventDefault(e);\r\n\t\t}\r\n\r\n\t\tvar containerPoint = this.mouseEventToContainerPoint(e),\r\n\t\t    layerPoint = this.containerPointToLayerPoint(containerPoint),\r\n\t\t    latlng = this.layerPointToLatLng(layerPoint);\r\n\r\n\t\tthis.fire(type, {\r\n\t\t\tlatlng: latlng,\r\n\t\t\tlayerPoint: layerPoint,\r\n\t\t\tcontainerPoint: containerPoint,\r\n\t\t\toriginalEvent: e\r\n\t\t});\r\n\t},\r\n\r\n\t_onTileLayerLoad: function () {\r\n\t\tthis._tileLayersToLoad--;\r\n\t\tif (this._tileLayersNum && !this._tileLayersToLoad) {\r\n\t\t\tthis.fire('tilelayersload');\r\n\t\t}\r\n\t},\r\n\r\n\t_clearHandlers: function () {\r\n\t\tfor (var i = 0, len = this._handlers.length; i < len; i++) {\r\n\t\t\tthis._handlers[i].disable();\r\n\t\t}\r\n\t},\r\n\r\n\twhenReady: function (callback, context) {\r\n\t\tif (this._loaded) {\r\n\t\t\tcallback.call(context || this, this);\r\n\t\t} else {\r\n\t\t\tthis.on('load', callback, context);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_layerAdd: function (layer) {\r\n\t\tlayer.onAdd(this);\r\n\t\tthis.fire('layeradd', {layer: layer});\r\n\t},\r\n\r\n\r\n\t// private methods for getting map state\r\n\r\n\t_getMapPanePos: function () {\r\n\t\treturn L.DomUtil.getPosition(this._mapPane);\r\n\t},\r\n\r\n\t_moved: function () {\r\n\t\tvar pos = this._getMapPanePos();\r\n\t\treturn pos && !pos.equals([0, 0]);\r\n\t},\r\n\r\n\t_getTopLeftPoint: function () {\r\n\t\treturn this.getPixelOrigin().subtract(this._getMapPanePos());\r\n\t},\r\n\r\n\t_getNewTopLeftPoint: function (center, zoom) {\r\n\t\tvar viewHalf = this.getSize()._divideBy(2);\r\n\t\t// TODO round on display, not calculation to increase precision?\r\n\t\treturn this.project(center, zoom)._subtract(viewHalf)._round();\r\n\t},\r\n\r\n\t_latLngToNewLayerPoint: function (latlng, newZoom, newCenter) {\r\n\t\tvar topLeft = this._getNewTopLeftPoint(newCenter, newZoom).add(this._getMapPanePos());\r\n\t\treturn this.project(latlng, newZoom)._subtract(topLeft);\r\n\t},\r\n\r\n\t// layer point of the current center\r\n\t_getCenterLayerPoint: function () {\r\n\t\treturn this.containerPointToLayerPoint(this.getSize()._divideBy(2));\r\n\t},\r\n\r\n\t// offset of the specified place to the current center in pixels\r\n\t_getCenterOffset: function (latlng) {\r\n\t\treturn this.latLngToLayerPoint(latlng).subtract(this._getCenterLayerPoint());\r\n\t},\r\n\r\n\t// adjust center for view to get inside bounds\r\n\t_limitCenter: function (center, zoom, bounds) {\r\n\r\n\t\tif (!bounds) { return center; }\r\n\r\n\t\tvar centerPoint = this.project(center, zoom),\r\n\t\t    viewHalf = this.getSize().divideBy(2),\r\n\t\t    viewBounds = new L.Bounds(centerPoint.subtract(viewHalf), centerPoint.add(viewHalf)),\r\n\t\t    offset = this._getBoundsOffset(viewBounds, bounds, zoom);\r\n\r\n\t\treturn this.unproject(centerPoint.add(offset), zoom);\r\n\t},\r\n\r\n\t// adjust offset for view to get inside bounds\r\n\t_limitOffset: function (offset, bounds) {\r\n\t\tif (!bounds) { return offset; }\r\n\r\n\t\tvar viewBounds = this.getPixelBounds(),\r\n\t\t    newBounds = new L.Bounds(viewBounds.min.add(offset), viewBounds.max.add(offset));\r\n\r\n\t\treturn offset.add(this._getBoundsOffset(newBounds, bounds));\r\n\t},\r\n\r\n\t// returns offset needed for pxBounds to get inside maxBounds at a specified zoom\r\n\t_getBoundsOffset: function (pxBounds, maxBounds, zoom) {\r\n\t\tvar nwOffset = this.project(maxBounds.getNorthWest(), zoom).subtract(pxBounds.min),\r\n\t\t    seOffset = this.project(maxBounds.getSouthEast(), zoom).subtract(pxBounds.max),\r\n\r\n\t\t    dx = this._rebound(nwOffset.x, -seOffset.x),\r\n\t\t    dy = this._rebound(nwOffset.y, -seOffset.y);\r\n\r\n\t\treturn new L.Point(dx, dy);\r\n\t},\r\n\r\n\t_rebound: function (left, right) {\r\n\t\treturn left + right > 0 ?\r\n\t\t\tMath.round(left - right) / 2 :\r\n\t\t\tMath.max(0, Math.ceil(left)) - Math.max(0, Math.floor(right));\r\n\t},\r\n\r\n\t_limitZoom: function (zoom) {\r\n\t\tvar min = this.getMinZoom(),\r\n\t\t    max = this.getMaxZoom();\r\n\r\n\t\treturn Math.max(min, Math.min(max, zoom));\r\n\t}\r\n});\r\n\r\nL.map = function (id, options) {\r\n\treturn new L.Map(id, options);\r\n};\r\n\n\n/*\r\n * Mercator projection that takes into account that the Earth is not a perfect sphere.\r\n * Less popular than spherical mercator; used by projections like EPSG:3395.\r\n */\r\n\r\nL.Projection.Mercator = {\r\n\tMAX_LATITUDE: 85.0840591556,\r\n\r\n\tR_MINOR: 6356752.314245179,\r\n\tR_MAJOR: 6378137,\r\n\r\n\tproject: function (latlng) { // (LatLng) -> Point\r\n\t\tvar d = L.LatLng.DEG_TO_RAD,\r\n\t\t    max = this.MAX_LATITUDE,\r\n\t\t    lat = Math.max(Math.min(max, latlng.lat), -max),\r\n\t\t    r = this.R_MAJOR,\r\n\t\t    r2 = this.R_MINOR,\r\n\t\t    x = latlng.lng * d * r,\r\n\t\t    y = lat * d,\r\n\t\t    tmp = r2 / r,\r\n\t\t    eccent = Math.sqrt(1.0 - tmp * tmp),\r\n\t\t    con = eccent * Math.sin(y);\r\n\r\n\t\tcon = Math.pow((1 - con) / (1 + con), eccent * 0.5);\r\n\r\n\t\tvar ts = Math.tan(0.5 * ((Math.PI * 0.5) - y)) / con;\r\n\t\ty = -r * Math.log(ts);\r\n\r\n\t\treturn new L.Point(x, y);\r\n\t},\r\n\r\n\tunproject: function (point) { // (Point, Boolean) -> LatLng\r\n\t\tvar d = L.LatLng.RAD_TO_DEG,\r\n\t\t    r = this.R_MAJOR,\r\n\t\t    r2 = this.R_MINOR,\r\n\t\t    lng = point.x * d / r,\r\n\t\t    tmp = r2 / r,\r\n\t\t    eccent = Math.sqrt(1 - (tmp * tmp)),\r\n\t\t    ts = Math.exp(- point.y / r),\r\n\t\t    phi = (Math.PI / 2) - 2 * Math.atan(ts),\r\n\t\t    numIter = 15,\r\n\t\t    tol = 1e-7,\r\n\t\t    i = numIter,\r\n\t\t    dphi = 0.1,\r\n\t\t    con;\r\n\r\n\t\twhile ((Math.abs(dphi) > tol) && (--i > 0)) {\r\n\t\t\tcon = eccent * Math.sin(phi);\r\n\t\t\tdphi = (Math.PI / 2) - 2 * Math.atan(ts *\r\n\t\t\t            Math.pow((1.0 - con) / (1.0 + con), 0.5 * eccent)) - phi;\r\n\t\t\tphi += dphi;\r\n\t\t}\r\n\r\n\t\treturn new L.LatLng(phi * d, lng);\r\n\t}\r\n};\r\n\n\n\r\nL.CRS.EPSG3395 = L.extend({}, L.CRS, {\r\n\tcode: 'EPSG:3395',\r\n\r\n\tprojection: L.Projection.Mercator,\r\n\r\n\ttransformation: (function () {\r\n\t\tvar m = L.Projection.Mercator,\r\n\t\t    r = m.R_MAJOR,\r\n\t\t    scale = 0.5 / (Math.PI * r);\r\n\r\n\t\treturn new L.Transformation(scale, 0.5, -scale, 0.5);\r\n\t}())\r\n});\r\n\n\n/*\r\n * L.TileLayer is used for standard xyz-numbered tile layers.\r\n */\r\n\r\nL.TileLayer = L.Class.extend({\r\n\tincludes: L.Mixin.Events,\r\n\r\n\toptions: {\r\n\t\tminZoom: 0,\r\n\t\tmaxZoom: 18,\r\n\t\ttileSize: 256,\r\n\t\tsubdomains: 'abc',\r\n\t\terrorTileUrl: '',\r\n\t\tattribution: '',\r\n\t\tzoomOffset: 0,\r\n\t\topacity: 1,\r\n\t\t/*\r\n\t\tmaxNativeZoom: null,\r\n\t\tzIndex: null,\r\n\t\ttms: false,\r\n\t\tcontinuousWorld: false,\r\n\t\tnoWrap: false,\r\n\t\tzoomReverse: false,\r\n\t\tdetectRetina: false,\r\n\t\treuseTiles: false,\r\n\t\tbounds: false,\r\n\t\t*/\r\n\t\tunloadInvisibleTiles: L.Browser.mobile,\r\n\t\tupdateWhenIdle: L.Browser.mobile\r\n\t},\r\n\r\n\tinitialize: function (url, options) {\r\n\t\toptions = L.setOptions(this, options);\r\n\r\n\t\t// detecting retina displays, adjusting tileSize and zoom levels\r\n\t\tif (options.detectRetina && L.Browser.retina && options.maxZoom > 0) {\r\n\r\n\t\t\toptions.tileSize = Math.floor(options.tileSize / 2);\r\n\t\t\toptions.zoomOffset++;\r\n\r\n\t\t\tif (options.minZoom > 0) {\r\n\t\t\t\toptions.minZoom--;\r\n\t\t\t}\r\n\t\t\tthis.options.maxZoom--;\r\n\t\t}\r\n\r\n\t\tif (options.bounds) {\r\n\t\t\toptions.bounds = L.latLngBounds(options.bounds);\r\n\t\t}\r\n\r\n\t\tthis._url = url;\r\n\r\n\t\tvar subdomains = this.options.subdomains;\r\n\r\n\t\tif (typeof subdomains === 'string') {\r\n\t\t\tthis.options.subdomains = subdomains.split('');\r\n\t\t}\r\n\t},\r\n\r\n\tonAdd: function (map) {\r\n\t\tthis._map = map;\r\n\t\tthis._animated = map._zoomAnimated;\r\n\r\n\t\t// create a container div for tiles\r\n\t\tthis._initContainer();\r\n\r\n\t\t// set up events\r\n\t\tmap.on({\r\n\t\t\t'viewreset': this._reset,\r\n\t\t\t'moveend': this._update\r\n\t\t}, this);\r\n\r\n\t\tif (this._animated) {\r\n\t\t\tmap.on({\r\n\t\t\t\t'zoomanim': this._animateZoom,\r\n\t\t\t\t'zoomend': this._endZoomAnim\r\n\t\t\t}, this);\r\n\t\t}\r\n\r\n\t\tif (!this.options.updateWhenIdle) {\r\n\t\t\tthis._limitedUpdate = L.Util.limitExecByInterval(this._update, 150, this);\r\n\t\t\tmap.on('move', this._limitedUpdate, this);\r\n\t\t}\r\n\r\n\t\tthis._reset();\r\n\t\tthis._update();\r\n\t},\r\n\r\n\taddTo: function (map) {\r\n\t\tmap.addLayer(this);\r\n\t\treturn this;\r\n\t},\r\n\r\n\tonRemove: function (map) {\r\n\t\tthis._container.parentNode.removeChild(this._container);\r\n\r\n\t\tmap.off({\r\n\t\t\t'viewreset': this._reset,\r\n\t\t\t'moveend': this._update\r\n\t\t}, this);\r\n\r\n\t\tif (this._animated) {\r\n\t\t\tmap.off({\r\n\t\t\t\t'zoomanim': this._animateZoom,\r\n\t\t\t\t'zoomend': this._endZoomAnim\r\n\t\t\t}, this);\r\n\t\t}\r\n\r\n\t\tif (!this.options.updateWhenIdle) {\r\n\t\t\tmap.off('move', this._limitedUpdate, this);\r\n\t\t}\r\n\r\n\t\tthis._container = null;\r\n\t\tthis._map = null;\r\n\t},\r\n\r\n\tbringToFront: function () {\r\n\t\tvar pane = this._map._panes.tilePane;\r\n\r\n\t\tif (this._container) {\r\n\t\t\tpane.appendChild(this._container);\r\n\t\t\tthis._setAutoZIndex(pane, Math.max);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tbringToBack: function () {\r\n\t\tvar pane = this._map._panes.tilePane;\r\n\r\n\t\tif (this._container) {\r\n\t\t\tpane.insertBefore(this._container, pane.firstChild);\r\n\t\t\tthis._setAutoZIndex(pane, Math.min);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tgetAttribution: function () {\r\n\t\treturn this.options.attribution;\r\n\t},\r\n\r\n\tgetContainer: function () {\r\n\t\treturn this._container;\r\n\t},\r\n\r\n\tsetOpacity: function (opacity) {\r\n\t\tthis.options.opacity = opacity;\r\n\r\n\t\tif (this._map) {\r\n\t\t\tthis._updateOpacity();\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetZIndex: function (zIndex) {\r\n\t\tthis.options.zIndex = zIndex;\r\n\t\tthis._updateZIndex();\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetUrl: function (url, noRedraw) {\r\n\t\tthis._url = url;\r\n\r\n\t\tif (!noRedraw) {\r\n\t\t\tthis.redraw();\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tredraw: function () {\r\n\t\tif (this._map) {\r\n\t\t\tthis._reset({hard: true});\r\n\t\t\tthis._update();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_updateZIndex: function () {\r\n\t\tif (this._container && this.options.zIndex !== undefined) {\r\n\t\t\tthis._container.style.zIndex = this.options.zIndex;\r\n\t\t}\r\n\t},\r\n\r\n\t_setAutoZIndex: function (pane, compare) {\r\n\r\n\t\tvar layers = pane.children,\r\n\t\t    edgeZIndex = -compare(Infinity, -Infinity), // -Infinity for max, Infinity for min\r\n\t\t    zIndex, i, len;\r\n\r\n\t\tfor (i = 0, len = layers.length; i < len; i++) {\r\n\r\n\t\t\tif (layers[i] !== this._container) {\r\n\t\t\t\tzIndex = parseInt(layers[i].style.zIndex, 10);\r\n\r\n\t\t\t\tif (!isNaN(zIndex)) {\r\n\t\t\t\t\tedgeZIndex = compare(edgeZIndex, zIndex);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.options.zIndex = this._container.style.zIndex =\r\n\t\t        (isFinite(edgeZIndex) ? edgeZIndex : 0) + compare(1, -1);\r\n\t},\r\n\r\n\t_updateOpacity: function () {\r\n\t\tvar i,\r\n\t\t    tiles = this._tiles;\r\n\r\n\t\tif (L.Browser.ielt9) {\r\n\t\t\tfor (i in tiles) {\r\n\t\t\t\tL.DomUtil.setOpacity(tiles[i], this.options.opacity);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tL.DomUtil.setOpacity(this._container, this.options.opacity);\r\n\t\t}\r\n\t},\r\n\r\n\t_initContainer: function () {\r\n\t\tvar tilePane = this._map._panes.tilePane;\r\n\r\n\t\tif (!this._container) {\r\n\t\t\tthis._container = L.DomUtil.create('div', 'leaflet-layer');\r\n\r\n\t\t\tthis._updateZIndex();\r\n\r\n\t\t\tif (this._animated) {\r\n\t\t\t\tvar className = 'leaflet-tile-container';\r\n\r\n\t\t\t\tthis._bgBuffer = L.DomUtil.create('div', className, this._container);\r\n\t\t\t\tthis._tileContainer = L.DomUtil.create('div', className, this._container);\r\n\r\n\t\t\t} else {\r\n\t\t\t\tthis._tileContainer = this._container;\r\n\t\t\t}\r\n\r\n\t\t\ttilePane.appendChild(this._container);\r\n\r\n\t\t\tif (this.options.opacity < 1) {\r\n\t\t\t\tthis._updateOpacity();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_reset: function (e) {\r\n\t\tfor (var key in this._tiles) {\r\n\t\t\tthis.fire('tileunload', {tile: this._tiles[key]});\r\n\t\t}\r\n\r\n\t\tthis._tiles = {};\r\n\t\tthis._tilesToLoad = 0;\r\n\r\n\t\tif (this.options.reuseTiles) {\r\n\t\t\tthis._unusedTiles = [];\r\n\t\t}\r\n\r\n\t\tthis._tileContainer.innerHTML = '';\r\n\r\n\t\tif (this._animated && e && e.hard) {\r\n\t\t\tthis._clearBgBuffer();\r\n\t\t}\r\n\r\n\t\tthis._initContainer();\r\n\t},\r\n\r\n\t_getTileSize: function () {\r\n\t\tvar map = this._map,\r\n\t\t    zoom = map.getZoom() + this.options.zoomOffset,\r\n\t\t    zoomN = this.options.maxNativeZoom,\r\n\t\t    tileSize = this.options.tileSize;\r\n\r\n\t\tif (zoomN && zoom > zoomN) {\r\n\t\t\ttileSize = Math.round(map.getZoomScale(zoom) / map.getZoomScale(zoomN) * tileSize);\r\n\t\t}\r\n\r\n\t\treturn tileSize;\r\n\t},\r\n\r\n\t_update: function () {\r\n\r\n\t\tif (!this._map) { return; }\r\n\r\n\t\tvar map = this._map,\r\n\t\t    bounds = map.getPixelBounds(),\r\n\t\t    zoom = map.getZoom(),\r\n\t\t    tileSize = this._getTileSize();\r\n\r\n\t\tif (zoom > this.options.maxZoom || zoom < this.options.minZoom) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar tileBounds = L.bounds(\r\n\t\t        bounds.min.divideBy(tileSize)._floor(),\r\n\t\t        bounds.max.divideBy(tileSize)._floor());\r\n\r\n\t\tthis._addTilesFromCenterOut(tileBounds);\r\n\r\n\t\tif (this.options.unloadInvisibleTiles || this.options.reuseTiles) {\r\n\t\t\tthis._removeOtherTiles(tileBounds);\r\n\t\t}\r\n\t},\r\n\r\n\t_addTilesFromCenterOut: function (bounds) {\r\n\t\tvar queue = [],\r\n\t\t    center = bounds.getCenter();\r\n\r\n\t\tvar j, i, point;\r\n\r\n\t\tfor (j = bounds.min.y; j <= bounds.max.y; j++) {\r\n\t\t\tfor (i = bounds.min.x; i <= bounds.max.x; i++) {\r\n\t\t\t\tpoint = new L.Point(i, j);\r\n\r\n\t\t\t\tif (this._tileShouldBeLoaded(point)) {\r\n\t\t\t\t\tqueue.push(point);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar tilesToLoad = queue.length;\r\n\r\n\t\tif (tilesToLoad === 0) { return; }\r\n\r\n\t\t// load tiles in order of their distance to center\r\n\t\tqueue.sort(function (a, b) {\r\n\t\t\treturn a.distanceTo(center) - b.distanceTo(center);\r\n\t\t});\r\n\r\n\t\tvar fragment = document.createDocumentFragment();\r\n\r\n\t\t// if its the first batch of tiles to load\r\n\t\tif (!this._tilesToLoad) {\r\n\t\t\tthis.fire('loading');\r\n\t\t}\r\n\r\n\t\tthis._tilesToLoad += tilesToLoad;\r\n\r\n\t\tfor (i = 0; i < tilesToLoad; i++) {\r\n\t\t\tthis._addTile(queue[i], fragment);\r\n\t\t}\r\n\r\n\t\tthis._tileContainer.appendChild(fragment);\r\n\t},\r\n\r\n\t_tileShouldBeLoaded: function (tilePoint) {\r\n\t\tif ((tilePoint.x + ':' + tilePoint.y) in this._tiles) {\r\n\t\t\treturn false; // already loaded\r\n\t\t}\r\n\r\n\t\tvar options = this.options;\r\n\r\n\t\tif (!options.continuousWorld) {\r\n\t\t\tvar limit = this._getWrapTileNum();\r\n\r\n\t\t\t// don't load if exceeds world bounds\r\n\t\t\tif ((options.noWrap && (tilePoint.x < 0 || tilePoint.x >= limit.x)) ||\r\n\t\t\t\ttilePoint.y < 0 || tilePoint.y >= limit.y) { return false; }\r\n\t\t}\r\n\r\n\t\tif (options.bounds) {\r\n\t\t\tvar tileSize = this._getTileSize(),\r\n\t\t\t    nwPoint = tilePoint.multiplyBy(tileSize),\r\n\t\t\t    sePoint = nwPoint.add([tileSize, tileSize]),\r\n\t\t\t    nw = this._map.unproject(nwPoint),\r\n\t\t\t    se = this._map.unproject(sePoint);\r\n\r\n\t\t\t// TODO temporary hack, will be removed after refactoring projections\r\n\t\t\t// https://github.com/Leaflet/Leaflet/issues/1618\r\n\t\t\tif (!options.continuousWorld && !options.noWrap) {\r\n\t\t\t\tnw = nw.wrap();\r\n\t\t\t\tse = se.wrap();\r\n\t\t\t}\r\n\r\n\t\t\tif (!options.bounds.intersects([nw, se])) { return false; }\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t},\r\n\r\n\t_removeOtherTiles: function (bounds) {\r\n\t\tvar kArr, x, y, key;\r\n\r\n\t\tfor (key in this._tiles) {\r\n\t\t\tkArr = key.split(':');\r\n\t\t\tx = parseInt(kArr[0], 10);\r\n\t\t\ty = parseInt(kArr[1], 10);\r\n\r\n\t\t\t// remove tile if it's out of bounds\r\n\t\t\tif (x < bounds.min.x || x > bounds.max.x || y < bounds.min.y || y > bounds.max.y) {\r\n\t\t\t\tthis._removeTile(key);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_removeTile: function (key) {\r\n\t\tvar tile = this._tiles[key];\r\n\r\n\t\tthis.fire('tileunload', {tile: tile, url: tile.src});\r\n\r\n\t\tif (this.options.reuseTiles) {\r\n\t\t\tL.DomUtil.removeClass(tile, 'leaflet-tile-loaded');\r\n\t\t\tthis._unusedTiles.push(tile);\r\n\r\n\t\t} else if (tile.parentNode === this._tileContainer) {\r\n\t\t\tthis._tileContainer.removeChild(tile);\r\n\t\t}\r\n\r\n\t\t// for https://github.com/CloudMade/Leaflet/issues/137\r\n\t\tif (!L.Browser.android) {\r\n\t\t\ttile.onload = null;\r\n\t\t\ttile.src = L.Util.emptyImageUrl;\r\n\t\t}\r\n\r\n\t\tdelete this._tiles[key];\r\n\t},\r\n\r\n\t_addTile: function (tilePoint, container) {\r\n\t\tvar tilePos = this._getTilePos(tilePoint);\r\n\r\n\t\t// get unused tile - or create a new tile\r\n\t\tvar tile = this._getTile();\r\n\r\n\t\t/*\r\n\t\tChrome 20 layouts much faster with top/left (verify with timeline, frames)\r\n\t\tAndroid 4 browser has display issues with top/left and requires transform instead\r\n\t\t(other browsers don't currently care) - see debug/hacks/jitter.html for an example\r\n\t\t*/\r\n\t\tL.DomUtil.setPosition(tile, tilePos, L.Browser.chrome);\r\n\r\n\t\tthis._tiles[tilePoint.x + ':' + tilePoint.y] = tile;\r\n\r\n\t\tthis._loadTile(tile, tilePoint);\r\n\r\n\t\tif (tile.parentNode !== this._tileContainer) {\r\n\t\t\tcontainer.appendChild(tile);\r\n\t\t}\r\n\t},\r\n\r\n\t_getZoomForUrl: function () {\r\n\r\n\t\tvar options = this.options,\r\n\t\t    zoom = this._map.getZoom();\r\n\r\n\t\tif (options.zoomReverse) {\r\n\t\t\tzoom = options.maxZoom - zoom;\r\n\t\t}\r\n\r\n\t\tzoom += options.zoomOffset;\r\n\r\n\t\treturn options.maxNativeZoom ? Math.min(zoom, options.maxNativeZoom) : zoom;\r\n\t},\r\n\r\n\t_getTilePos: function (tilePoint) {\r\n\t\tvar origin = this._map.getPixelOrigin(),\r\n\t\t    tileSize = this._getTileSize();\r\n\r\n\t\treturn tilePoint.multiplyBy(tileSize).subtract(origin);\r\n\t},\r\n\r\n\t// image-specific code (override to implement e.g. Canvas or SVG tile layer)\r\n\r\n\tgetTileUrl: function (tilePoint) {\r\n\t\treturn L.Util.template(this._url, L.extend({\r\n\t\t\ts: this._getSubdomain(tilePoint),\r\n\t\t\tz: tilePoint.z,\r\n\t\t\tx: tilePoint.x,\r\n\t\t\ty: tilePoint.y\r\n\t\t}, this.options));\r\n\t},\r\n\r\n\t_getWrapTileNum: function () {\r\n\t\tvar crs = this._map.options.crs,\r\n\t\t    size = crs.getSize(this._map.getZoom());\r\n\t\treturn size.divideBy(this._getTileSize())._floor();\r\n\t},\r\n\r\n\t_adjustTilePoint: function (tilePoint) {\r\n\r\n\t\tvar limit = this._getWrapTileNum();\r\n\r\n\t\t// wrap tile coordinates\r\n\t\tif (!this.options.continuousWorld && !this.options.noWrap) {\r\n\t\t\ttilePoint.x = ((tilePoint.x % limit.x) + limit.x) % limit.x;\r\n\t\t}\r\n\r\n\t\tif (this.options.tms) {\r\n\t\t\ttilePoint.y = limit.y - tilePoint.y - 1;\r\n\t\t}\r\n\r\n\t\ttilePoint.z = this._getZoomForUrl();\r\n\t},\r\n\r\n\t_getSubdomain: function (tilePoint) {\r\n\t\tvar index = Math.abs(tilePoint.x + tilePoint.y) % this.options.subdomains.length;\r\n\t\treturn this.options.subdomains[index];\r\n\t},\r\n\r\n\t_getTile: function () {\r\n\t\tif (this.options.reuseTiles && this._unusedTiles.length > 0) {\r\n\t\t\tvar tile = this._unusedTiles.pop();\r\n\t\t\tthis._resetTile(tile);\r\n\t\t\treturn tile;\r\n\t\t}\r\n\t\treturn this._createTile();\r\n\t},\r\n\r\n\t// Override if data stored on a tile needs to be cleaned up before reuse\r\n\t_resetTile: function (/*tile*/) {},\r\n\r\n\t_createTile: function () {\r\n\t\tvar tile = L.DomUtil.create('img', 'leaflet-tile');\r\n\t\ttile.style.width = tile.style.height = this._getTileSize() + 'px';\r\n\t\ttile.galleryimg = 'no';\r\n\r\n\t\ttile.onselectstart = tile.onmousemove = L.Util.falseFn;\r\n\r\n\t\tif (L.Browser.ielt9 && this.options.opacity !== undefined) {\r\n\t\t\tL.DomUtil.setOpacity(tile, this.options.opacity);\r\n\t\t}\r\n\t\t// without this hack, tiles disappear after zoom on Chrome for Android\r\n\t\t// https://github.com/Leaflet/Leaflet/issues/2078\r\n\t\tif (L.Browser.mobileWebkit3d) {\r\n\t\t\ttile.style.WebkitBackfaceVisibility = 'hidden';\r\n\t\t}\r\n\t\treturn tile;\r\n\t},\r\n\r\n\t_loadTile: function (tile, tilePoint) {\r\n\t\ttile._layer  = this;\r\n\t\ttile.onload  = this._tileOnLoad;\r\n\t\ttile.onerror = this._tileOnError;\r\n\r\n\t\tthis._adjustTilePoint(tilePoint);\r\n\t\ttile.src     = this.getTileUrl(tilePoint);\r\n\r\n\t\tthis.fire('tileloadstart', {\r\n\t\t\ttile: tile,\r\n\t\t\turl: tile.src\r\n\t\t});\r\n\t},\r\n\r\n\t_tileLoaded: function () {\r\n\t\tthis._tilesToLoad--;\r\n\r\n\t\tif (this._animated) {\r\n\t\t\tL.DomUtil.addClass(this._tileContainer, 'leaflet-zoom-animated');\r\n\t\t}\r\n\r\n\t\tif (!this._tilesToLoad) {\r\n\t\t\tthis.fire('load');\r\n\r\n\t\t\tif (this._animated) {\r\n\t\t\t\t// clear scaled tiles after all new tiles are loaded (for performance)\r\n\t\t\t\tclearTimeout(this._clearBgBufferTimer);\r\n\t\t\t\tthis._clearBgBufferTimer = setTimeout(L.bind(this._clearBgBuffer, this), 500);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_tileOnLoad: function () {\r\n\t\tvar layer = this._layer;\r\n\r\n\t\t//Only if we are loading an actual image\r\n\t\tif (this.src !== L.Util.emptyImageUrl) {\r\n\t\t\tL.DomUtil.addClass(this, 'leaflet-tile-loaded');\r\n\r\n\t\t\tlayer.fire('tileload', {\r\n\t\t\t\ttile: this,\r\n\t\t\t\turl: this.src\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tlayer._tileLoaded();\r\n\t},\r\n\r\n\t_tileOnError: function () {\r\n\t\tvar layer = this._layer;\r\n\r\n\t\tlayer.fire('tileerror', {\r\n\t\t\ttile: this,\r\n\t\t\turl: this.src\r\n\t\t});\r\n\r\n\t\tvar newUrl = layer.options.errorTileUrl;\r\n\t\tif (newUrl) {\r\n\t\t\tthis.src = newUrl;\r\n\t\t}\r\n\r\n\t\tlayer._tileLoaded();\r\n\t}\r\n});\r\n\r\nL.tileLayer = function (url, options) {\r\n\treturn new L.TileLayer(url, options);\r\n};\r\n\n\n/*\r\n * L.TileLayer.WMS is used for putting WMS tile layers on the map.\r\n */\r\n\r\nL.TileLayer.WMS = L.TileLayer.extend({\r\n\r\n\tdefaultWmsParams: {\r\n\t\tservice: 'WMS',\r\n\t\trequest: 'GetMap',\r\n\t\tversion: '1.1.1',\r\n\t\tlayers: '',\r\n\t\tstyles: '',\r\n\t\tformat: 'image/jpeg',\r\n\t\ttransparent: false\r\n\t},\r\n\r\n\tinitialize: function (url, options) { // (String, Object)\r\n\r\n\t\tthis._url = url;\r\n\r\n\t\tvar wmsParams = L.extend({}, this.defaultWmsParams),\r\n\t\t    tileSize = options.tileSize || this.options.tileSize;\r\n\r\n\t\tif (options.detectRetina && L.Browser.retina) {\r\n\t\t\twmsParams.width = wmsParams.height = tileSize * 2;\r\n\t\t} else {\r\n\t\t\twmsParams.width = wmsParams.height = tileSize;\r\n\t\t}\r\n\r\n\t\tfor (var i in options) {\r\n\t\t\t// all keys that are not TileLayer options go to WMS params\r\n\t\t\tif (!this.options.hasOwnProperty(i) && i !== 'crs') {\r\n\t\t\t\twmsParams[i] = options[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.wmsParams = wmsParams;\r\n\r\n\t\tL.setOptions(this, options);\r\n\t},\r\n\r\n\tonAdd: function (map) {\r\n\r\n\t\tthis._crs = this.options.crs || map.options.crs;\r\n\r\n\t\tthis._wmsVersion = parseFloat(this.wmsParams.version);\r\n\r\n\t\tvar projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';\r\n\t\tthis.wmsParams[projectionKey] = this._crs.code;\r\n\r\n\t\tL.TileLayer.prototype.onAdd.call(this, map);\r\n\t},\r\n\r\n\tgetTileUrl: function (tilePoint) { // (Point, Number) -> String\r\n\r\n\t\tvar map = this._map,\r\n\t\t    tileSize = this.options.tileSize,\r\n\r\n\t\t    nwPoint = tilePoint.multiplyBy(tileSize),\r\n\t\t    sePoint = nwPoint.add([tileSize, tileSize]),\r\n\r\n\t\t    nw = this._crs.project(map.unproject(nwPoint, tilePoint.z)),\r\n\t\t    se = this._crs.project(map.unproject(sePoint, tilePoint.z)),\r\n\t\t    bbox = this._wmsVersion >= 1.3 && this._crs === L.CRS.EPSG4326 ?\r\n\t\t        [se.y, nw.x, nw.y, se.x].join(',') :\r\n\t\t        [nw.x, se.y, se.x, nw.y].join(','),\r\n\r\n\t\t    url = L.Util.template(this._url, {s: this._getSubdomain(tilePoint)});\r\n\r\n\t\treturn url + L.Util.getParamString(this.wmsParams, url, true) + '&BBOX=' + bbox;\r\n\t},\r\n\r\n\tsetParams: function (params, noRedraw) {\r\n\r\n\t\tL.extend(this.wmsParams, params);\r\n\r\n\t\tif (!noRedraw) {\r\n\t\t\tthis.redraw();\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n});\r\n\r\nL.tileLayer.wms = function (url, options) {\r\n\treturn new L.TileLayer.WMS(url, options);\r\n};\r\n\n\n/*\r\n * L.TileLayer.Canvas is a class that you can use as a base for creating\r\n * dynamically drawn Canvas-based tile layers.\r\n */\r\n\r\nL.TileLayer.Canvas = L.TileLayer.extend({\r\n\toptions: {\r\n\t\tasync: false\r\n\t},\r\n\r\n\tinitialize: function (options) {\r\n\t\tL.setOptions(this, options);\r\n\t},\r\n\r\n\tredraw: function () {\r\n\t\tif (this._map) {\r\n\t\t\tthis._reset({hard: true});\r\n\t\t\tthis._update();\r\n\t\t}\r\n\r\n\t\tfor (var i in this._tiles) {\r\n\t\t\tthis._redrawTile(this._tiles[i]);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_redrawTile: function (tile) {\r\n\t\tthis.drawTile(tile, tile._tilePoint, this._map._zoom);\r\n\t},\r\n\r\n\t_createTile: function () {\r\n\t\tvar tile = L.DomUtil.create('canvas', 'leaflet-tile');\r\n\t\ttile.width = tile.height = this.options.tileSize;\r\n\t\ttile.onselectstart = tile.onmousemove = L.Util.falseFn;\r\n\t\treturn tile;\r\n\t},\r\n\r\n\t_loadTile: function (tile, tilePoint) {\r\n\t\ttile._layer = this;\r\n\t\ttile._tilePoint = tilePoint;\r\n\r\n\t\tthis._redrawTile(tile);\r\n\r\n\t\tif (!this.options.async) {\r\n\t\t\tthis.tileDrawn(tile);\r\n\t\t}\r\n\t},\r\n\r\n\tdrawTile: function (/*tile, tilePoint*/) {\r\n\t\t// override with rendering code\r\n\t},\r\n\r\n\ttileDrawn: function (tile) {\r\n\t\tthis._tileOnLoad.call(tile);\r\n\t}\r\n});\r\n\r\n\r\nL.tileLayer.canvas = function (options) {\r\n\treturn new L.TileLayer.Canvas(options);\r\n};\r\n\n\n/*\r\n * L.ImageOverlay is used to overlay images over the map (to specific geographical bounds).\r\n */\r\n\r\nL.ImageOverlay = L.Class.extend({\r\n\tincludes: L.Mixin.Events,\r\n\r\n\toptions: {\r\n\t\topacity: 1\r\n\t},\r\n\r\n\tinitialize: function (url, bounds, options) { // (String, LatLngBounds, Object)\r\n\t\tthis._url = url;\r\n\t\tthis._bounds = L.latLngBounds(bounds);\r\n\r\n\t\tL.setOptions(this, options);\r\n\t},\r\n\r\n\tonAdd: function (map) {\r\n\t\tthis._map = map;\r\n\r\n\t\tif (!this._image) {\r\n\t\t\tthis._initImage();\r\n\t\t}\r\n\r\n\t\tmap._panes.overlayPane.appendChild(this._image);\r\n\r\n\t\tmap.on('viewreset', this._reset, this);\r\n\r\n\t\tif (map.options.zoomAnimation && L.Browser.any3d) {\r\n\t\t\tmap.on('zoomanim', this._animateZoom, this);\r\n\t\t}\r\n\r\n\t\tthis._reset();\r\n\t},\r\n\r\n\tonRemove: function (map) {\r\n\t\tmap.getPanes().overlayPane.removeChild(this._image);\r\n\r\n\t\tmap.off('viewreset', this._reset, this);\r\n\r\n\t\tif (map.options.zoomAnimation) {\r\n\t\t\tmap.off('zoomanim', this._animateZoom, this);\r\n\t\t}\r\n\t},\r\n\r\n\taddTo: function (map) {\r\n\t\tmap.addLayer(this);\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetOpacity: function (opacity) {\r\n\t\tthis.options.opacity = opacity;\r\n\t\tthis._updateOpacity();\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// TODO remove bringToFront/bringToBack duplication from TileLayer/Path\r\n\tbringToFront: function () {\r\n\t\tif (this._image) {\r\n\t\t\tthis._map._panes.overlayPane.appendChild(this._image);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tbringToBack: function () {\r\n\t\tvar pane = this._map._panes.overlayPane;\r\n\t\tif (this._image) {\r\n\t\t\tpane.insertBefore(this._image, pane.firstChild);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetUrl: function (url) {\r\n\t\tthis._url = url;\r\n\t\tthis._image.src = this._url;\r\n\t},\r\n\r\n\tgetAttribution: function () {\r\n\t\treturn this.options.attribution;\r\n\t},\r\n\r\n\t_initImage: function () {\r\n\t\tthis._image = L.DomUtil.create('img', 'leaflet-image-layer');\r\n\r\n\t\tif (this._map.options.zoomAnimation && L.Browser.any3d) {\r\n\t\t\tL.DomUtil.addClass(this._image, 'leaflet-zoom-animated');\r\n\t\t} else {\r\n\t\t\tL.DomUtil.addClass(this._image, 'leaflet-zoom-hide');\r\n\t\t}\r\n\r\n\t\tthis._updateOpacity();\r\n\r\n\t\t//TODO createImage util method to remove duplication\r\n\t\tL.extend(this._image, {\r\n\t\t\tgalleryimg: 'no',\r\n\t\t\tonselectstart: L.Util.falseFn,\r\n\t\t\tonmousemove: L.Util.falseFn,\r\n\t\t\tonload: L.bind(this._onImageLoad, this),\r\n\t\t\tsrc: this._url\r\n\t\t});\r\n\t},\r\n\r\n\t_animateZoom: function (e) {\r\n\t\tvar map = this._map,\r\n\t\t    image = this._image,\r\n\t\t    scale = map.getZoomScale(e.zoom),\r\n\t\t    nw = this._bounds.getNorthWest(),\r\n\t\t    se = this._bounds.getSouthEast(),\r\n\r\n\t\t    topLeft = map._latLngToNewLayerPoint(nw, e.zoom, e.center),\r\n\t\t    size = map._latLngToNewLayerPoint(se, e.zoom, e.center)._subtract(topLeft),\r\n\t\t    origin = topLeft._add(size._multiplyBy((1 / 2) * (1 - 1 / scale)));\r\n\r\n\t\timage.style[L.DomUtil.TRANSFORM] =\r\n\t\t        L.DomUtil.getTranslateString(origin) + ' scale(' + scale + ') ';\r\n\t},\r\n\r\n\t_reset: function () {\r\n\t\tvar image   = this._image,\r\n\t\t    topLeft = this._map.latLngToLayerPoint(this._bounds.getNorthWest()),\r\n\t\t    size = this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(topLeft);\r\n\r\n\t\tL.DomUtil.setPosition(image, topLeft);\r\n\r\n\t\timage.style.width  = size.x + 'px';\r\n\t\timage.style.height = size.y + 'px';\r\n\t},\r\n\r\n\t_onImageLoad: function () {\r\n\t\tthis.fire('load');\r\n\t},\r\n\r\n\t_updateOpacity: function () {\r\n\t\tL.DomUtil.setOpacity(this._image, this.options.opacity);\r\n\t}\r\n});\r\n\r\nL.imageOverlay = function (url, bounds, options) {\r\n\treturn new L.ImageOverlay(url, bounds, options);\r\n};\r\n\n\n/*\r\n * L.Icon is an image-based icon class that you can use with L.Marker for custom markers.\r\n */\r\n\r\nL.Icon = L.Class.extend({\r\n\toptions: {\r\n\t\t/*\r\n\t\ticonUrl: (String) (required)\r\n\t\ticonRetinaUrl: (String) (optional, used for retina devices if detected)\r\n\t\ticonSize: (Point) (can be set through CSS)\r\n\t\ticonAnchor: (Point) (centered by default, can be set in CSS with negative margins)\r\n\t\tpopupAnchor: (Point) (if not specified, popup opens in the anchor point)\r\n\t\tshadowUrl: (String) (no shadow by default)\r\n\t\tshadowRetinaUrl: (String) (optional, used for retina devices if detected)\r\n\t\tshadowSize: (Point)\r\n\t\tshadowAnchor: (Point)\r\n\t\t*/\r\n\t\tclassName: ''\r\n\t},\r\n\r\n\tinitialize: function (options) {\r\n\t\tL.setOptions(this, options);\r\n\t},\r\n\r\n\tcreateIcon: function (oldIcon) {\r\n\t\treturn this._createIcon('icon', oldIcon);\r\n\t},\r\n\r\n\tcreateShadow: function (oldIcon) {\r\n\t\treturn this._createIcon('shadow', oldIcon);\r\n\t},\r\n\r\n\t_createIcon: function (name, oldIcon) {\r\n\t\tvar src = this._getIconUrl(name);\r\n\r\n\t\tif (!src) {\r\n\t\t\tif (name === 'icon') {\r\n\t\t\t\tthrow new Error('iconUrl not set in Icon options (see the docs).');\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tvar img;\r\n\t\tif (!oldIcon || oldIcon.tagName !== 'IMG') {\r\n\t\t\timg = this._createImg(src);\r\n\t\t} else {\r\n\t\t\timg = this._createImg(src, oldIcon);\r\n\t\t}\r\n\t\tthis._setIconStyles(img, name);\r\n\r\n\t\treturn img;\r\n\t},\r\n\r\n\t_setIconStyles: function (img, name) {\r\n\t\tvar options = this.options,\r\n\t\t    size = L.point(options[name + 'Size']),\r\n\t\t    anchor;\r\n\r\n\t\tif (name === 'shadow') {\r\n\t\t\tanchor = L.point(options.shadowAnchor || options.iconAnchor);\r\n\t\t} else {\r\n\t\t\tanchor = L.point(options.iconAnchor);\r\n\t\t}\r\n\r\n\t\tif (!anchor && size) {\r\n\t\t\tanchor = size.divideBy(2, true);\r\n\t\t}\r\n\r\n\t\timg.className = 'leaflet-marker-' + name + ' ' + options.className;\r\n\r\n\t\tif (anchor) {\r\n\t\t\timg.style.marginLeft = (-anchor.x) + 'px';\r\n\t\t\timg.style.marginTop  = (-anchor.y) + 'px';\r\n\t\t}\r\n\r\n\t\tif (size) {\r\n\t\t\timg.style.width  = size.x + 'px';\r\n\t\t\timg.style.height = size.y + 'px';\r\n\t\t}\r\n\t},\r\n\r\n\t_createImg: function (src, el) {\r\n\t\tel = el || document.createElement('img');\r\n\t\tel.src = src;\r\n\t\treturn el;\r\n\t},\r\n\r\n\t_getIconUrl: function (name) {\r\n\t\tif (L.Browser.retina && this.options[name + 'RetinaUrl']) {\r\n\t\t\treturn this.options[name + 'RetinaUrl'];\r\n\t\t}\r\n\t\treturn this.options[name + 'Url'];\r\n\t}\r\n});\r\n\r\nL.icon = function (options) {\r\n\treturn new L.Icon(options);\r\n};\r\n\n\n/*\n * L.Icon.Default is the blue marker icon used by default in Leaflet.\n */\n\nL.Icon.Default = L.Icon.extend({\n\n\toptions: {\n\t\ticonSize: [25, 41],\n\t\ticonAnchor: [12, 41],\n\t\tpopupAnchor: [1, -34],\n\n\t\tshadowSize: [41, 41]\n\t},\n\n\t_getIconUrl: function (name) {\n\t\tvar key = name + 'Url';\n\n\t\tif (this.options[key]) {\n\t\t\treturn this.options[key];\n\t\t}\n\n\t\tif (L.Browser.retina && name === 'icon') {\n\t\t\tname += '-2x';\n\t\t}\n\n\t\tvar path = L.Icon.Default.imagePath;\n\n\t\tif (!path) {\n\t\t\tthrow new Error('Couldn\\'t autodetect L.Icon.Default.imagePath, set it manually.');\n\t\t}\n\n\t\treturn path + '/marker-' + name + '.png';\n\t}\n});\n\nL.Icon.Default.imagePath = (function () {\n\tvar scripts = document.getElementsByTagName('script'),\n\t    leafletRe = /[\\/^]leaflet[\\-\\._]?([\\w\\-\\._]*)\\.js\\??/;\n\n\tvar i, len, src, matches, path;\n\n\tfor (i = 0, len = scripts.length; i < len; i++) {\n\t\tsrc = scripts[i].src;\n\t\tmatches = src.match(leafletRe);\n\n\t\tif (matches) {\n\t\t\tpath = src.split(leafletRe)[0];\n\t\t\treturn (path ? path + '/' : '') + 'images';\n\t\t}\n\t}\n}());\n\n\n/*\r\n * L.Marker is used to display clickable/draggable icons on the map.\r\n */\r\n\r\nL.Marker = L.Class.extend({\r\n\r\n\tincludes: L.Mixin.Events,\r\n\r\n\toptions: {\r\n\t\ticon: new L.Icon.Default(),\r\n\t\ttitle: '',\r\n\t\talt: '',\r\n\t\tclickable: true,\r\n\t\tdraggable: false,\r\n\t\tkeyboard: true,\r\n\t\tzIndexOffset: 0,\r\n\t\topacity: 1,\r\n\t\triseOnHover: false,\r\n\t\triseOffset: 250\r\n\t},\r\n\r\n\tinitialize: function (latlng, options) {\r\n\t\tL.setOptions(this, options);\r\n\t\tthis._latlng = L.latLng(latlng);\r\n\t},\r\n\r\n\tonAdd: function (map) {\r\n\t\tthis._map = map;\r\n\r\n\t\tmap.on('viewreset', this.update, this);\r\n\r\n\t\tthis._initIcon();\r\n\t\tthis.update();\r\n\t\tthis.fire('add');\r\n\r\n\t\tif (map.options.zoomAnimation && map.options.markerZoomAnimation) {\r\n\t\t\tmap.on('zoomanim', this._animateZoom, this);\r\n\t\t}\r\n\t},\r\n\r\n\taddTo: function (map) {\r\n\t\tmap.addLayer(this);\r\n\t\treturn this;\r\n\t},\r\n\r\n\tonRemove: function (map) {\r\n\t\tif (this.dragging) {\r\n\t\t\tthis.dragging.disable();\r\n\t\t}\r\n\r\n\t\tthis._removeIcon();\r\n\t\tthis._removeShadow();\r\n\r\n\t\tthis.fire('remove');\r\n\r\n\t\tmap.off({\r\n\t\t\t'viewreset': this.update,\r\n\t\t\t'zoomanim': this._animateZoom\r\n\t\t}, this);\r\n\r\n\t\tthis._map = null;\r\n\t},\r\n\r\n\tgetLatLng: function () {\r\n\t\treturn this._latlng;\r\n\t},\r\n\r\n\tsetLatLng: function (latlng) {\r\n\t\tthis._latlng = L.latLng(latlng);\r\n\r\n\t\tthis.update();\r\n\r\n\t\treturn this.fire('move', { latlng: this._latlng });\r\n\t},\r\n\r\n\tsetZIndexOffset: function (offset) {\r\n\t\tthis.options.zIndexOffset = offset;\r\n\t\tthis.update();\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetIcon: function (icon) {\r\n\r\n\t\tthis.options.icon = icon;\r\n\r\n\t\tif (this._map) {\r\n\t\t\tthis._initIcon();\r\n\t\t\tthis.update();\r\n\t\t}\r\n\r\n\t\tif (this._popup) {\r\n\t\t\tthis.bindPopup(this._popup);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tupdate: function () {\r\n\t\tif (this._icon) {\r\n\t\t\tthis._setPos(this._map.latLngToLayerPoint(this._latlng).round());\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_initIcon: function () {\r\n\t\tvar options = this.options,\r\n\t\t    map = this._map,\r\n\t\t    animation = (map.options.zoomAnimation && map.options.markerZoomAnimation),\r\n\t\t    classToAdd = animation ? 'leaflet-zoom-animated' : 'leaflet-zoom-hide';\r\n\r\n\t\tvar icon = options.icon.createIcon(this._icon),\r\n\t\t\taddIcon = false;\r\n\r\n\t\t// if we're not reusing the icon, remove the old one and init new one\r\n\t\tif (icon !== this._icon) {\r\n\t\t\tif (this._icon) {\r\n\t\t\t\tthis._removeIcon();\r\n\t\t\t}\r\n\t\t\taddIcon = true;\r\n\r\n\t\t\tif (options.title) {\r\n\t\t\t\ticon.title = options.title;\r\n\t\t\t}\r\n\r\n\t\t\tif (options.alt) {\r\n\t\t\t\ticon.alt = options.alt;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tL.DomUtil.addClass(icon, classToAdd);\r\n\r\n\t\tif (options.keyboard) {\r\n\t\t\ticon.tabIndex = '0';\r\n\t\t}\r\n\r\n\t\tthis._icon = icon;\r\n\r\n\t\tthis._initInteraction();\r\n\r\n\t\tif (options.riseOnHover) {\r\n\t\t\tL.DomEvent\r\n\t\t\t\t.on(icon, 'mouseover', this._bringToFront, this)\r\n\t\t\t\t.on(icon, 'mouseout', this._resetZIndex, this);\r\n\t\t}\r\n\r\n\t\tvar newShadow = options.icon.createShadow(this._shadow),\r\n\t\t\taddShadow = false;\r\n\r\n\t\tif (newShadow !== this._shadow) {\r\n\t\t\tthis._removeShadow();\r\n\t\t\taddShadow = true;\r\n\t\t}\r\n\r\n\t\tif (newShadow) {\r\n\t\t\tL.DomUtil.addClass(newShadow, classToAdd);\r\n\t\t}\r\n\t\tthis._shadow = newShadow;\r\n\r\n\r\n\t\tif (options.opacity < 1) {\r\n\t\t\tthis._updateOpacity();\r\n\t\t}\r\n\r\n\r\n\t\tvar panes = this._map._panes;\r\n\r\n\t\tif (addIcon) {\r\n\t\t\tpanes.markerPane.appendChild(this._icon);\r\n\t\t}\r\n\r\n\t\tif (newShadow && addShadow) {\r\n\t\t\tpanes.shadowPane.appendChild(this._shadow);\r\n\t\t}\r\n\t},\r\n\r\n\t_removeIcon: function () {\r\n\t\tif (this.options.riseOnHover) {\r\n\t\t\tL.DomEvent\r\n\t\t\t    .off(this._icon, 'mouseover', this._bringToFront)\r\n\t\t\t    .off(this._icon, 'mouseout', this._resetZIndex);\r\n\t\t}\r\n\r\n\t\tthis._map._panes.markerPane.removeChild(this._icon);\r\n\r\n\t\tthis._icon = null;\r\n\t},\r\n\r\n\t_removeShadow: function () {\r\n\t\tif (this._shadow) {\r\n\t\t\tthis._map._panes.shadowPane.removeChild(this._shadow);\r\n\t\t}\r\n\t\tthis._shadow = null;\r\n\t},\r\n\r\n\t_setPos: function (pos) {\r\n\t\tL.DomUtil.setPosition(this._icon, pos);\r\n\r\n\t\tif (this._shadow) {\r\n\t\t\tL.DomUtil.setPosition(this._shadow, pos);\r\n\t\t}\r\n\r\n\t\tthis._zIndex = pos.y + this.options.zIndexOffset;\r\n\r\n\t\tthis._resetZIndex();\r\n\t},\r\n\r\n\t_updateZIndex: function (offset) {\r\n\t\tthis._icon.style.zIndex = this._zIndex + offset;\r\n\t},\r\n\r\n\t_animateZoom: function (opt) {\r\n\t\tvar pos = this._map._latLngToNewLayerPoint(this._latlng, opt.zoom, opt.center).round();\r\n\r\n\t\tthis._setPos(pos);\r\n\t},\r\n\r\n\t_initInteraction: function () {\r\n\r\n\t\tif (!this.options.clickable) { return; }\r\n\r\n\t\t// TODO refactor into something shared with Map/Path/etc. to DRY it up\r\n\r\n\t\tvar icon = this._icon,\r\n\t\t    events = ['dblclick', 'mousedown', 'mouseover', 'mouseout', 'contextmenu'];\r\n\r\n\t\tL.DomUtil.addClass(icon, 'leaflet-clickable');\r\n\t\tL.DomEvent.on(icon, 'click', this._onMouseClick, this);\r\n\t\tL.DomEvent.on(icon, 'keypress', this._onKeyPress, this);\r\n\r\n\t\tfor (var i = 0; i < events.length; i++) {\r\n\t\t\tL.DomEvent.on(icon, events[i], this._fireMouseEvent, this);\r\n\t\t}\r\n\r\n\t\tif (L.Handler.MarkerDrag) {\r\n\t\t\tthis.dragging = new L.Handler.MarkerDrag(this);\r\n\r\n\t\t\tif (this.options.draggable) {\r\n\t\t\t\tthis.dragging.enable();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_onMouseClick: function (e) {\r\n\t\tvar wasDragged = this.dragging && this.dragging.moved();\r\n\r\n\t\tif (this.hasEventListeners(e.type) || wasDragged) {\r\n\t\t\tL.DomEvent.stopPropagation(e);\r\n\t\t}\r\n\r\n\t\tif (wasDragged) { return; }\r\n\r\n\t\tif ((!this.dragging || !this.dragging._enabled) && this._map.dragging && this._map.dragging.moved()) { return; }\r\n\r\n\t\tthis.fire(e.type, {\r\n\t\t\toriginalEvent: e,\r\n\t\t\tlatlng: this._latlng\r\n\t\t});\r\n\t},\r\n\r\n\t_onKeyPress: function (e) {\r\n\t\tif (e.keyCode === 13) {\r\n\t\t\tthis.fire('click', {\r\n\t\t\t\toriginalEvent: e,\r\n\t\t\t\tlatlng: this._latlng\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\t_fireMouseEvent: function (e) {\r\n\r\n\t\tthis.fire(e.type, {\r\n\t\t\toriginalEvent: e,\r\n\t\t\tlatlng: this._latlng\r\n\t\t});\r\n\r\n\t\t// TODO proper custom event propagation\r\n\t\t// this line will always be called if marker is in a FeatureGroup\r\n\t\tif (e.type === 'contextmenu' && this.hasEventListeners(e.type)) {\r\n\t\t\tL.DomEvent.preventDefault(e);\r\n\t\t}\r\n\t\tif (e.type !== 'mousedown') {\r\n\t\t\tL.DomEvent.stopPropagation(e);\r\n\t\t} else {\r\n\t\t\tL.DomEvent.preventDefault(e);\r\n\t\t}\r\n\t},\r\n\r\n\tsetOpacity: function (opacity) {\r\n\t\tthis.options.opacity = opacity;\r\n\t\tif (this._map) {\r\n\t\t\tthis._updateOpacity();\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_updateOpacity: function () {\r\n\t\tL.DomUtil.setOpacity(this._icon, this.options.opacity);\r\n\t\tif (this._shadow) {\r\n\t\t\tL.DomUtil.setOpacity(this._shadow, this.options.opacity);\r\n\t\t}\r\n\t},\r\n\r\n\t_bringToFront: function () {\r\n\t\tthis._updateZIndex(this.options.riseOffset);\r\n\t},\r\n\r\n\t_resetZIndex: function () {\r\n\t\tthis._updateZIndex(0);\r\n\t}\r\n});\r\n\r\nL.marker = function (latlng, options) {\r\n\treturn new L.Marker(latlng, options);\r\n};\r\n\n\n/*\n * L.DivIcon is a lightweight HTML-based icon class (as opposed to the image-based L.Icon)\n * to use with L.Marker.\n */\n\nL.DivIcon = L.Icon.extend({\n\toptions: {\n\t\ticonSize: [12, 12], // also can be set through CSS\n\t\t/*\n\t\ticonAnchor: (Point)\n\t\tpopupAnchor: (Point)\n\t\thtml: (String)\n\t\tbgPos: (Point)\n\t\t*/\n\t\tclassName: 'leaflet-div-icon',\n\t\thtml: false\n\t},\n\n\tcreateIcon: function (oldIcon) {\n\t\tvar div = (oldIcon && oldIcon.tagName === 'DIV') ? oldIcon : document.createElement('div'),\n\t\t    options = this.options;\n\n\t\tif (options.html !== false) {\n\t\t\tdiv.innerHTML = options.html;\n\t\t} else {\n\t\t\tdiv.innerHTML = '';\n\t\t}\n\n\t\tif (options.bgPos) {\n\t\t\tdiv.style.backgroundPosition =\n\t\t\t        (-options.bgPos.x) + 'px ' + (-options.bgPos.y) + 'px';\n\t\t}\n\n\t\tthis._setIconStyles(div, 'icon');\n\t\treturn div;\n\t},\n\n\tcreateShadow: function () {\n\t\treturn null;\n\t}\n});\n\nL.divIcon = function (options) {\n\treturn new L.DivIcon(options);\n};\n\n\n/*\r\n * L.Popup is used for displaying popups on the map.\r\n */\r\n\r\nL.Map.mergeOptions({\r\n\tclosePopupOnClick: true\r\n});\r\n\r\nL.Popup = L.Class.extend({\r\n\tincludes: L.Mixin.Events,\r\n\r\n\toptions: {\r\n\t\tminWidth: 50,\r\n\t\tmaxWidth: 300,\r\n\t\t// maxHeight: null,\r\n\t\tautoPan: true,\r\n\t\tcloseButton: true,\r\n\t\toffset: [0, 7],\r\n\t\tautoPanPadding: [5, 5],\r\n\t\t// autoPanPaddingTopLeft: null,\r\n\t\t// autoPanPaddingBottomRight: null,\r\n\t\tkeepInView: false,\r\n\t\tclassName: '',\r\n\t\tzoomAnimation: true\r\n\t},\r\n\r\n\tinitialize: function (options, source) {\r\n\t\tL.setOptions(this, options);\r\n\r\n\t\tthis._source = source;\r\n\t\tthis._animated = L.Browser.any3d && this.options.zoomAnimation;\r\n\t\tthis._isOpen = false;\r\n\t},\r\n\r\n\tonAdd: function (map) {\r\n\t\tthis._map = map;\r\n\r\n\t\tif (!this._container) {\r\n\t\t\tthis._initLayout();\r\n\t\t}\r\n\r\n\t\tvar animFade = map.options.fadeAnimation;\r\n\r\n\t\tif (animFade) {\r\n\t\t\tL.DomUtil.setOpacity(this._container, 0);\r\n\t\t}\r\n\t\tmap._panes.popupPane.appendChild(this._container);\r\n\r\n\t\tmap.on(this._getEvents(), this);\r\n\r\n\t\tthis.update();\r\n\r\n\t\tif (animFade) {\r\n\t\t\tL.DomUtil.setOpacity(this._container, 1);\r\n\t\t}\r\n\r\n\t\tthis.fire('open');\r\n\r\n\t\tmap.fire('popupopen', {popup: this});\r\n\r\n\t\tif (this._source) {\r\n\t\t\tthis._source.fire('popupopen', {popup: this});\r\n\t\t}\r\n\t},\r\n\r\n\taddTo: function (map) {\r\n\t\tmap.addLayer(this);\r\n\t\treturn this;\r\n\t},\r\n\r\n\topenOn: function (map) {\r\n\t\tmap.openPopup(this);\r\n\t\treturn this;\r\n\t},\r\n\r\n\tonRemove: function (map) {\r\n\t\tmap._panes.popupPane.removeChild(this._container);\r\n\r\n\t\tL.Util.falseFn(this._container.offsetWidth); // force reflow\r\n\r\n\t\tmap.off(this._getEvents(), this);\r\n\r\n\t\tif (map.options.fadeAnimation) {\r\n\t\t\tL.DomUtil.setOpacity(this._container, 0);\r\n\t\t}\r\n\r\n\t\tthis._map = null;\r\n\r\n\t\tthis.fire('close');\r\n\r\n\t\tmap.fire('popupclose', {popup: this});\r\n\r\n\t\tif (this._source) {\r\n\t\t\tthis._source.fire('popupclose', {popup: this});\r\n\t\t}\r\n\t},\r\n\r\n\tgetLatLng: function () {\r\n\t\treturn this._latlng;\r\n\t},\r\n\r\n\tsetLatLng: function (latlng) {\r\n\t\tthis._latlng = L.latLng(latlng);\r\n\t\tif (this._map) {\r\n\t\t\tthis._updatePosition();\r\n\t\t\tthis._adjustPan();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tgetContent: function () {\r\n\t\treturn this._content;\r\n\t},\r\n\r\n\tsetContent: function (content) {\r\n\t\tthis._content = content;\r\n\t\tthis.update();\r\n\t\treturn this;\r\n\t},\r\n\r\n\tupdate: function () {\r\n\t\tif (!this._map) { return; }\r\n\r\n\t\tthis._container.style.visibility = 'hidden';\r\n\r\n\t\tthis._updateContent();\r\n\t\tthis._updateLayout();\r\n\t\tthis._updatePosition();\r\n\r\n\t\tthis._container.style.visibility = '';\r\n\r\n\t\tthis._adjustPan();\r\n\t},\r\n\r\n\t_getEvents: function () {\r\n\t\tvar events = {\r\n\t\t\tviewreset: this._updatePosition\r\n\t\t};\r\n\r\n\t\tif (this._animated) {\r\n\t\t\tevents.zoomanim = this._zoomAnimation;\r\n\t\t}\r\n\t\tif ('closeOnClick' in this.options ? this.options.closeOnClick : this._map.options.closePopupOnClick) {\r\n\t\t\tevents.preclick = this._close;\r\n\t\t}\r\n\t\tif (this.options.keepInView) {\r\n\t\t\tevents.moveend = this._adjustPan;\r\n\t\t}\r\n\r\n\t\treturn events;\r\n\t},\r\n\r\n\t_close: function () {\r\n\t\tif (this._map) {\r\n\t\t\tthis._map.closePopup(this);\r\n\t\t}\r\n\t},\r\n\r\n\t_initLayout: function () {\r\n\t\tvar prefix = 'leaflet-popup',\r\n\t\t\tcontainerClass = prefix + ' ' + this.options.className + ' leaflet-zoom-' +\r\n\t\t\t        (this._animated ? 'animated' : 'hide'),\r\n\t\t\tcontainer = this._container = L.DomUtil.create('div', containerClass),\r\n\t\t\tcloseButton;\r\n\r\n\t\tif (this.options.closeButton) {\r\n\t\t\tcloseButton = this._closeButton =\r\n\t\t\t        L.DomUtil.create('a', prefix + '-close-button', container);\r\n\t\t\tcloseButton.href = '#close';\r\n\t\t\tcloseButton.innerHTML = '&#215;';\r\n\t\t\tL.DomEvent.disableClickPropagation(closeButton);\r\n\r\n\t\t\tL.DomEvent.on(closeButton, 'click', this._onCloseButtonClick, this);\r\n\t\t}\r\n\r\n\t\tvar wrapper = this._wrapper =\r\n\t\t        L.DomUtil.create('div', prefix + '-content-wrapper', container);\r\n\t\tL.DomEvent.disableClickPropagation(wrapper);\r\n\r\n\t\tthis._contentNode = L.DomUtil.create('div', prefix + '-content', wrapper);\r\n\r\n\t\tL.DomEvent.disableScrollPropagation(this._contentNode);\r\n\t\tL.DomEvent.on(wrapper, 'contextmenu', L.DomEvent.stopPropagation);\r\n\r\n\t\tthis._tipContainer = L.DomUtil.create('div', prefix + '-tip-container', container);\r\n\t\tthis._tip = L.DomUtil.create('div', prefix + '-tip', this._tipContainer);\r\n\t},\r\n\r\n\t_updateContent: function () {\r\n\t\tif (!this._content) { return; }\r\n\r\n\t\tif (typeof this._content === 'string') {\r\n\t\t\tthis._contentNode.innerHTML = this._content;\r\n\t\t} else {\r\n\t\t\twhile (this._contentNode.hasChildNodes()) {\r\n\t\t\t\tthis._contentNode.removeChild(this._contentNode.firstChild);\r\n\t\t\t}\r\n\t\t\tthis._contentNode.appendChild(this._content);\r\n\t\t}\r\n\t\tthis.fire('contentupdate');\r\n\t},\r\n\r\n\t_updateLayout: function () {\r\n\t\tvar container = this._contentNode,\r\n\t\t    style = container.style;\r\n\r\n\t\tstyle.width = '';\r\n\t\tstyle.whiteSpace = 'nowrap';\r\n\r\n\t\tvar width = container.offsetWidth;\r\n\t\twidth = Math.min(width, this.options.maxWidth);\r\n\t\twidth = Math.max(width, this.options.minWidth);\r\n\r\n\t\tstyle.width = (width + 1) + 'px';\r\n\t\tstyle.whiteSpace = '';\r\n\r\n\t\tstyle.height = '';\r\n\r\n\t\tvar height = container.offsetHeight,\r\n\t\t    maxHeight = this.options.maxHeight,\r\n\t\t    scrolledClass = 'leaflet-popup-scrolled';\r\n\r\n\t\tif (maxHeight && height > maxHeight) {\r\n\t\t\tstyle.height = maxHeight + 'px';\r\n\t\t\tL.DomUtil.addClass(container, scrolledClass);\r\n\t\t} else {\r\n\t\t\tL.DomUtil.removeClass(container, scrolledClass);\r\n\t\t}\r\n\r\n\t\tthis._containerWidth = this._container.offsetWidth;\r\n\t},\r\n\r\n\t_updatePosition: function () {\r\n\t\tif (!this._map) { return; }\r\n\r\n\t\tvar pos = this._map.latLngToLayerPoint(this._latlng),\r\n\t\t    animated = this._animated,\r\n\t\t    offset = L.point(this.options.offset);\r\n\r\n\t\tif (animated) {\r\n\t\t\tL.DomUtil.setPosition(this._container, pos);\r\n\t\t}\r\n\r\n\t\tthis._containerBottom = -offset.y - (animated ? 0 : pos.y);\r\n\t\tthis._containerLeft = -Math.round(this._containerWidth / 2) + offset.x + (animated ? 0 : pos.x);\r\n\r\n\t\t// bottom position the popup in case the height of the popup changes (images loading etc)\r\n\t\tthis._container.style.bottom = this._containerBottom + 'px';\r\n\t\tthis._container.style.left = this._containerLeft + 'px';\r\n\t},\r\n\r\n\t_zoomAnimation: function (opt) {\r\n\t\tvar pos = this._map._latLngToNewLayerPoint(this._latlng, opt.zoom, opt.center);\r\n\r\n\t\tL.DomUtil.setPosition(this._container, pos);\r\n\t},\r\n\r\n\t_adjustPan: function () {\r\n\t\tif (!this.options.autoPan) { return; }\r\n\r\n\t\tvar map = this._map,\r\n\t\t    containerHeight = this._container.offsetHeight,\r\n\t\t    containerWidth = this._containerWidth,\r\n\r\n\t\t    layerPos = new L.Point(this._containerLeft, -containerHeight - this._containerBottom);\r\n\r\n\t\tif (this._animated) {\r\n\t\t\tlayerPos._add(L.DomUtil.getPosition(this._container));\r\n\t\t}\r\n\r\n\t\tvar containerPos = map.layerPointToContainerPoint(layerPos),\r\n\t\t    padding = L.point(this.options.autoPanPadding),\r\n\t\t    paddingTL = L.point(this.options.autoPanPaddingTopLeft || padding),\r\n\t\t    paddingBR = L.point(this.options.autoPanPaddingBottomRight || padding),\r\n\t\t    size = map.getSize(),\r\n\t\t    dx = 0,\r\n\t\t    dy = 0;\r\n\r\n\t\tif (containerPos.x + containerWidth + paddingBR.x > size.x) { // right\r\n\t\t\tdx = containerPos.x + containerWidth - size.x + paddingBR.x;\r\n\t\t}\r\n\t\tif (containerPos.x - dx - paddingTL.x < 0) { // left\r\n\t\t\tdx = containerPos.x - paddingTL.x;\r\n\t\t}\r\n\t\tif (containerPos.y + containerHeight + paddingBR.y > size.y) { // bottom\r\n\t\t\tdy = containerPos.y + containerHeight - size.y + paddingBR.y;\r\n\t\t}\r\n\t\tif (containerPos.y - dy - paddingTL.y < 0) { // top\r\n\t\t\tdy = containerPos.y - paddingTL.y;\r\n\t\t}\r\n\r\n\t\tif (dx || dy) {\r\n\t\t\tmap\r\n\t\t\t    .fire('autopanstart')\r\n\t\t\t    .panBy([dx, dy]);\r\n\t\t}\r\n\t},\r\n\r\n\t_onCloseButtonClick: function (e) {\r\n\t\tthis._close();\r\n\t\tL.DomEvent.stop(e);\r\n\t}\r\n});\r\n\r\nL.popup = function (options, source) {\r\n\treturn new L.Popup(options, source);\r\n};\r\n\r\n\r\nL.Map.include({\r\n\topenPopup: function (popup, latlng, options) { // (Popup) or (String || HTMLElement, LatLng[, Object])\r\n\t\tthis.closePopup();\r\n\r\n\t\tif (!(popup instanceof L.Popup)) {\r\n\t\t\tvar content = popup;\r\n\r\n\t\t\tpopup = new L.Popup(options)\r\n\t\t\t    .setLatLng(latlng)\r\n\t\t\t    .setContent(content);\r\n\t\t}\r\n\t\tpopup._isOpen = true;\r\n\r\n\t\tthis._popup = popup;\r\n\t\treturn this.addLayer(popup);\r\n\t},\r\n\r\n\tclosePopup: function (popup) {\r\n\t\tif (!popup || popup === this._popup) {\r\n\t\t\tpopup = this._popup;\r\n\t\t\tthis._popup = null;\r\n\t\t}\r\n\t\tif (popup) {\r\n\t\t\tthis.removeLayer(popup);\r\n\t\t\tpopup._isOpen = false;\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n});\r\n\n\n/*\r\n * Popup extension to L.Marker, adding popup-related methods.\r\n */\r\n\r\nL.Marker.include({\r\n\topenPopup: function () {\r\n\t\tif (this._popup && this._map && !this._map.hasLayer(this._popup)) {\r\n\t\t\tthis._popup.setLatLng(this._latlng);\r\n\t\t\tthis._map.openPopup(this._popup);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tclosePopup: function () {\r\n\t\tif (this._popup) {\r\n\t\t\tthis._popup._close();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\ttogglePopup: function () {\r\n\t\tif (this._popup) {\r\n\t\t\tif (this._popup._isOpen) {\r\n\t\t\t\tthis.closePopup();\r\n\t\t\t} else {\r\n\t\t\t\tthis.openPopup();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tbindPopup: function (content, options) {\r\n\t\tvar anchor = L.point(this.options.icon.options.popupAnchor || [0, 0]);\r\n\r\n\t\tanchor = anchor.add(L.Popup.prototype.options.offset);\r\n\r\n\t\tif (options && options.offset) {\r\n\t\t\tanchor = anchor.add(options.offset);\r\n\t\t}\r\n\r\n\t\toptions = L.extend({offset: anchor}, options);\r\n\r\n\t\tif (!this._popupHandlersAdded) {\r\n\t\t\tthis\r\n\t\t\t    .on('click', this.togglePopup, this)\r\n\t\t\t    .on('remove', this.closePopup, this)\r\n\t\t\t    .on('move', this._movePopup, this);\r\n\t\t\tthis._popupHandlersAdded = true;\r\n\t\t}\r\n\r\n\t\tif (content instanceof L.Popup) {\r\n\t\t\tL.setOptions(content, options);\r\n\t\t\tthis._popup = content;\r\n\t\t\tcontent._source = this;\r\n\t\t} else {\r\n\t\t\tthis._popup = new L.Popup(options, this)\r\n\t\t\t\t.setContent(content);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetPopupContent: function (content) {\r\n\t\tif (this._popup) {\r\n\t\t\tthis._popup.setContent(content);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tunbindPopup: function () {\r\n\t\tif (this._popup) {\r\n\t\t\tthis._popup = null;\r\n\t\t\tthis\r\n\t\t\t    .off('click', this.togglePopup, this)\r\n\t\t\t    .off('remove', this.closePopup, this)\r\n\t\t\t    .off('move', this._movePopup, this);\r\n\t\t\tthis._popupHandlersAdded = false;\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tgetPopup: function () {\r\n\t\treturn this._popup;\r\n\t},\r\n\r\n\t_movePopup: function (e) {\r\n\t\tthis._popup.setLatLng(e.latlng);\r\n\t}\r\n});\r\n\n\n/*\r\n * L.LayerGroup is a class to combine several layers into one so that\r\n * you can manipulate the group (e.g. add/remove it) as one layer.\r\n */\r\n\r\nL.LayerGroup = L.Class.extend({\r\n\tinitialize: function (layers) {\r\n\t\tthis._layers = {};\r\n\r\n\t\tvar i, len;\r\n\r\n\t\tif (layers) {\r\n\t\t\tfor (i = 0, len = layers.length; i < len; i++) {\r\n\t\t\t\tthis.addLayer(layers[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\taddLayer: function (layer) {\r\n\t\tvar id = this.getLayerId(layer);\r\n\r\n\t\tthis._layers[id] = layer;\r\n\r\n\t\tif (this._map) {\r\n\t\t\tthis._map.addLayer(layer);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tremoveLayer: function (layer) {\r\n\t\tvar id = layer in this._layers ? layer : this.getLayerId(layer);\r\n\r\n\t\tif (this._map && this._layers[id]) {\r\n\t\t\tthis._map.removeLayer(this._layers[id]);\r\n\t\t}\r\n\r\n\t\tdelete this._layers[id];\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\thasLayer: function (layer) {\r\n\t\tif (!layer) { return false; }\r\n\r\n\t\treturn (layer in this._layers || this.getLayerId(layer) in this._layers);\r\n\t},\r\n\r\n\tclearLayers: function () {\r\n\t\tthis.eachLayer(this.removeLayer, this);\r\n\t\treturn this;\r\n\t},\r\n\r\n\tinvoke: function (methodName) {\r\n\t\tvar args = Array.prototype.slice.call(arguments, 1),\r\n\t\t    i, layer;\r\n\r\n\t\tfor (i in this._layers) {\r\n\t\t\tlayer = this._layers[i];\r\n\r\n\t\t\tif (layer[methodName]) {\r\n\t\t\t\tlayer[methodName].apply(layer, args);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tonAdd: function (map) {\r\n\t\tthis._map = map;\r\n\t\tthis.eachLayer(map.addLayer, map);\r\n\t},\r\n\r\n\tonRemove: function (map) {\r\n\t\tthis.eachLayer(map.removeLayer, map);\r\n\t\tthis._map = null;\r\n\t},\r\n\r\n\taddTo: function (map) {\r\n\t\tmap.addLayer(this);\r\n\t\treturn this;\r\n\t},\r\n\r\n\teachLayer: function (method, context) {\r\n\t\tfor (var i in this._layers) {\r\n\t\t\tmethod.call(context, this._layers[i]);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tgetLayer: function (id) {\r\n\t\treturn this._layers[id];\r\n\t},\r\n\r\n\tgetLayers: function () {\r\n\t\tvar layers = [];\r\n\r\n\t\tfor (var i in this._layers) {\r\n\t\t\tlayers.push(this._layers[i]);\r\n\t\t}\r\n\t\treturn layers;\r\n\t},\r\n\r\n\tsetZIndex: function (zIndex) {\r\n\t\treturn this.invoke('setZIndex', zIndex);\r\n\t},\r\n\r\n\tgetLayerId: function (layer) {\r\n\t\treturn L.stamp(layer);\r\n\t}\r\n});\r\n\r\nL.layerGroup = function (layers) {\r\n\treturn new L.LayerGroup(layers);\r\n};\r\n\n\n/*\r\n * L.FeatureGroup extends L.LayerGroup by introducing mouse events and additional methods\r\n * shared between a group of interactive layers (like vectors or markers).\r\n */\r\n\r\nL.FeatureGroup = L.LayerGroup.extend({\r\n\tincludes: L.Mixin.Events,\r\n\r\n\tstatics: {\r\n\t\tEVENTS: 'click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose'\r\n\t},\r\n\r\n\taddLayer: function (layer) {\r\n\t\tif (this.hasLayer(layer)) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tif ('on' in layer) {\r\n\t\t\tlayer.on(L.FeatureGroup.EVENTS, this._propagateEvent, this);\r\n\t\t}\r\n\r\n\t\tL.LayerGroup.prototype.addLayer.call(this, layer);\r\n\r\n\t\tif (this._popupContent && layer.bindPopup) {\r\n\t\t\tlayer.bindPopup(this._popupContent, this._popupOptions);\r\n\t\t}\r\n\r\n\t\treturn this.fire('layeradd', {layer: layer});\r\n\t},\r\n\r\n\tremoveLayer: function (layer) {\r\n\t\tif (!this.hasLayer(layer)) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tif (layer in this._layers) {\r\n\t\t\tlayer = this._layers[layer];\r\n\t\t}\r\n\r\n\t\tif ('off' in layer) {\r\n\t\t\tlayer.off(L.FeatureGroup.EVENTS, this._propagateEvent, this);\r\n\t\t}\r\n\r\n\t\tL.LayerGroup.prototype.removeLayer.call(this, layer);\r\n\r\n\t\tif (this._popupContent) {\r\n\t\t\tthis.invoke('unbindPopup');\r\n\t\t}\r\n\r\n\t\treturn this.fire('layerremove', {layer: layer});\r\n\t},\r\n\r\n\tbindPopup: function (content, options) {\r\n\t\tthis._popupContent = content;\r\n\t\tthis._popupOptions = options;\r\n\t\treturn this.invoke('bindPopup', content, options);\r\n\t},\r\n\r\n\topenPopup: function (latlng) {\r\n\t\t// open popup on the first layer\r\n\t\tfor (var id in this._layers) {\r\n\t\t\tthis._layers[id].openPopup(latlng);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetStyle: function (style) {\r\n\t\treturn this.invoke('setStyle', style);\r\n\t},\r\n\r\n\tbringToFront: function () {\r\n\t\treturn this.invoke('bringToFront');\r\n\t},\r\n\r\n\tbringToBack: function () {\r\n\t\treturn this.invoke('bringToBack');\r\n\t},\r\n\r\n\tgetBounds: function () {\r\n\t\tvar bounds = new L.LatLngBounds();\r\n\r\n\t\tthis.eachLayer(function (layer) {\r\n\t\t\tbounds.extend(layer instanceof L.Marker ? layer.getLatLng() : layer.getBounds());\r\n\t\t});\r\n\r\n\t\treturn bounds;\r\n\t},\r\n\r\n\t_propagateEvent: function (e) {\r\n\t\te = L.extend({\r\n\t\t\tlayer: e.target,\r\n\t\t\ttarget: this\r\n\t\t}, e);\r\n\t\tthis.fire(e.type, e);\r\n\t}\r\n});\r\n\r\nL.featureGroup = function (layers) {\r\n\treturn new L.FeatureGroup(layers);\r\n};\r\n\n\n/*\r\n * L.Path is a base class for rendering vector paths on a map. Inherited by Polyline, Circle, etc.\r\n */\r\n\r\nL.Path = L.Class.extend({\r\n\tincludes: [L.Mixin.Events],\r\n\r\n\tstatics: {\r\n\t\t// how much to extend the clip area around the map view\r\n\t\t// (relative to its size, e.g. 0.5 is half the screen in each direction)\r\n\t\t// set it so that SVG element doesn't exceed 1280px (vectors flicker on dragend if it is)\r\n\t\tCLIP_PADDING: (function () {\r\n\t\t\tvar max = L.Browser.mobile ? 1280 : 2000,\r\n\t\t\t    target = (max / Math.max(window.outerWidth, window.outerHeight) - 1) / 2;\r\n\t\t\treturn Math.max(0, Math.min(0.5, target));\r\n\t\t})()\r\n\t},\r\n\r\n\toptions: {\r\n\t\tstroke: true,\r\n\t\tcolor: '#0033ff',\r\n\t\tdashArray: null,\r\n\t\tlineCap: null,\r\n\t\tlineJoin: null,\r\n\t\tweight: 5,\r\n\t\topacity: 0.5,\r\n\r\n\t\tfill: false,\r\n\t\tfillColor: null, //same as color by default\r\n\t\tfillOpacity: 0.2,\r\n\r\n\t\tclickable: true\r\n\t},\r\n\r\n\tinitialize: function (options) {\r\n\t\tL.setOptions(this, options);\r\n\t},\r\n\r\n\tonAdd: function (map) {\r\n\t\tthis._map = map;\r\n\r\n\t\tif (!this._container) {\r\n\t\t\tthis._initElements();\r\n\t\t\tthis._initEvents();\r\n\t\t}\r\n\r\n\t\tthis.projectLatlngs();\r\n\t\tthis._updatePath();\r\n\r\n\t\tif (this._container) {\r\n\t\t\tthis._map._pathRoot.appendChild(this._container);\r\n\t\t}\r\n\r\n\t\tthis.fire('add');\r\n\r\n\t\tmap.on({\r\n\t\t\t'viewreset': this.projectLatlngs,\r\n\t\t\t'moveend': this._updatePath\r\n\t\t}, this);\r\n\t},\r\n\r\n\taddTo: function (map) {\r\n\t\tmap.addLayer(this);\r\n\t\treturn this;\r\n\t},\r\n\r\n\tonRemove: function (map) {\r\n\t\tmap._pathRoot.removeChild(this._container);\r\n\r\n\t\t// Need to fire remove event before we set _map to null as the event hooks might need the object\r\n\t\tthis.fire('remove');\r\n\t\tthis._map = null;\r\n\r\n\t\tif (L.Browser.vml) {\r\n\t\t\tthis._container = null;\r\n\t\t\tthis._stroke = null;\r\n\t\t\tthis._fill = null;\r\n\t\t}\r\n\r\n\t\tmap.off({\r\n\t\t\t'viewreset': this.projectLatlngs,\r\n\t\t\t'moveend': this._updatePath\r\n\t\t}, this);\r\n\t},\r\n\r\n\tprojectLatlngs: function () {\r\n\t\t// do all projection stuff here\r\n\t},\r\n\r\n\tsetStyle: function (style) {\r\n\t\tL.setOptions(this, style);\r\n\r\n\t\tif (this._container) {\r\n\t\t\tthis._updateStyle();\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tredraw: function () {\r\n\t\tif (this._map) {\r\n\t\t\tthis.projectLatlngs();\r\n\t\t\tthis._updatePath();\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n});\r\n\r\nL.Map.include({\r\n\t_updatePathViewport: function () {\r\n\t\tvar p = L.Path.CLIP_PADDING,\r\n\t\t    size = this.getSize(),\r\n\t\t    panePos = L.DomUtil.getPosition(this._mapPane),\r\n\t\t    min = panePos.multiplyBy(-1)._subtract(size.multiplyBy(p)._round()),\r\n\t\t    max = min.add(size.multiplyBy(1 + p * 2)._round());\r\n\r\n\t\tthis._pathViewport = new L.Bounds(min, max);\r\n\t}\r\n});\r\n\n\n/*\r\n * Extends L.Path with SVG-specific rendering code.\r\n */\r\n\r\nL.Path.SVG_NS = 'http://www.w3.org/2000/svg';\r\n\r\nL.Browser.svg = !!(document.createElementNS && document.createElementNS(L.Path.SVG_NS, 'svg').createSVGRect);\r\n\r\nL.Path = L.Path.extend({\r\n\tstatics: {\r\n\t\tSVG: L.Browser.svg\r\n\t},\r\n\r\n\tbringToFront: function () {\r\n\t\tvar root = this._map._pathRoot,\r\n\t\t    path = this._container;\r\n\r\n\t\tif (path && root.lastChild !== path) {\r\n\t\t\troot.appendChild(path);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tbringToBack: function () {\r\n\t\tvar root = this._map._pathRoot,\r\n\t\t    path = this._container,\r\n\t\t    first = root.firstChild;\r\n\r\n\t\tif (path && first !== path) {\r\n\t\t\troot.insertBefore(path, first);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tgetPathString: function () {\r\n\t\t// form path string here\r\n\t},\r\n\r\n\t_createElement: function (name) {\r\n\t\treturn document.createElementNS(L.Path.SVG_NS, name);\r\n\t},\r\n\r\n\t_initElements: function () {\r\n\t\tthis._map._initPathRoot();\r\n\t\tthis._initPath();\r\n\t\tthis._initStyle();\r\n\t},\r\n\r\n\t_initPath: function () {\r\n\t\tthis._container = this._createElement('g');\r\n\r\n\t\tthis._path = this._createElement('path');\r\n\r\n\t\tif (this.options.className) {\r\n\t\t\tL.DomUtil.addClass(this._path, this.options.className);\r\n\t\t}\r\n\r\n\t\tthis._container.appendChild(this._path);\r\n\t},\r\n\r\n\t_initStyle: function () {\r\n\t\tif (this.options.stroke) {\r\n\t\t\tthis._path.setAttribute('stroke-linejoin', 'round');\r\n\t\t\tthis._path.setAttribute('stroke-linecap', 'round');\r\n\t\t}\r\n\t\tif (this.options.fill) {\r\n\t\t\tthis._path.setAttribute('fill-rule', 'evenodd');\r\n\t\t}\r\n\t\tif (this.options.pointerEvents) {\r\n\t\t\tthis._path.setAttribute('pointer-events', this.options.pointerEvents);\r\n\t\t}\r\n\t\tif (!this.options.clickable && !this.options.pointerEvents) {\r\n\t\t\tthis._path.setAttribute('pointer-events', 'none');\r\n\t\t}\r\n\t\tthis._updateStyle();\r\n\t},\r\n\r\n\t_updateStyle: function () {\r\n\t\tif (this.options.stroke) {\r\n\t\t\tthis._path.setAttribute('stroke', this.options.color);\r\n\t\t\tthis._path.setAttribute('stroke-opacity', this.options.opacity);\r\n\t\t\tthis._path.setAttribute('stroke-width', this.options.weight);\r\n\t\t\tif (this.options.dashArray) {\r\n\t\t\t\tthis._path.setAttribute('stroke-dasharray', this.options.dashArray);\r\n\t\t\t} else {\r\n\t\t\t\tthis._path.removeAttribute('stroke-dasharray');\r\n\t\t\t}\r\n\t\t\tif (this.options.lineCap) {\r\n\t\t\t\tthis._path.setAttribute('stroke-linecap', this.options.lineCap);\r\n\t\t\t}\r\n\t\t\tif (this.options.lineJoin) {\r\n\t\t\t\tthis._path.setAttribute('stroke-linejoin', this.options.lineJoin);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis._path.setAttribute('stroke', 'none');\r\n\t\t}\r\n\t\tif (this.options.fill) {\r\n\t\t\tthis._path.setAttribute('fill', this.options.fillColor || this.options.color);\r\n\t\t\tthis._path.setAttribute('fill-opacity', this.options.fillOpacity);\r\n\t\t} else {\r\n\t\t\tthis._path.setAttribute('fill', 'none');\r\n\t\t}\r\n\t},\r\n\r\n\t_updatePath: function () {\r\n\t\tvar str = this.getPathString();\r\n\t\tif (!str) {\r\n\t\t\t// fix webkit empty string parsing bug\r\n\t\t\tstr = 'M0 0';\r\n\t\t}\r\n\t\tthis._path.setAttribute('d', str);\r\n\t},\r\n\r\n\t// TODO remove duplication with L.Map\r\n\t_initEvents: function () {\r\n\t\tif (this.options.clickable) {\r\n\t\t\tif (L.Browser.svg || !L.Browser.vml) {\r\n\t\t\t\tL.DomUtil.addClass(this._path, 'leaflet-clickable');\r\n\t\t\t}\r\n\r\n\t\t\tL.DomEvent.on(this._container, 'click', this._onMouseClick, this);\r\n\r\n\t\t\tvar events = ['dblclick', 'mousedown', 'mouseover',\r\n\t\t\t              'mouseout', 'mousemove', 'contextmenu'];\r\n\t\t\tfor (var i = 0; i < events.length; i++) {\r\n\t\t\t\tL.DomEvent.on(this._container, events[i], this._fireMouseEvent, this);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_onMouseClick: function (e) {\r\n\t\tif (this._map.dragging && this._map.dragging.moved()) { return; }\r\n\r\n\t\tthis._fireMouseEvent(e);\r\n\t},\r\n\r\n\t_fireMouseEvent: function (e) {\r\n\t\tif (!this._map || !this.hasEventListeners(e.type)) { return; }\r\n\r\n\t\tvar map = this._map,\r\n\t\t    containerPoint = map.mouseEventToContainerPoint(e),\r\n\t\t    layerPoint = map.containerPointToLayerPoint(containerPoint),\r\n\t\t    latlng = map.layerPointToLatLng(layerPoint);\r\n\r\n\t\tthis.fire(e.type, {\r\n\t\t\tlatlng: latlng,\r\n\t\t\tlayerPoint: layerPoint,\r\n\t\t\tcontainerPoint: containerPoint,\r\n\t\t\toriginalEvent: e\r\n\t\t});\r\n\r\n\t\tif (e.type === 'contextmenu') {\r\n\t\t\tL.DomEvent.preventDefault(e);\r\n\t\t}\r\n\t\tif (e.type !== 'mousemove') {\r\n\t\t\tL.DomEvent.stopPropagation(e);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nL.Map.include({\r\n\t_initPathRoot: function () {\r\n\t\tif (!this._pathRoot) {\r\n\t\t\tthis._pathRoot = L.Path.prototype._createElement('svg');\r\n\t\t\tthis._panes.overlayPane.appendChild(this._pathRoot);\r\n\r\n\t\t\tif (this.options.zoomAnimation && L.Browser.any3d) {\r\n\t\t\t\tL.DomUtil.addClass(this._pathRoot, 'leaflet-zoom-animated');\r\n\r\n\t\t\t\tthis.on({\r\n\t\t\t\t\t'zoomanim': this._animatePathZoom,\r\n\t\t\t\t\t'zoomend': this._endPathZoom\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tL.DomUtil.addClass(this._pathRoot, 'leaflet-zoom-hide');\r\n\t\t\t}\r\n\r\n\t\t\tthis.on('moveend', this._updateSvgViewport);\r\n\t\t\tthis._updateSvgViewport();\r\n\t\t}\r\n\t},\r\n\r\n\t_animatePathZoom: function (e) {\r\n\t\tvar scale = this.getZoomScale(e.zoom),\r\n\t\t    offset = this._getCenterOffset(e.center)._multiplyBy(-scale)._add(this._pathViewport.min);\r\n\r\n\t\tthis._pathRoot.style[L.DomUtil.TRANSFORM] =\r\n\t\t        L.DomUtil.getTranslateString(offset) + ' scale(' + scale + ') ';\r\n\r\n\t\tthis._pathZooming = true;\r\n\t},\r\n\r\n\t_endPathZoom: function () {\r\n\t\tthis._pathZooming = false;\r\n\t},\r\n\r\n\t_updateSvgViewport: function () {\r\n\r\n\t\tif (this._pathZooming) {\r\n\t\t\t// Do not update SVGs while a zoom animation is going on otherwise the animation will break.\r\n\t\t\t// When the zoom animation ends we will be updated again anyway\r\n\t\t\t// This fixes the case where you do a momentum move and zoom while the move is still ongoing.\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._updatePathViewport();\r\n\r\n\t\tvar vp = this._pathViewport,\r\n\t\t    min = vp.min,\r\n\t\t    max = vp.max,\r\n\t\t    width = max.x - min.x,\r\n\t\t    height = max.y - min.y,\r\n\t\t    root = this._pathRoot,\r\n\t\t    pane = this._panes.overlayPane;\r\n\r\n\t\t// Hack to make flicker on drag end on mobile webkit less irritating\r\n\t\tif (L.Browser.mobileWebkit) {\r\n\t\t\tpane.removeChild(root);\r\n\t\t}\r\n\r\n\t\tL.DomUtil.setPosition(root, min);\r\n\t\troot.setAttribute('width', width);\r\n\t\troot.setAttribute('height', height);\r\n\t\troot.setAttribute('viewBox', [min.x, min.y, width, height].join(' '));\r\n\r\n\t\tif (L.Browser.mobileWebkit) {\r\n\t\t\tpane.appendChild(root);\r\n\t\t}\r\n\t}\r\n});\r\n\n\n/*\r\n * Popup extension to L.Path (polylines, polygons, circles), adding popup-related methods.\r\n */\r\n\r\nL.Path.include({\r\n\r\n\tbindPopup: function (content, options) {\r\n\r\n\t\tif (content instanceof L.Popup) {\r\n\t\t\tthis._popup = content;\r\n\t\t} else {\r\n\t\t\tif (!this._popup || options) {\r\n\t\t\t\tthis._popup = new L.Popup(options, this);\r\n\t\t\t}\r\n\t\t\tthis._popup.setContent(content);\r\n\t\t}\r\n\r\n\t\tif (!this._popupHandlersAdded) {\r\n\t\t\tthis\r\n\t\t\t    .on('click', this._openPopup, this)\r\n\t\t\t    .on('remove', this.closePopup, this);\r\n\r\n\t\t\tthis._popupHandlersAdded = true;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tunbindPopup: function () {\r\n\t\tif (this._popup) {\r\n\t\t\tthis._popup = null;\r\n\t\t\tthis\r\n\t\t\t    .off('click', this._openPopup)\r\n\t\t\t    .off('remove', this.closePopup);\r\n\r\n\t\t\tthis._popupHandlersAdded = false;\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\topenPopup: function (latlng) {\r\n\r\n\t\tif (this._popup) {\r\n\t\t\t// open the popup from one of the path's points if not specified\r\n\t\t\tlatlng = latlng || this._latlng ||\r\n\t\t\t         this._latlngs[Math.floor(this._latlngs.length / 2)];\r\n\r\n\t\t\tthis._openPopup({latlng: latlng});\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tclosePopup: function () {\r\n\t\tif (this._popup) {\r\n\t\t\tthis._popup._close();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_openPopup: function (e) {\r\n\t\tthis._popup.setLatLng(e.latlng);\r\n\t\tthis._map.openPopup(this._popup);\r\n\t}\r\n});\r\n\n\n/*\r\n * Vector rendering for IE6-8 through VML.\r\n * Thanks to Dmitry Baranovsky and his Raphael library for inspiration!\r\n */\r\n\r\nL.Browser.vml = !L.Browser.svg && (function () {\r\n\ttry {\r\n\t\tvar div = document.createElement('div');\r\n\t\tdiv.innerHTML = '<v:shape adj=\"1\"/>';\r\n\r\n\t\tvar shape = div.firstChild;\r\n\t\tshape.style.behavior = 'url(#default#VML)';\r\n\r\n\t\treturn shape && (typeof shape.adj === 'object');\r\n\r\n\t} catch (e) {\r\n\t\treturn false;\r\n\t}\r\n}());\r\n\r\nL.Path = L.Browser.svg || !L.Browser.vml ? L.Path : L.Path.extend({\r\n\tstatics: {\r\n\t\tVML: true,\r\n\t\tCLIP_PADDING: 0.02\r\n\t},\r\n\r\n\t_createElement: (function () {\r\n\t\ttry {\r\n\t\t\tdocument.namespaces.add('lvml', 'urn:schemas-microsoft-com:vml');\r\n\t\t\treturn function (name) {\r\n\t\t\t\treturn document.createElement('<lvml:' + name + ' class=\"lvml\">');\r\n\t\t\t};\r\n\t\t} catch (e) {\r\n\t\t\treturn function (name) {\r\n\t\t\t\treturn document.createElement(\r\n\t\t\t\t        '<' + name + ' xmlns=\"urn:schemas-microsoft.com:vml\" class=\"lvml\">');\r\n\t\t\t};\r\n\t\t}\r\n\t}()),\r\n\r\n\t_initPath: function () {\r\n\t\tvar container = this._container = this._createElement('shape');\r\n\r\n\t\tL.DomUtil.addClass(container, 'leaflet-vml-shape' +\r\n\t\t\t(this.options.className ? ' ' + this.options.className : ''));\r\n\r\n\t\tif (this.options.clickable) {\r\n\t\t\tL.DomUtil.addClass(container, 'leaflet-clickable');\r\n\t\t}\r\n\r\n\t\tcontainer.coordsize = '1 1';\r\n\r\n\t\tthis._path = this._createElement('path');\r\n\t\tcontainer.appendChild(this._path);\r\n\r\n\t\tthis._map._pathRoot.appendChild(container);\r\n\t},\r\n\r\n\t_initStyle: function () {\r\n\t\tthis._updateStyle();\r\n\t},\r\n\r\n\t_updateStyle: function () {\r\n\t\tvar stroke = this._stroke,\r\n\t\t    fill = this._fill,\r\n\t\t    options = this.options,\r\n\t\t    container = this._container;\r\n\r\n\t\tcontainer.stroked = options.stroke;\r\n\t\tcontainer.filled = options.fill;\r\n\r\n\t\tif (options.stroke) {\r\n\t\t\tif (!stroke) {\r\n\t\t\t\tstroke = this._stroke = this._createElement('stroke');\r\n\t\t\t\tstroke.endcap = 'round';\r\n\t\t\t\tcontainer.appendChild(stroke);\r\n\t\t\t}\r\n\t\t\tstroke.weight = options.weight + 'px';\r\n\t\t\tstroke.color = options.color;\r\n\t\t\tstroke.opacity = options.opacity;\r\n\r\n\t\t\tif (options.dashArray) {\r\n\t\t\t\tstroke.dashStyle = L.Util.isArray(options.dashArray) ?\r\n\t\t\t\t    options.dashArray.join(' ') :\r\n\t\t\t\t    options.dashArray.replace(/( *, *)/g, ' ');\r\n\t\t\t} else {\r\n\t\t\t\tstroke.dashStyle = '';\r\n\t\t\t}\r\n\t\t\tif (options.lineCap) {\r\n\t\t\t\tstroke.endcap = options.lineCap.replace('butt', 'flat');\r\n\t\t\t}\r\n\t\t\tif (options.lineJoin) {\r\n\t\t\t\tstroke.joinstyle = options.lineJoin;\r\n\t\t\t}\r\n\r\n\t\t} else if (stroke) {\r\n\t\t\tcontainer.removeChild(stroke);\r\n\t\t\tthis._stroke = null;\r\n\t\t}\r\n\r\n\t\tif (options.fill) {\r\n\t\t\tif (!fill) {\r\n\t\t\t\tfill = this._fill = this._createElement('fill');\r\n\t\t\t\tcontainer.appendChild(fill);\r\n\t\t\t}\r\n\t\t\tfill.color = options.fillColor || options.color;\r\n\t\t\tfill.opacity = options.fillOpacity;\r\n\r\n\t\t} else if (fill) {\r\n\t\t\tcontainer.removeChild(fill);\r\n\t\t\tthis._fill = null;\r\n\t\t}\r\n\t},\r\n\r\n\t_updatePath: function () {\r\n\t\tvar style = this._container.style;\r\n\r\n\t\tstyle.display = 'none';\r\n\t\tthis._path.v = this.getPathString() + ' '; // the space fixes IE empty path string bug\r\n\t\tstyle.display = '';\r\n\t}\r\n});\r\n\r\nL.Map.include(L.Browser.svg || !L.Browser.vml ? {} : {\r\n\t_initPathRoot: function () {\r\n\t\tif (this._pathRoot) { return; }\r\n\r\n\t\tvar root = this._pathRoot = document.createElement('div');\r\n\t\troot.className = 'leaflet-vml-container';\r\n\t\tthis._panes.overlayPane.appendChild(root);\r\n\r\n\t\tthis.on('moveend', this._updatePathViewport);\r\n\t\tthis._updatePathViewport();\r\n\t}\r\n});\r\n\n\n/*\r\n * Vector rendering for all browsers that support canvas.\r\n */\r\n\r\nL.Browser.canvas = (function () {\r\n\treturn !!document.createElement('canvas').getContext;\r\n}());\r\n\r\nL.Path = (L.Path.SVG && !window.L_PREFER_CANVAS) || !L.Browser.canvas ? L.Path : L.Path.extend({\r\n\tstatics: {\r\n\t\t//CLIP_PADDING: 0.02, // not sure if there's a need to set it to a small value\r\n\t\tCANVAS: true,\r\n\t\tSVG: false\r\n\t},\r\n\r\n\tredraw: function () {\r\n\t\tif (this._map) {\r\n\t\t\tthis.projectLatlngs();\r\n\t\t\tthis._requestUpdate();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetStyle: function (style) {\r\n\t\tL.setOptions(this, style);\r\n\r\n\t\tif (this._map) {\r\n\t\t\tthis._updateStyle();\r\n\t\t\tthis._requestUpdate();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tonRemove: function (map) {\r\n\t\tmap\r\n\t\t    .off('viewreset', this.projectLatlngs, this)\r\n\t\t    .off('moveend', this._updatePath, this);\r\n\r\n\t\tif (this.options.clickable) {\r\n\t\t\tthis._map.off('click', this._onClick, this);\r\n\t\t\tthis._map.off('mousemove', this._onMouseMove, this);\r\n\t\t}\r\n\r\n\t\tthis._requestUpdate();\r\n\t\t\r\n\t\tthis.fire('remove');\r\n\t\tthis._map = null;\r\n\t},\r\n\r\n\t_requestUpdate: function () {\r\n\t\tif (this._map && !L.Path._updateRequest) {\r\n\t\t\tL.Path._updateRequest = L.Util.requestAnimFrame(this._fireMapMoveEnd, this._map);\r\n\t\t}\r\n\t},\r\n\r\n\t_fireMapMoveEnd: function () {\r\n\t\tL.Path._updateRequest = null;\r\n\t\tthis.fire('moveend');\r\n\t},\r\n\r\n\t_initElements: function () {\r\n\t\tthis._map._initPathRoot();\r\n\t\tthis._ctx = this._map._canvasCtx;\r\n\t},\r\n\r\n\t_updateStyle: function () {\r\n\t\tvar options = this.options;\r\n\r\n\t\tif (options.stroke) {\r\n\t\t\tthis._ctx.lineWidth = options.weight;\r\n\t\t\tthis._ctx.strokeStyle = options.color;\r\n\t\t}\r\n\t\tif (options.fill) {\r\n\t\t\tthis._ctx.fillStyle = options.fillColor || options.color;\r\n\t\t}\r\n\r\n\t\tif (options.lineCap) {\r\n\t\t\tthis._ctx.lineCap = options.lineCap;\r\n\t\t}\r\n\t\tif (options.lineJoin) {\r\n\t\t\tthis._ctx.lineJoin = options.lineJoin;\r\n\t\t}\r\n\t},\r\n\r\n\t_drawPath: function () {\r\n\t\tvar i, j, len, len2, point, drawMethod;\r\n\r\n\t\tthis._ctx.beginPath();\r\n\r\n\t\tfor (i = 0, len = this._parts.length; i < len; i++) {\r\n\t\t\tfor (j = 0, len2 = this._parts[i].length; j < len2; j++) {\r\n\t\t\t\tpoint = this._parts[i][j];\r\n\t\t\t\tdrawMethod = (j === 0 ? 'move' : 'line') + 'To';\r\n\r\n\t\t\t\tthis._ctx[drawMethod](point.x, point.y);\r\n\t\t\t}\r\n\t\t\t// TODO refactor ugly hack\r\n\t\t\tif (this instanceof L.Polygon) {\r\n\t\t\t\tthis._ctx.closePath();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_checkIfEmpty: function () {\r\n\t\treturn !this._parts.length;\r\n\t},\r\n\r\n\t_updatePath: function () {\r\n\t\tif (this._checkIfEmpty()) { return; }\r\n\r\n\t\tvar ctx = this._ctx,\r\n\t\t    options = this.options;\r\n\r\n\t\tthis._drawPath();\r\n\t\tctx.save();\r\n\t\tthis._updateStyle();\r\n\r\n\t\tif (options.fill) {\r\n\t\t\tctx.globalAlpha = options.fillOpacity;\r\n\t\t\tctx.fill(options.fillRule || 'evenodd');\r\n\t\t}\r\n\r\n\t\tif (options.stroke) {\r\n\t\t\tctx.globalAlpha = options.opacity;\r\n\t\t\tctx.stroke();\r\n\t\t}\r\n\r\n\t\tctx.restore();\r\n\r\n\t\t// TODO optimization: 1 fill/stroke for all features with equal style instead of 1 for each feature\r\n\t},\r\n\r\n\t_initEvents: function () {\r\n\t\tif (this.options.clickable) {\r\n\t\t\tthis._map.on('mousemove', this._onMouseMove, this);\r\n\t\t\tthis._map.on('click dblclick contextmenu', this._fireMouseEvent, this);\r\n\t\t}\r\n\t},\r\n\r\n\t_fireMouseEvent: function (e) {\r\n\t\tif (this._containsPoint(e.layerPoint)) {\r\n\t\t\tthis.fire(e.type, e);\r\n\t\t}\r\n\t},\r\n\r\n\t_onMouseMove: function (e) {\r\n\t\tif (!this._map || this._map._animatingZoom) { return; }\r\n\r\n\t\t// TODO don't do on each move\r\n\t\tif (this._containsPoint(e.layerPoint)) {\r\n\t\t\tthis._ctx.canvas.style.cursor = 'pointer';\r\n\t\t\tthis._mouseInside = true;\r\n\t\t\tthis.fire('mouseover', e);\r\n\r\n\t\t} else if (this._mouseInside) {\r\n\t\t\tthis._ctx.canvas.style.cursor = '';\r\n\t\t\tthis._mouseInside = false;\r\n\t\t\tthis.fire('mouseout', e);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nL.Map.include((L.Path.SVG && !window.L_PREFER_CANVAS) || !L.Browser.canvas ? {} : {\r\n\t_initPathRoot: function () {\r\n\t\tvar root = this._pathRoot,\r\n\t\t    ctx;\r\n\r\n\t\tif (!root) {\r\n\t\t\troot = this._pathRoot = document.createElement('canvas');\r\n\t\t\troot.style.position = 'absolute';\r\n\t\t\tctx = this._canvasCtx = root.getContext('2d');\r\n\r\n\t\t\tctx.lineCap = 'round';\r\n\t\t\tctx.lineJoin = 'round';\r\n\r\n\t\t\tthis._panes.overlayPane.appendChild(root);\r\n\r\n\t\t\tif (this.options.zoomAnimation) {\r\n\t\t\t\tthis._pathRoot.className = 'leaflet-zoom-animated';\r\n\t\t\t\tthis.on('zoomanim', this._animatePathZoom);\r\n\t\t\t\tthis.on('zoomend', this._endPathZoom);\r\n\t\t\t}\r\n\t\t\tthis.on('moveend', this._updateCanvasViewport);\r\n\t\t\tthis._updateCanvasViewport();\r\n\t\t}\r\n\t},\r\n\r\n\t_updateCanvasViewport: function () {\r\n\t\t// don't redraw while zooming. See _updateSvgViewport for more details\r\n\t\tif (this._pathZooming) { return; }\r\n\t\tthis._updatePathViewport();\r\n\r\n\t\tvar vp = this._pathViewport,\r\n\t\t    min = vp.min,\r\n\t\t    size = vp.max.subtract(min),\r\n\t\t    root = this._pathRoot;\r\n\r\n\t\t//TODO check if this works properly on mobile webkit\r\n\t\tL.DomUtil.setPosition(root, min);\r\n\t\troot.width = size.x;\r\n\t\troot.height = size.y;\r\n\t\troot.getContext('2d').translate(-min.x, -min.y);\r\n\t}\r\n});\r\n\n\n/*\r\n * L.LineUtil contains different utility functions for line segments\r\n * and polylines (clipping, simplification, distances, etc.)\r\n */\r\n\r\n/*jshint bitwise:false */ // allow bitwise operations for this file\r\n\r\nL.LineUtil = {\r\n\r\n\t// Simplify polyline with vertex reduction and Douglas-Peucker simplification.\r\n\t// Improves rendering performance dramatically by lessening the number of points to draw.\r\n\r\n\tsimplify: function (/*Point[]*/ points, /*Number*/ tolerance) {\r\n\t\tif (!tolerance || !points.length) {\r\n\t\t\treturn points.slice();\r\n\t\t}\r\n\r\n\t\tvar sqTolerance = tolerance * tolerance;\r\n\r\n\t\t// stage 1: vertex reduction\r\n\t\tpoints = this._reducePoints(points, sqTolerance);\r\n\r\n\t\t// stage 2: Douglas-Peucker simplification\r\n\t\tpoints = this._simplifyDP(points, sqTolerance);\r\n\r\n\t\treturn points;\r\n\t},\r\n\r\n\t// distance from a point to a segment between two points\r\n\tpointToSegmentDistance:  function (/*Point*/ p, /*Point*/ p1, /*Point*/ p2) {\r\n\t\treturn Math.sqrt(this._sqClosestPointOnSegment(p, p1, p2, true));\r\n\t},\r\n\r\n\tclosestPointOnSegment: function (/*Point*/ p, /*Point*/ p1, /*Point*/ p2) {\r\n\t\treturn this._sqClosestPointOnSegment(p, p1, p2);\r\n\t},\r\n\r\n\t// Douglas-Peucker simplification, see http://en.wikipedia.org/wiki/Douglas-Peucker_algorithm\r\n\t_simplifyDP: function (points, sqTolerance) {\r\n\r\n\t\tvar len = points.length,\r\n\t\t    ArrayConstructor = typeof Uint8Array !== undefined + '' ? Uint8Array : Array,\r\n\t\t    markers = new ArrayConstructor(len);\r\n\r\n\t\tmarkers[0] = markers[len - 1] = 1;\r\n\r\n\t\tthis._simplifyDPStep(points, markers, sqTolerance, 0, len - 1);\r\n\r\n\t\tvar i,\r\n\t\t    newPoints = [];\r\n\r\n\t\tfor (i = 0; i < len; i++) {\r\n\t\t\tif (markers[i]) {\r\n\t\t\t\tnewPoints.push(points[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn newPoints;\r\n\t},\r\n\r\n\t_simplifyDPStep: function (points, markers, sqTolerance, first, last) {\r\n\r\n\t\tvar maxSqDist = 0,\r\n\t\t    index, i, sqDist;\r\n\r\n\t\tfor (i = first + 1; i <= last - 1; i++) {\r\n\t\t\tsqDist = this._sqClosestPointOnSegment(points[i], points[first], points[last], true);\r\n\r\n\t\t\tif (sqDist > maxSqDist) {\r\n\t\t\t\tindex = i;\r\n\t\t\t\tmaxSqDist = sqDist;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (maxSqDist > sqTolerance) {\r\n\t\t\tmarkers[index] = 1;\r\n\r\n\t\t\tthis._simplifyDPStep(points, markers, sqTolerance, first, index);\r\n\t\t\tthis._simplifyDPStep(points, markers, sqTolerance, index, last);\r\n\t\t}\r\n\t},\r\n\r\n\t// reduce points that are too close to each other to a single point\r\n\t_reducePoints: function (points, sqTolerance) {\r\n\t\tvar reducedPoints = [points[0]];\r\n\r\n\t\tfor (var i = 1, prev = 0, len = points.length; i < len; i++) {\r\n\t\t\tif (this._sqDist(points[i], points[prev]) > sqTolerance) {\r\n\t\t\t\treducedPoints.push(points[i]);\r\n\t\t\t\tprev = i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (prev < len - 1) {\r\n\t\t\treducedPoints.push(points[len - 1]);\r\n\t\t}\r\n\t\treturn reducedPoints;\r\n\t},\r\n\r\n\t// Cohen-Sutherland line clipping algorithm.\r\n\t// Used to avoid rendering parts of a polyline that are not currently visible.\r\n\r\n\tclipSegment: function (a, b, bounds, useLastCode) {\r\n\t\tvar codeA = useLastCode ? this._lastCode : this._getBitCode(a, bounds),\r\n\t\t    codeB = this._getBitCode(b, bounds),\r\n\r\n\t\t    codeOut, p, newCode;\r\n\r\n\t\t// save 2nd code to avoid calculating it on the next segment\r\n\t\tthis._lastCode = codeB;\r\n\r\n\t\twhile (true) {\r\n\t\t\t// if a,b is inside the clip window (trivial accept)\r\n\t\t\tif (!(codeA | codeB)) {\r\n\t\t\t\treturn [a, b];\r\n\t\t\t// if a,b is outside the clip window (trivial reject)\r\n\t\t\t} else if (codeA & codeB) {\r\n\t\t\t\treturn false;\r\n\t\t\t// other cases\r\n\t\t\t} else {\r\n\t\t\t\tcodeOut = codeA || codeB;\r\n\t\t\t\tp = this._getEdgeIntersection(a, b, codeOut, bounds);\r\n\t\t\t\tnewCode = this._getBitCode(p, bounds);\r\n\r\n\t\t\t\tif (codeOut === codeA) {\r\n\t\t\t\t\ta = p;\r\n\t\t\t\t\tcodeA = newCode;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tb = p;\r\n\t\t\t\t\tcodeB = newCode;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_getEdgeIntersection: function (a, b, code, bounds) {\r\n\t\tvar dx = b.x - a.x,\r\n\t\t    dy = b.y - a.y,\r\n\t\t    min = bounds.min,\r\n\t\t    max = bounds.max;\r\n\r\n\t\tif (code & 8) { // top\r\n\t\t\treturn new L.Point(a.x + dx * (max.y - a.y) / dy, max.y);\r\n\t\t} else if (code & 4) { // bottom\r\n\t\t\treturn new L.Point(a.x + dx * (min.y - a.y) / dy, min.y);\r\n\t\t} else if (code & 2) { // right\r\n\t\t\treturn new L.Point(max.x, a.y + dy * (max.x - a.x) / dx);\r\n\t\t} else if (code & 1) { // left\r\n\t\t\treturn new L.Point(min.x, a.y + dy * (min.x - a.x) / dx);\r\n\t\t}\r\n\t},\r\n\r\n\t_getBitCode: function (/*Point*/ p, bounds) {\r\n\t\tvar code = 0;\r\n\r\n\t\tif (p.x < bounds.min.x) { // left\r\n\t\t\tcode |= 1;\r\n\t\t} else if (p.x > bounds.max.x) { // right\r\n\t\t\tcode |= 2;\r\n\t\t}\r\n\t\tif (p.y < bounds.min.y) { // bottom\r\n\t\t\tcode |= 4;\r\n\t\t} else if (p.y > bounds.max.y) { // top\r\n\t\t\tcode |= 8;\r\n\t\t}\r\n\r\n\t\treturn code;\r\n\t},\r\n\r\n\t// square distance (to avoid unnecessary Math.sqrt calls)\r\n\t_sqDist: function (p1, p2) {\r\n\t\tvar dx = p2.x - p1.x,\r\n\t\t    dy = p2.y - p1.y;\r\n\t\treturn dx * dx + dy * dy;\r\n\t},\r\n\r\n\t// return closest point on segment or distance to that point\r\n\t_sqClosestPointOnSegment: function (p, p1, p2, sqDist) {\r\n\t\tvar x = p1.x,\r\n\t\t    y = p1.y,\r\n\t\t    dx = p2.x - x,\r\n\t\t    dy = p2.y - y,\r\n\t\t    dot = dx * dx + dy * dy,\r\n\t\t    t;\r\n\r\n\t\tif (dot > 0) {\r\n\t\t\tt = ((p.x - x) * dx + (p.y - y) * dy) / dot;\r\n\r\n\t\t\tif (t > 1) {\r\n\t\t\t\tx = p2.x;\r\n\t\t\t\ty = p2.y;\r\n\t\t\t} else if (t > 0) {\r\n\t\t\t\tx += dx * t;\r\n\t\t\t\ty += dy * t;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdx = p.x - x;\r\n\t\tdy = p.y - y;\r\n\r\n\t\treturn sqDist ? dx * dx + dy * dy : new L.Point(x, y);\r\n\t}\r\n};\r\n\n\n/*\r\n * L.Polyline is used to display polylines on a map.\r\n */\r\n\r\nL.Polyline = L.Path.extend({\r\n\tinitialize: function (latlngs, options) {\r\n\t\tL.Path.prototype.initialize.call(this, options);\r\n\r\n\t\tthis._latlngs = this._convertLatLngs(latlngs);\r\n\t},\r\n\r\n\toptions: {\r\n\t\t// how much to simplify the polyline on each zoom level\r\n\t\t// more = better performance and smoother look, less = more accurate\r\n\t\tsmoothFactor: 1.0,\r\n\t\tnoClip: false\r\n\t},\r\n\r\n\tprojectLatlngs: function () {\r\n\t\tthis._originalPoints = [];\r\n\r\n\t\tfor (var i = 0, len = this._latlngs.length; i < len; i++) {\r\n\t\t\tthis._originalPoints[i] = this._map.latLngToLayerPoint(this._latlngs[i]);\r\n\t\t}\r\n\t},\r\n\r\n\tgetPathString: function () {\r\n\t\tfor (var i = 0, len = this._parts.length, str = ''; i < len; i++) {\r\n\t\t\tstr += this._getPathPartStr(this._parts[i]);\r\n\t\t}\r\n\t\treturn str;\r\n\t},\r\n\r\n\tgetLatLngs: function () {\r\n\t\treturn this._latlngs;\r\n\t},\r\n\r\n\tsetLatLngs: function (latlngs) {\r\n\t\tthis._latlngs = this._convertLatLngs(latlngs);\r\n\t\treturn this.redraw();\r\n\t},\r\n\r\n\taddLatLng: function (latlng) {\r\n\t\tthis._latlngs.push(L.latLng(latlng));\r\n\t\treturn this.redraw();\r\n\t},\r\n\r\n\tspliceLatLngs: function () { // (Number index, Number howMany)\r\n\t\tvar removed = [].splice.apply(this._latlngs, arguments);\r\n\t\tthis._convertLatLngs(this._latlngs, true);\r\n\t\tthis.redraw();\r\n\t\treturn removed;\r\n\t},\r\n\r\n\tclosestLayerPoint: function (p) {\r\n\t\tvar minDistance = Infinity, parts = this._parts, p1, p2, minPoint = null;\r\n\r\n\t\tfor (var j = 0, jLen = parts.length; j < jLen; j++) {\r\n\t\t\tvar points = parts[j];\r\n\t\t\tfor (var i = 1, len = points.length; i < len; i++) {\r\n\t\t\t\tp1 = points[i - 1];\r\n\t\t\t\tp2 = points[i];\r\n\t\t\t\tvar sqDist = L.LineUtil._sqClosestPointOnSegment(p, p1, p2, true);\r\n\t\t\t\tif (sqDist < minDistance) {\r\n\t\t\t\t\tminDistance = sqDist;\r\n\t\t\t\t\tminPoint = L.LineUtil._sqClosestPointOnSegment(p, p1, p2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (minPoint) {\r\n\t\t\tminPoint.distance = Math.sqrt(minDistance);\r\n\t\t}\r\n\t\treturn minPoint;\r\n\t},\r\n\r\n\tgetBounds: function () {\r\n\t\treturn new L.LatLngBounds(this.getLatLngs());\r\n\t},\r\n\r\n\t_convertLatLngs: function (latlngs, overwrite) {\r\n\t\tvar i, len, target = overwrite ? latlngs : [];\r\n\r\n\t\tfor (i = 0, len = latlngs.length; i < len; i++) {\r\n\t\t\tif (L.Util.isArray(latlngs[i]) && typeof latlngs[i][0] !== 'number') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttarget[i] = L.latLng(latlngs[i]);\r\n\t\t}\r\n\t\treturn target;\r\n\t},\r\n\r\n\t_initEvents: function () {\r\n\t\tL.Path.prototype._initEvents.call(this);\r\n\t},\r\n\r\n\t_getPathPartStr: function (points) {\r\n\t\tvar round = L.Path.VML;\r\n\r\n\t\tfor (var j = 0, len2 = points.length, str = '', p; j < len2; j++) {\r\n\t\t\tp = points[j];\r\n\t\t\tif (round) {\r\n\t\t\t\tp._round();\r\n\t\t\t}\r\n\t\t\tstr += (j ? 'L' : 'M') + p.x + ' ' + p.y;\r\n\t\t}\r\n\t\treturn str;\r\n\t},\r\n\r\n\t_clipPoints: function () {\r\n\t\tvar points = this._originalPoints,\r\n\t\t    len = points.length,\r\n\t\t    i, k, segment;\r\n\r\n\t\tif (this.options.noClip) {\r\n\t\t\tthis._parts = [points];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._parts = [];\r\n\r\n\t\tvar parts = this._parts,\r\n\t\t    vp = this._map._pathViewport,\r\n\t\t    lu = L.LineUtil;\r\n\r\n\t\tfor (i = 0, k = 0; i < len - 1; i++) {\r\n\t\t\tsegment = lu.clipSegment(points[i], points[i + 1], vp, i);\r\n\t\t\tif (!segment) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tparts[k] = parts[k] || [];\r\n\t\t\tparts[k].push(segment[0]);\r\n\r\n\t\t\t// if segment goes out of screen, or it's the last one, it's the end of the line part\r\n\t\t\tif ((segment[1] !== points[i + 1]) || (i === len - 2)) {\r\n\t\t\t\tparts[k].push(segment[1]);\r\n\t\t\t\tk++;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// simplify each clipped part of the polyline\r\n\t_simplifyPoints: function () {\r\n\t\tvar parts = this._parts,\r\n\t\t    lu = L.LineUtil;\r\n\r\n\t\tfor (var i = 0, len = parts.length; i < len; i++) {\r\n\t\t\tparts[i] = lu.simplify(parts[i], this.options.smoothFactor);\r\n\t\t}\r\n\t},\r\n\r\n\t_updatePath: function () {\r\n\t\tif (!this._map) { return; }\r\n\r\n\t\tthis._clipPoints();\r\n\t\tthis._simplifyPoints();\r\n\r\n\t\tL.Path.prototype._updatePath.call(this);\r\n\t}\r\n});\r\n\r\nL.polyline = function (latlngs, options) {\r\n\treturn new L.Polyline(latlngs, options);\r\n};\r\n\n\n/*\r\n * L.PolyUtil contains utility functions for polygons (clipping, etc.).\r\n */\r\n\r\n/*jshint bitwise:false */ // allow bitwise operations here\r\n\r\nL.PolyUtil = {};\r\n\r\n/*\r\n * Sutherland-Hodgeman polygon clipping algorithm.\r\n * Used to avoid rendering parts of a polygon that are not currently visible.\r\n */\r\nL.PolyUtil.clipPolygon = function (points, bounds) {\r\n\tvar clippedPoints,\r\n\t    edges = [1, 4, 2, 8],\r\n\t    i, j, k,\r\n\t    a, b,\r\n\t    len, edge, p,\r\n\t    lu = L.LineUtil;\r\n\r\n\tfor (i = 0, len = points.length; i < len; i++) {\r\n\t\tpoints[i]._code = lu._getBitCode(points[i], bounds);\r\n\t}\r\n\r\n\t// for each edge (left, bottom, right, top)\r\n\tfor (k = 0; k < 4; k++) {\r\n\t\tedge = edges[k];\r\n\t\tclippedPoints = [];\r\n\r\n\t\tfor (i = 0, len = points.length, j = len - 1; i < len; j = i++) {\r\n\t\t\ta = points[i];\r\n\t\t\tb = points[j];\r\n\r\n\t\t\t// if a is inside the clip window\r\n\t\t\tif (!(a._code & edge)) {\r\n\t\t\t\t// if b is outside the clip window (a->b goes out of screen)\r\n\t\t\t\tif (b._code & edge) {\r\n\t\t\t\t\tp = lu._getEdgeIntersection(b, a, edge, bounds);\r\n\t\t\t\t\tp._code = lu._getBitCode(p, bounds);\r\n\t\t\t\t\tclippedPoints.push(p);\r\n\t\t\t\t}\r\n\t\t\t\tclippedPoints.push(a);\r\n\r\n\t\t\t// else if b is inside the clip window (a->b enters the screen)\r\n\t\t\t} else if (!(b._code & edge)) {\r\n\t\t\t\tp = lu._getEdgeIntersection(b, a, edge, bounds);\r\n\t\t\t\tp._code = lu._getBitCode(p, bounds);\r\n\t\t\t\tclippedPoints.push(p);\r\n\t\t\t}\r\n\t\t}\r\n\t\tpoints = clippedPoints;\r\n\t}\r\n\r\n\treturn points;\r\n};\r\n\n\n/*\r\n * L.Polygon is used to display polygons on a map.\r\n */\r\n\r\nL.Polygon = L.Polyline.extend({\r\n\toptions: {\r\n\t\tfill: true\r\n\t},\r\n\r\n\tinitialize: function (latlngs, options) {\r\n\t\tL.Polyline.prototype.initialize.call(this, latlngs, options);\r\n\t\tthis._initWithHoles(latlngs);\r\n\t},\r\n\r\n\t_initWithHoles: function (latlngs) {\r\n\t\tvar i, len, hole;\r\n\t\tif (latlngs && L.Util.isArray(latlngs[0]) && (typeof latlngs[0][0] !== 'number')) {\r\n\t\t\tthis._latlngs = this._convertLatLngs(latlngs[0]);\r\n\t\t\tthis._holes = latlngs.slice(1);\r\n\r\n\t\t\tfor (i = 0, len = this._holes.length; i < len; i++) {\r\n\t\t\t\thole = this._holes[i] = this._convertLatLngs(this._holes[i]);\r\n\t\t\t\tif (hole[0].equals(hole[hole.length - 1])) {\r\n\t\t\t\t\thole.pop();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// filter out last point if its equal to the first one\r\n\t\tlatlngs = this._latlngs;\r\n\r\n\t\tif (latlngs.length >= 2 && latlngs[0].equals(latlngs[latlngs.length - 1])) {\r\n\t\t\tlatlngs.pop();\r\n\t\t}\r\n\t},\r\n\r\n\tprojectLatlngs: function () {\r\n\t\tL.Polyline.prototype.projectLatlngs.call(this);\r\n\r\n\t\t// project polygon holes points\r\n\t\t// TODO move this logic to Polyline to get rid of duplication\r\n\t\tthis._holePoints = [];\r\n\r\n\t\tif (!this._holes) { return; }\r\n\r\n\t\tvar i, j, len, len2;\r\n\r\n\t\tfor (i = 0, len = this._holes.length; i < len; i++) {\r\n\t\t\tthis._holePoints[i] = [];\r\n\r\n\t\t\tfor (j = 0, len2 = this._holes[i].length; j < len2; j++) {\r\n\t\t\t\tthis._holePoints[i][j] = this._map.latLngToLayerPoint(this._holes[i][j]);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tsetLatLngs: function (latlngs) {\r\n\t\tif (latlngs && L.Util.isArray(latlngs[0]) && (typeof latlngs[0][0] !== 'number')) {\r\n\t\t\tthis._initWithHoles(latlngs);\r\n\t\t\treturn this.redraw();\r\n\t\t} else {\r\n\t\t\treturn L.Polyline.prototype.setLatLngs.call(this, latlngs);\r\n\t\t}\r\n\t},\r\n\r\n\t_clipPoints: function () {\r\n\t\tvar points = this._originalPoints,\r\n\t\t    newParts = [];\r\n\r\n\t\tthis._parts = [points].concat(this._holePoints);\r\n\r\n\t\tif (this.options.noClip) { return; }\r\n\r\n\t\tfor (var i = 0, len = this._parts.length; i < len; i++) {\r\n\t\t\tvar clipped = L.PolyUtil.clipPolygon(this._parts[i], this._map._pathViewport);\r\n\t\t\tif (clipped.length) {\r\n\t\t\t\tnewParts.push(clipped);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._parts = newParts;\r\n\t},\r\n\r\n\t_getPathPartStr: function (points) {\r\n\t\tvar str = L.Polyline.prototype._getPathPartStr.call(this, points);\r\n\t\treturn str + (L.Browser.svg ? 'z' : 'x');\r\n\t}\r\n});\r\n\r\nL.polygon = function (latlngs, options) {\r\n\treturn new L.Polygon(latlngs, options);\r\n};\r\n\n\n/*\r\n * Contains L.MultiPolyline and L.MultiPolygon layers.\r\n */\r\n\r\n(function () {\r\n\tfunction createMulti(Klass) {\r\n\r\n\t\treturn L.FeatureGroup.extend({\r\n\r\n\t\t\tinitialize: function (latlngs, options) {\r\n\t\t\t\tthis._layers = {};\r\n\t\t\t\tthis._options = options;\r\n\t\t\t\tthis.setLatLngs(latlngs);\r\n\t\t\t},\r\n\r\n\t\t\tsetLatLngs: function (latlngs) {\r\n\t\t\t\tvar i = 0,\r\n\t\t\t\t    len = latlngs.length;\r\n\r\n\t\t\t\tthis.eachLayer(function (layer) {\r\n\t\t\t\t\tif (i < len) {\r\n\t\t\t\t\t\tlayer.setLatLngs(latlngs[i++]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.removeLayer(layer);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\r\n\t\t\t\twhile (i < len) {\r\n\t\t\t\t\tthis.addLayer(new Klass(latlngs[i++], this._options));\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\r\n\t\t\tgetLatLngs: function () {\r\n\t\t\t\tvar latlngs = [];\r\n\r\n\t\t\t\tthis.eachLayer(function (layer) {\r\n\t\t\t\t\tlatlngs.push(layer.getLatLngs());\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn latlngs;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tL.MultiPolyline = createMulti(L.Polyline);\r\n\tL.MultiPolygon = createMulti(L.Polygon);\r\n\r\n\tL.multiPolyline = function (latlngs, options) {\r\n\t\treturn new L.MultiPolyline(latlngs, options);\r\n\t};\r\n\r\n\tL.multiPolygon = function (latlngs, options) {\r\n\t\treturn new L.MultiPolygon(latlngs, options);\r\n\t};\r\n}());\r\n\n\n/*\r\n * L.Rectangle extends Polygon and creates a rectangle when passed a LatLngBounds object.\r\n */\r\n\r\nL.Rectangle = L.Polygon.extend({\r\n\tinitialize: function (latLngBounds, options) {\r\n\t\tL.Polygon.prototype.initialize.call(this, this._boundsToLatLngs(latLngBounds), options);\r\n\t},\r\n\r\n\tsetBounds: function (latLngBounds) {\r\n\t\tthis.setLatLngs(this._boundsToLatLngs(latLngBounds));\r\n\t},\r\n\r\n\t_boundsToLatLngs: function (latLngBounds) {\r\n\t\tlatLngBounds = L.latLngBounds(latLngBounds);\r\n\t\treturn [\r\n\t\t\tlatLngBounds.getSouthWest(),\r\n\t\t\tlatLngBounds.getNorthWest(),\r\n\t\t\tlatLngBounds.getNorthEast(),\r\n\t\t\tlatLngBounds.getSouthEast()\r\n\t\t];\r\n\t}\r\n});\r\n\r\nL.rectangle = function (latLngBounds, options) {\r\n\treturn new L.Rectangle(latLngBounds, options);\r\n};\r\n\n\n/*\r\n * L.Circle is a circle overlay (with a certain radius in meters).\r\n */\r\n\r\nL.Circle = L.Path.extend({\r\n\tinitialize: function (latlng, radius, options) {\r\n\t\tL.Path.prototype.initialize.call(this, options);\r\n\r\n\t\tthis._latlng = L.latLng(latlng);\r\n\t\tthis._mRadius = radius;\r\n\t},\r\n\r\n\toptions: {\r\n\t\tfill: true\r\n\t},\r\n\r\n\tsetLatLng: function (latlng) {\r\n\t\tthis._latlng = L.latLng(latlng);\r\n\t\treturn this.redraw();\r\n\t},\r\n\r\n\tsetRadius: function (radius) {\r\n\t\tthis._mRadius = radius;\r\n\t\treturn this.redraw();\r\n\t},\r\n\r\n\tprojectLatlngs: function () {\r\n\t\tvar lngRadius = this._getLngRadius(),\r\n\t\t    latlng = this._latlng,\r\n\t\t    pointLeft = this._map.latLngToLayerPoint([latlng.lat, latlng.lng - lngRadius]);\r\n\r\n\t\tthis._point = this._map.latLngToLayerPoint(latlng);\r\n\t\tthis._radius = Math.max(this._point.x - pointLeft.x, 1);\r\n\t},\r\n\r\n\tgetBounds: function () {\r\n\t\tvar lngRadius = this._getLngRadius(),\r\n\t\t    latRadius = (this._mRadius / 40075017) * 360,\r\n\t\t    latlng = this._latlng;\r\n\r\n\t\treturn new L.LatLngBounds(\r\n\t\t        [latlng.lat - latRadius, latlng.lng - lngRadius],\r\n\t\t        [latlng.lat + latRadius, latlng.lng + lngRadius]);\r\n\t},\r\n\r\n\tgetLatLng: function () {\r\n\t\treturn this._latlng;\r\n\t},\r\n\r\n\tgetPathString: function () {\r\n\t\tvar p = this._point,\r\n\t\t    r = this._radius;\r\n\r\n\t\tif (this._checkIfEmpty()) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\tif (L.Browser.svg) {\r\n\t\t\treturn 'M' + p.x + ',' + (p.y - r) +\r\n\t\t\t       'A' + r + ',' + r + ',0,1,1,' +\r\n\t\t\t       (p.x - 0.1) + ',' + (p.y - r) + ' z';\r\n\t\t} else {\r\n\t\t\tp._round();\r\n\t\t\tr = Math.round(r);\r\n\t\t\treturn 'AL ' + p.x + ',' + p.y + ' ' + r + ',' + r + ' 0,' + (65535 * 360);\r\n\t\t}\r\n\t},\r\n\r\n\tgetRadius: function () {\r\n\t\treturn this._mRadius;\r\n\t},\r\n\r\n\t// TODO Earth hardcoded, move into projection code!\r\n\r\n\t_getLatRadius: function () {\r\n\t\treturn (this._mRadius / 40075017) * 360;\r\n\t},\r\n\r\n\t_getLngRadius: function () {\r\n\t\treturn this._getLatRadius() / Math.cos(L.LatLng.DEG_TO_RAD * this._latlng.lat);\r\n\t},\r\n\r\n\t_checkIfEmpty: function () {\r\n\t\tif (!this._map) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar vp = this._map._pathViewport,\r\n\t\t    r = this._radius,\r\n\t\t    p = this._point;\r\n\r\n\t\treturn p.x - r > vp.max.x || p.y - r > vp.max.y ||\r\n\t\t       p.x + r < vp.min.x || p.y + r < vp.min.y;\r\n\t}\r\n});\r\n\r\nL.circle = function (latlng, radius, options) {\r\n\treturn new L.Circle(latlng, radius, options);\r\n};\r\n\n\n/*\r\n * L.CircleMarker is a circle overlay with a permanent pixel radius.\r\n */\r\n\r\nL.CircleMarker = L.Circle.extend({\r\n\toptions: {\r\n\t\tradius: 10,\r\n\t\tweight: 2\r\n\t},\r\n\r\n\tinitialize: function (latlng, options) {\r\n\t\tL.Circle.prototype.initialize.call(this, latlng, null, options);\r\n\t\tthis._radius = this.options.radius;\r\n\t},\r\n\r\n\tprojectLatlngs: function () {\r\n\t\tthis._point = this._map.latLngToLayerPoint(this._latlng);\r\n\t},\r\n\r\n\t_updateStyle : function () {\r\n\t\tL.Circle.prototype._updateStyle.call(this);\r\n\t\tthis.setRadius(this.options.radius);\r\n\t},\r\n\r\n\tsetLatLng: function (latlng) {\r\n\t\tL.Circle.prototype.setLatLng.call(this, latlng);\r\n\t\tif (this._popup && this._popup._isOpen) {\r\n\t\t\tthis._popup.setLatLng(latlng);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetRadius: function (radius) {\r\n\t\tthis.options.radius = this._radius = radius;\r\n\t\treturn this.redraw();\r\n\t},\r\n\r\n\tgetRadius: function () {\r\n\t\treturn this._radius;\r\n\t}\r\n});\r\n\r\nL.circleMarker = function (latlng, options) {\r\n\treturn new L.CircleMarker(latlng, options);\r\n};\r\n\n\n/*\r\n * Extends L.Polyline to be able to manually detect clicks on Canvas-rendered polylines.\r\n */\r\n\r\nL.Polyline.include(!L.Path.CANVAS ? {} : {\r\n\t_containsPoint: function (p, closed) {\r\n\t\tvar i, j, k, len, len2, dist, part,\r\n\t\t    w = this.options.weight / 2;\r\n\r\n\t\tif (L.Browser.touch) {\r\n\t\t\tw += 10; // polyline click tolerance on touch devices\r\n\t\t}\r\n\r\n\t\tfor (i = 0, len = this._parts.length; i < len; i++) {\r\n\t\t\tpart = this._parts[i];\r\n\t\t\tfor (j = 0, len2 = part.length, k = len2 - 1; j < len2; k = j++) {\r\n\t\t\t\tif (!closed && (j === 0)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdist = L.LineUtil.pointToSegmentDistance(p, part[k], part[j]);\r\n\r\n\t\t\t\tif (dist <= w) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n});\r\n\n\n/*\r\n * Extends L.Polygon to be able to manually detect clicks on Canvas-rendered polygons.\r\n */\r\n\r\nL.Polygon.include(!L.Path.CANVAS ? {} : {\r\n\t_containsPoint: function (p) {\r\n\t\tvar inside = false,\r\n\t\t    part, p1, p2,\r\n\t\t    i, j, k,\r\n\t\t    len, len2;\r\n\r\n\t\t// TODO optimization: check if within bounds first\r\n\r\n\t\tif (L.Polyline.prototype._containsPoint.call(this, p, true)) {\r\n\t\t\t// click on polygon border\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// ray casting algorithm for detecting if point is in polygon\r\n\r\n\t\tfor (i = 0, len = this._parts.length; i < len; i++) {\r\n\t\t\tpart = this._parts[i];\r\n\r\n\t\t\tfor (j = 0, len2 = part.length, k = len2 - 1; j < len2; k = j++) {\r\n\t\t\t\tp1 = part[j];\r\n\t\t\t\tp2 = part[k];\r\n\r\n\t\t\t\tif (((p1.y > p.y) !== (p2.y > p.y)) &&\r\n\t\t\t\t\t\t(p.x < (p2.x - p1.x) * (p.y - p1.y) / (p2.y - p1.y) + p1.x)) {\r\n\t\t\t\t\tinside = !inside;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn inside;\r\n\t}\r\n});\r\n\n\n/*\r\n * Extends L.Circle with Canvas-specific code.\r\n */\r\n\r\nL.Circle.include(!L.Path.CANVAS ? {} : {\r\n\t_drawPath: function () {\r\n\t\tvar p = this._point;\r\n\t\tthis._ctx.beginPath();\r\n\t\tthis._ctx.arc(p.x, p.y, this._radius, 0, Math.PI * 2, false);\r\n\t},\r\n\r\n\t_containsPoint: function (p) {\r\n\t\tvar center = this._point,\r\n\t\t    w2 = this.options.stroke ? this.options.weight / 2 : 0;\r\n\r\n\t\treturn (p.distanceTo(center) <= this._radius + w2);\r\n\t}\r\n});\r\n\n\n/*\n * CircleMarker canvas specific drawing parts.\n */\n\nL.CircleMarker.include(!L.Path.CANVAS ? {} : {\n\t_updateStyle: function () {\n\t\tL.Path.prototype._updateStyle.call(this);\n\t}\n});\n\n\n/*\r\n * L.GeoJSON turns any GeoJSON data into a Leaflet layer.\r\n */\r\n\r\nL.GeoJSON = L.FeatureGroup.extend({\r\n\r\n\tinitialize: function (geojson, options) {\r\n\t\tL.setOptions(this, options);\r\n\r\n\t\tthis._layers = {};\r\n\r\n\t\tif (geojson) {\r\n\t\t\tthis.addData(geojson);\r\n\t\t}\r\n\t},\r\n\r\n\taddData: function (geojson) {\r\n\t\tvar features = L.Util.isArray(geojson) ? geojson : geojson.features,\r\n\t\t    i, len, feature;\r\n\r\n\t\tif (features) {\r\n\t\t\tfor (i = 0, len = features.length; i < len; i++) {\r\n\t\t\t\t// Only add this if geometry or geometries are set and not null\r\n\t\t\t\tfeature = features[i];\r\n\t\t\t\tif (feature.geometries || feature.geometry || feature.features || feature.coordinates) {\r\n\t\t\t\t\tthis.addData(features[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar options = this.options;\r\n\r\n\t\tif (options.filter && !options.filter(geojson)) { return; }\r\n\r\n\t\tvar layer = L.GeoJSON.geometryToLayer(geojson, options.pointToLayer, options.coordsToLatLng, options);\r\n\t\tlayer.feature = L.GeoJSON.asFeature(geojson);\r\n\r\n\t\tlayer.defaultOptions = layer.options;\r\n\t\tthis.resetStyle(layer);\r\n\r\n\t\tif (options.onEachFeature) {\r\n\t\t\toptions.onEachFeature(geojson, layer);\r\n\t\t}\r\n\r\n\t\treturn this.addLayer(layer);\r\n\t},\r\n\r\n\tresetStyle: function (layer) {\r\n\t\tvar style = this.options.style;\r\n\t\tif (style) {\r\n\t\t\t// reset any custom styles\r\n\t\t\tL.Util.extend(layer.options, layer.defaultOptions);\r\n\r\n\t\t\tthis._setLayerStyle(layer, style);\r\n\t\t}\r\n\t},\r\n\r\n\tsetStyle: function (style) {\r\n\t\tthis.eachLayer(function (layer) {\r\n\t\t\tthis._setLayerStyle(layer, style);\r\n\t\t}, this);\r\n\t},\r\n\r\n\t_setLayerStyle: function (layer, style) {\r\n\t\tif (typeof style === 'function') {\r\n\t\t\tstyle = style(layer.feature);\r\n\t\t}\r\n\t\tif (layer.setStyle) {\r\n\t\t\tlayer.setStyle(style);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nL.extend(L.GeoJSON, {\r\n\tgeometryToLayer: function (geojson, pointToLayer, coordsToLatLng, vectorOptions) {\r\n\t\tvar geometry = geojson.type === 'Feature' ? geojson.geometry : geojson,\r\n\t\t    coords = geometry.coordinates,\r\n\t\t    layers = [],\r\n\t\t    latlng, latlngs, i, len;\r\n\r\n\t\tcoordsToLatLng = coordsToLatLng || this.coordsToLatLng;\r\n\r\n\t\tswitch (geometry.type) {\r\n\t\tcase 'Point':\r\n\t\t\tlatlng = coordsToLatLng(coords);\r\n\t\t\treturn pointToLayer ? pointToLayer(geojson, latlng) : new L.Marker(latlng);\r\n\r\n\t\tcase 'MultiPoint':\r\n\t\t\tfor (i = 0, len = coords.length; i < len; i++) {\r\n\t\t\t\tlatlng = coordsToLatLng(coords[i]);\r\n\t\t\t\tlayers.push(pointToLayer ? pointToLayer(geojson, latlng) : new L.Marker(latlng));\r\n\t\t\t}\r\n\t\t\treturn new L.FeatureGroup(layers);\r\n\r\n\t\tcase 'LineString':\r\n\t\t\tlatlngs = this.coordsToLatLngs(coords, 0, coordsToLatLng);\r\n\t\t\treturn new L.Polyline(latlngs, vectorOptions);\r\n\r\n\t\tcase 'Polygon':\r\n\t\t\tif (coords.length === 2 && !coords[1].length) {\r\n\t\t\t\tthrow new Error('Invalid GeoJSON object.');\r\n\t\t\t}\r\n\t\t\tlatlngs = this.coordsToLatLngs(coords, 1, coordsToLatLng);\r\n\t\t\treturn new L.Polygon(latlngs, vectorOptions);\r\n\r\n\t\tcase 'MultiLineString':\r\n\t\t\tlatlngs = this.coordsToLatLngs(coords, 1, coordsToLatLng);\r\n\t\t\treturn new L.MultiPolyline(latlngs, vectorOptions);\r\n\r\n\t\tcase 'MultiPolygon':\r\n\t\t\tlatlngs = this.coordsToLatLngs(coords, 2, coordsToLatLng);\r\n\t\t\treturn new L.MultiPolygon(latlngs, vectorOptions);\r\n\r\n\t\tcase 'GeometryCollection':\r\n\t\t\tfor (i = 0, len = geometry.geometries.length; i < len; i++) {\r\n\r\n\t\t\t\tlayers.push(this.geometryToLayer({\r\n\t\t\t\t\tgeometry: geometry.geometries[i],\r\n\t\t\t\t\ttype: 'Feature',\r\n\t\t\t\t\tproperties: geojson.properties\r\n\t\t\t\t}, pointToLayer, coordsToLatLng, vectorOptions));\r\n\t\t\t}\r\n\t\t\treturn new L.FeatureGroup(layers);\r\n\r\n\t\tdefault:\r\n\t\t\tthrow new Error('Invalid GeoJSON object.');\r\n\t\t}\r\n\t},\r\n\r\n\tcoordsToLatLng: function (coords) { // (Array[, Boolean]) -> LatLng\r\n\t\treturn new L.LatLng(coords[1], coords[0], coords[2]);\r\n\t},\r\n\r\n\tcoordsToLatLngs: function (coords, levelsDeep, coordsToLatLng) { // (Array[, Number, Function]) -> Array\r\n\t\tvar latlng, i, len,\r\n\t\t    latlngs = [];\r\n\r\n\t\tfor (i = 0, len = coords.length; i < len; i++) {\r\n\t\t\tlatlng = levelsDeep ?\r\n\t\t\t        this.coordsToLatLngs(coords[i], levelsDeep - 1, coordsToLatLng) :\r\n\t\t\t        (coordsToLatLng || this.coordsToLatLng)(coords[i]);\r\n\r\n\t\t\tlatlngs.push(latlng);\r\n\t\t}\r\n\r\n\t\treturn latlngs;\r\n\t},\r\n\r\n\tlatLngToCoords: function (latlng) {\r\n\t\tvar coords = [latlng.lng, latlng.lat];\r\n\r\n\t\tif (latlng.alt !== undefined) {\r\n\t\t\tcoords.push(latlng.alt);\r\n\t\t}\r\n\t\treturn coords;\r\n\t},\r\n\r\n\tlatLngsToCoords: function (latLngs) {\r\n\t\tvar coords = [];\r\n\r\n\t\tfor (var i = 0, len = latLngs.length; i < len; i++) {\r\n\t\t\tcoords.push(L.GeoJSON.latLngToCoords(latLngs[i]));\r\n\t\t}\r\n\r\n\t\treturn coords;\r\n\t},\r\n\r\n\tgetFeature: function (layer, newGeometry) {\r\n\t\treturn layer.feature ? L.extend({}, layer.feature, {geometry: newGeometry}) : L.GeoJSON.asFeature(newGeometry);\r\n\t},\r\n\r\n\tasFeature: function (geoJSON) {\r\n\t\tif (geoJSON.type === 'Feature') {\r\n\t\t\treturn geoJSON;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\ttype: 'Feature',\r\n\t\t\tproperties: {},\r\n\t\t\tgeometry: geoJSON\r\n\t\t};\r\n\t}\r\n});\r\n\r\nvar PointToGeoJSON = {\r\n\ttoGeoJSON: function () {\r\n\t\treturn L.GeoJSON.getFeature(this, {\r\n\t\t\ttype: 'Point',\r\n\t\t\tcoordinates: L.GeoJSON.latLngToCoords(this.getLatLng())\r\n\t\t});\r\n\t}\r\n};\r\n\r\nL.Marker.include(PointToGeoJSON);\r\nL.Circle.include(PointToGeoJSON);\r\nL.CircleMarker.include(PointToGeoJSON);\r\n\r\nL.Polyline.include({\r\n\ttoGeoJSON: function () {\r\n\t\treturn L.GeoJSON.getFeature(this, {\r\n\t\t\ttype: 'LineString',\r\n\t\t\tcoordinates: L.GeoJSON.latLngsToCoords(this.getLatLngs())\r\n\t\t});\r\n\t}\r\n});\r\n\r\nL.Polygon.include({\r\n\ttoGeoJSON: function () {\r\n\t\tvar coords = [L.GeoJSON.latLngsToCoords(this.getLatLngs())],\r\n\t\t    i, len, hole;\r\n\r\n\t\tcoords[0].push(coords[0][0]);\r\n\r\n\t\tif (this._holes) {\r\n\t\t\tfor (i = 0, len = this._holes.length; i < len; i++) {\r\n\t\t\t\thole = L.GeoJSON.latLngsToCoords(this._holes[i]);\r\n\t\t\t\thole.push(hole[0]);\r\n\t\t\t\tcoords.push(hole);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn L.GeoJSON.getFeature(this, {\r\n\t\t\ttype: 'Polygon',\r\n\t\t\tcoordinates: coords\r\n\t\t});\r\n\t}\r\n});\r\n\r\n(function () {\r\n\tfunction multiToGeoJSON(type) {\r\n\t\treturn function () {\r\n\t\t\tvar coords = [];\r\n\r\n\t\t\tthis.eachLayer(function (layer) {\r\n\t\t\t\tcoords.push(layer.toGeoJSON().geometry.coordinates);\r\n\t\t\t});\r\n\r\n\t\t\treturn L.GeoJSON.getFeature(this, {\r\n\t\t\t\ttype: type,\r\n\t\t\t\tcoordinates: coords\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\r\n\tL.MultiPolyline.include({toGeoJSON: multiToGeoJSON('MultiLineString')});\r\n\tL.MultiPolygon.include({toGeoJSON: multiToGeoJSON('MultiPolygon')});\r\n\r\n\tL.LayerGroup.include({\r\n\t\ttoGeoJSON: function () {\r\n\r\n\t\t\tvar geometry = this.feature && this.feature.geometry,\r\n\t\t\t\tjsons = [],\r\n\t\t\t\tjson;\r\n\r\n\t\t\tif (geometry && geometry.type === 'MultiPoint') {\r\n\t\t\t\treturn multiToGeoJSON('MultiPoint').call(this);\r\n\t\t\t}\r\n\r\n\t\t\tvar isGeometryCollection = geometry && geometry.type === 'GeometryCollection';\r\n\r\n\t\t\tthis.eachLayer(function (layer) {\r\n\t\t\t\tif (layer.toGeoJSON) {\r\n\t\t\t\t\tjson = layer.toGeoJSON();\r\n\t\t\t\t\tjsons.push(isGeometryCollection ? json.geometry : L.GeoJSON.asFeature(json));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif (isGeometryCollection) {\r\n\t\t\t\treturn L.GeoJSON.getFeature(this, {\r\n\t\t\t\t\tgeometries: jsons,\r\n\t\t\t\t\ttype: 'GeometryCollection'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\ttype: 'FeatureCollection',\r\n\t\t\t\tfeatures: jsons\r\n\t\t\t};\r\n\t\t}\r\n\t});\r\n}());\r\n\r\nL.geoJson = function (geojson, options) {\r\n\treturn new L.GeoJSON(geojson, options);\r\n};\r\n\n\n/*\r\n * L.DomEvent contains functions for working with DOM events.\r\n */\r\n\r\nL.DomEvent = {\r\n\t/* inspired by John Resig, Dean Edwards and YUI addEvent implementations */\r\n\taddListener: function (obj, type, fn, context) { // (HTMLElement, String, Function[, Object])\r\n\r\n\t\tvar id = L.stamp(fn),\r\n\t\t    key = '_leaflet_' + type + id,\r\n\t\t    handler, originalHandler, newType;\r\n\r\n\t\tif (obj[key]) { return this; }\r\n\r\n\t\thandler = function (e) {\r\n\t\t\treturn fn.call(context || obj, e || L.DomEvent._getEvent());\r\n\t\t};\r\n\r\n\t\tif (L.Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\t\treturn this.addPointerListener(obj, type, handler, id);\r\n\t\t}\r\n\t\tif (L.Browser.touch && (type === 'dblclick') && this.addDoubleTapListener) {\r\n\t\t\tthis.addDoubleTapListener(obj, handler, id);\r\n\t\t}\r\n\r\n\t\tif ('addEventListener' in obj) {\r\n\r\n\t\t\tif (type === 'mousewheel') {\r\n\t\t\t\tobj.addEventListener('DOMMouseScroll', handler, false);\r\n\t\t\t\tobj.addEventListener(type, handler, false);\r\n\r\n\t\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\r\n\r\n\t\t\t\toriginalHandler = handler;\r\n\t\t\t\tnewType = (type === 'mouseenter' ? 'mouseover' : 'mouseout');\r\n\r\n\t\t\t\thandler = function (e) {\r\n\t\t\t\t\tif (!L.DomEvent._checkMouse(obj, e)) { return; }\r\n\t\t\t\t\treturn originalHandler(e);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tobj.addEventListener(newType, handler, false);\r\n\r\n\t\t\t} else if (type === 'click' && L.Browser.android) {\r\n\t\t\t\toriginalHandler = handler;\r\n\t\t\t\thandler = function (e) {\r\n\t\t\t\t\treturn L.DomEvent._filterClick(e, originalHandler);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tobj.addEventListener(type, handler, false);\r\n\t\t\t} else {\r\n\t\t\t\tobj.addEventListener(type, handler, false);\r\n\t\t\t}\r\n\r\n\t\t} else if ('attachEvent' in obj) {\r\n\t\t\tobj.attachEvent('on' + type, handler);\r\n\t\t}\r\n\r\n\t\tobj[key] = handler;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tremoveListener: function (obj, type, fn) {  // (HTMLElement, String, Function)\r\n\r\n\t\tvar id = L.stamp(fn),\r\n\t\t    key = '_leaflet_' + type + id,\r\n\t\t    handler = obj[key];\r\n\r\n\t\tif (!handler) { return this; }\r\n\r\n\t\tif (L.Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\t\tthis.removePointerListener(obj, type, id);\r\n\t\t} else if (L.Browser.touch && (type === 'dblclick') && this.removeDoubleTapListener) {\r\n\t\t\tthis.removeDoubleTapListener(obj, id);\r\n\r\n\t\t} else if ('removeEventListener' in obj) {\r\n\r\n\t\t\tif (type === 'mousewheel') {\r\n\t\t\t\tobj.removeEventListener('DOMMouseScroll', handler, false);\r\n\t\t\t\tobj.removeEventListener(type, handler, false);\r\n\r\n\t\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\r\n\t\t\t\tobj.removeEventListener((type === 'mouseenter' ? 'mouseover' : 'mouseout'), handler, false);\r\n\t\t\t} else {\r\n\t\t\t\tobj.removeEventListener(type, handler, false);\r\n\t\t\t}\r\n\t\t} else if ('detachEvent' in obj) {\r\n\t\t\tobj.detachEvent('on' + type, handler);\r\n\t\t}\r\n\r\n\t\tobj[key] = null;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tstopPropagation: function (e) {\r\n\r\n\t\tif (e.stopPropagation) {\r\n\t\t\te.stopPropagation();\r\n\t\t} else {\r\n\t\t\te.cancelBubble = true;\r\n\t\t}\r\n\t\tL.DomEvent._skipped(e);\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tdisableScrollPropagation: function (el) {\r\n\t\tvar stop = L.DomEvent.stopPropagation;\r\n\r\n\t\treturn L.DomEvent\r\n\t\t\t.on(el, 'mousewheel', stop)\r\n\t\t\t.on(el, 'MozMousePixelScroll', stop);\r\n\t},\r\n\r\n\tdisableClickPropagation: function (el) {\r\n\t\tvar stop = L.DomEvent.stopPropagation;\r\n\r\n\t\tfor (var i = L.Draggable.START.length - 1; i >= 0; i--) {\r\n\t\t\tL.DomEvent.on(el, L.Draggable.START[i], stop);\r\n\t\t}\r\n\r\n\t\treturn L.DomEvent\r\n\t\t\t.on(el, 'click', L.DomEvent._fakeStop)\r\n\t\t\t.on(el, 'dblclick', stop);\r\n\t},\r\n\r\n\tpreventDefault: function (e) {\r\n\r\n\t\tif (e.preventDefault) {\r\n\t\t\te.preventDefault();\r\n\t\t} else {\r\n\t\t\te.returnValue = false;\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tstop: function (e) {\r\n\t\treturn L.DomEvent\r\n\t\t\t.preventDefault(e)\r\n\t\t\t.stopPropagation(e);\r\n\t},\r\n\r\n\tgetMousePosition: function (e, container) {\r\n\t\tif (!container) {\r\n\t\t\treturn new L.Point(e.clientX, e.clientY);\r\n\t\t}\r\n\r\n\t\tvar rect = container.getBoundingClientRect();\r\n\r\n\t\treturn new L.Point(\r\n\t\t\te.clientX - rect.left - container.clientLeft,\r\n\t\t\te.clientY - rect.top - container.clientTop);\r\n\t},\r\n\r\n\tgetWheelDelta: function (e) {\r\n\r\n\t\tvar delta = 0;\r\n\r\n\t\tif (e.wheelDelta) {\r\n\t\t\tdelta = e.wheelDelta / 120;\r\n\t\t}\r\n\t\tif (e.detail) {\r\n\t\t\tdelta = -e.detail / 3;\r\n\t\t}\r\n\t\treturn delta;\r\n\t},\r\n\r\n\t_skipEvents: {},\r\n\r\n\t_fakeStop: function (e) {\r\n\t\t// fakes stopPropagation by setting a special event flag, checked/reset with L.DomEvent._skipped(e)\r\n\t\tL.DomEvent._skipEvents[e.type] = true;\r\n\t},\r\n\r\n\t_skipped: function (e) {\r\n\t\tvar skipped = this._skipEvents[e.type];\r\n\t\t// reset when checking, as it's only used in map container and propagates outside of the map\r\n\t\tthis._skipEvents[e.type] = false;\r\n\t\treturn skipped;\r\n\t},\r\n\r\n\t// check if element really left/entered the event target (for mouseenter/mouseleave)\r\n\t_checkMouse: function (el, e) {\r\n\r\n\t\tvar related = e.relatedTarget;\r\n\r\n\t\tif (!related) { return true; }\r\n\r\n\t\ttry {\r\n\t\t\twhile (related && (related !== el)) {\r\n\t\t\t\trelated = related.parentNode;\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn (related !== el);\r\n\t},\r\n\r\n\t_getEvent: function () { // evil magic for IE\r\n\t\t/*jshint noarg:false */\r\n\t\tvar e = window.event;\r\n\t\tif (!e) {\r\n\t\t\tvar caller = arguments.callee.caller;\r\n\t\t\twhile (caller) {\r\n\t\t\t\te = caller['arguments'][0];\r\n\t\t\t\tif (e && window.Event === e.constructor) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcaller = caller.caller;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn e;\r\n\t},\r\n\r\n\t// this is a horrible workaround for a bug in Android where a single touch triggers two click events\r\n\t_filterClick: function (e, handler) {\r\n\t\tvar timeStamp = (e.timeStamp || e.originalEvent.timeStamp),\r\n\t\t\telapsed = L.DomEvent._lastClick && (timeStamp - L.DomEvent._lastClick);\r\n\r\n\t\t// are they closer together than 500ms yet more than 100ms?\r\n\t\t// Android typically triggers them ~300ms apart while multiple listeners\r\n\t\t// on the same event should be triggered far faster;\r\n\t\t// or check if click is simulated on the element, and if it is, reject any non-simulated events\r\n\r\n\t\tif ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {\r\n\t\t\tL.DomEvent.stop(e);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tL.DomEvent._lastClick = timeStamp;\r\n\r\n\t\treturn handler(e);\r\n\t}\r\n};\r\n\r\nL.DomEvent.on = L.DomEvent.addListener;\r\nL.DomEvent.off = L.DomEvent.removeListener;\r\n\n\n/*\r\n * L.Draggable allows you to add dragging capabilities to any element. Supports mobile devices too.\r\n */\r\n\r\nL.Draggable = L.Class.extend({\r\n\tincludes: L.Mixin.Events,\r\n\r\n\tstatics: {\r\n\t\tSTART: L.Browser.touch ? ['touchstart', 'mousedown'] : ['mousedown'],\r\n\t\tEND: {\r\n\t\t\tmousedown: 'mouseup',\r\n\t\t\ttouchstart: 'touchend',\r\n\t\t\tpointerdown: 'touchend',\r\n\t\t\tMSPointerDown: 'touchend'\r\n\t\t},\r\n\t\tMOVE: {\r\n\t\t\tmousedown: 'mousemove',\r\n\t\t\ttouchstart: 'touchmove',\r\n\t\t\tpointerdown: 'touchmove',\r\n\t\t\tMSPointerDown: 'touchmove'\r\n\t\t}\r\n\t},\r\n\r\n\tinitialize: function (element, dragStartTarget) {\r\n\t\tthis._element = element;\r\n\t\tthis._dragStartTarget = dragStartTarget || element;\r\n\t},\r\n\r\n\tenable: function () {\r\n\t\tif (this._enabled) { return; }\r\n\r\n\t\tfor (var i = L.Draggable.START.length - 1; i >= 0; i--) {\r\n\t\t\tL.DomEvent.on(this._dragStartTarget, L.Draggable.START[i], this._onDown, this);\r\n\t\t}\r\n\r\n\t\tthis._enabled = true;\r\n\t},\r\n\r\n\tdisable: function () {\r\n\t\tif (!this._enabled) { return; }\r\n\r\n\t\tfor (var i = L.Draggable.START.length - 1; i >= 0; i--) {\r\n\t\t\tL.DomEvent.off(this._dragStartTarget, L.Draggable.START[i], this._onDown, this);\r\n\t\t}\r\n\r\n\t\tthis._enabled = false;\r\n\t\tthis._moved = false;\r\n\t},\r\n\r\n\t_onDown: function (e) {\r\n\t\tthis._moved = false;\r\n\r\n\t\tif (e.shiftKey || ((e.which !== 1) && (e.button !== 1) && !e.touches)) { return; }\r\n\r\n\t\tL.DomEvent.stopPropagation(e);\r\n\r\n\t\tif (L.Draggable._disabled) { return; }\r\n\r\n\t\tL.DomUtil.disableImageDrag();\r\n\t\tL.DomUtil.disableTextSelection();\r\n\r\n\t\tif (this._moving) { return; }\r\n\r\n\t\tvar first = e.touches ? e.touches[0] : e;\r\n\r\n\t\tthis._startPoint = new L.Point(first.clientX, first.clientY);\r\n\t\tthis._startPos = this._newPos = L.DomUtil.getPosition(this._element);\r\n\r\n\t\tL.DomEvent\r\n\t\t    .on(document, L.Draggable.MOVE[e.type], this._onMove, this)\r\n\t\t    .on(document, L.Draggable.END[e.type], this._onUp, this);\r\n\t},\r\n\r\n\t_onMove: function (e) {\r\n\t\tif (e.touches && e.touches.length > 1) {\r\n\t\t\tthis._moved = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar first = (e.touches && e.touches.length === 1 ? e.touches[0] : e),\r\n\t\t    newPoint = new L.Point(first.clientX, first.clientY),\r\n\t\t    offset = newPoint.subtract(this._startPoint);\r\n\r\n\t\tif (!offset.x && !offset.y) { return; }\r\n\t\tif (L.Browser.touch && Math.abs(offset.x) + Math.abs(offset.y) < 3) { return; }\r\n\r\n\t\tL.DomEvent.preventDefault(e);\r\n\r\n\t\tif (!this._moved) {\r\n\t\t\tthis.fire('dragstart');\r\n\r\n\t\t\tthis._moved = true;\r\n\t\t\tthis._startPos = L.DomUtil.getPosition(this._element).subtract(offset);\r\n\r\n\t\t\tL.DomUtil.addClass(document.body, 'leaflet-dragging');\r\n\t\t\tthis._lastTarget = e.target || e.srcElement;\r\n\t\t\tL.DomUtil.addClass(this._lastTarget, 'leaflet-drag-target');\r\n\t\t}\r\n\r\n\t\tthis._newPos = this._startPos.add(offset);\r\n\t\tthis._moving = true;\r\n\r\n\t\tL.Util.cancelAnimFrame(this._animRequest);\r\n\t\tthis._animRequest = L.Util.requestAnimFrame(this._updatePosition, this, true, this._dragStartTarget);\r\n\t},\r\n\r\n\t_updatePosition: function () {\r\n\t\tthis.fire('predrag');\r\n\t\tL.DomUtil.setPosition(this._element, this._newPos);\r\n\t\tthis.fire('drag');\r\n\t},\r\n\r\n\t_onUp: function () {\r\n\t\tL.DomUtil.removeClass(document.body, 'leaflet-dragging');\r\n\r\n\t\tif (this._lastTarget) {\r\n\t\t\tL.DomUtil.removeClass(this._lastTarget, 'leaflet-drag-target');\r\n\t\t\tthis._lastTarget = null;\r\n\t\t}\r\n\r\n\t\tfor (var i in L.Draggable.MOVE) {\r\n\t\t\tL.DomEvent\r\n\t\t\t    .off(document, L.Draggable.MOVE[i], this._onMove)\r\n\t\t\t    .off(document, L.Draggable.END[i], this._onUp);\r\n\t\t}\r\n\r\n\t\tL.DomUtil.enableImageDrag();\r\n\t\tL.DomUtil.enableTextSelection();\r\n\r\n\t\tif (this._moved && this._moving) {\r\n\t\t\t// ensure drag is not fired after dragend\r\n\t\t\tL.Util.cancelAnimFrame(this._animRequest);\r\n\r\n\t\t\tthis.fire('dragend', {\r\n\t\t\t\tdistance: this._newPos.distanceTo(this._startPos)\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis._moving = false;\r\n\t}\r\n});\r\n\n\n/*\n\tL.Handler is a base class for handler classes that are used internally to inject\n\tinteraction features like dragging to classes like Map and Marker.\n*/\n\nL.Handler = L.Class.extend({\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\t},\n\n\tenable: function () {\n\t\tif (this._enabled) { return; }\n\n\t\tthis._enabled = true;\n\t\tthis.addHooks();\n\t},\n\n\tdisable: function () {\n\t\tif (!this._enabled) { return; }\n\n\t\tthis._enabled = false;\n\t\tthis.removeHooks();\n\t},\n\n\tenabled: function () {\n\t\treturn !!this._enabled;\n\t}\n});\n\n\n/*\n * L.Handler.MapDrag is used to make the map draggable (with panning inertia), enabled by default.\n */\n\nL.Map.mergeOptions({\n\tdragging: true,\n\n\tinertia: !L.Browser.android23,\n\tinertiaDeceleration: 3400, // px/s^2\n\tinertiaMaxSpeed: Infinity, // px/s\n\tinertiaThreshold: L.Browser.touch ? 32 : 18, // ms\n\teaseLinearity: 0.25,\n\n\t// TODO refactor, move to CRS\n\tworldCopyJump: false\n});\n\nL.Map.Drag = L.Handler.extend({\n\taddHooks: function () {\n\t\tif (!this._draggable) {\n\t\t\tvar map = this._map;\n\n\t\t\tthis._draggable = new L.Draggable(map._mapPane, map._container);\n\n\t\t\tthis._draggable.on({\n\t\t\t\t'dragstart': this._onDragStart,\n\t\t\t\t'drag': this._onDrag,\n\t\t\t\t'dragend': this._onDragEnd\n\t\t\t}, this);\n\n\t\t\tif (map.options.worldCopyJump) {\n\t\t\t\tthis._draggable.on('predrag', this._onPreDrag, this);\n\t\t\t\tmap.on('viewreset', this._onViewReset, this);\n\n\t\t\t\tmap.whenReady(this._onViewReset, this);\n\t\t\t}\n\t\t}\n\t\tthis._draggable.enable();\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._draggable.disable();\n\t},\n\n\tmoved: function () {\n\t\treturn this._draggable && this._draggable._moved;\n\t},\n\n\t_onDragStart: function () {\n\t\tvar map = this._map;\n\n\t\tif (map._panAnim) {\n\t\t\tmap._panAnim.stop();\n\t\t}\n\n\t\tmap\n\t\t    .fire('movestart')\n\t\t    .fire('dragstart');\n\n\t\tif (map.options.inertia) {\n\t\t\tthis._positions = [];\n\t\t\tthis._times = [];\n\t\t}\n\t},\n\n\t_onDrag: function () {\n\t\tif (this._map.options.inertia) {\n\t\t\tvar time = this._lastTime = +new Date(),\n\t\t\t    pos = this._lastPos = this._draggable._newPos;\n\n\t\t\tthis._positions.push(pos);\n\t\t\tthis._times.push(time);\n\n\t\t\tif (time - this._times[0] > 200) {\n\t\t\t\tthis._positions.shift();\n\t\t\t\tthis._times.shift();\n\t\t\t}\n\t\t}\n\n\t\tthis._map\n\t\t    .fire('move')\n\t\t    .fire('drag');\n\t},\n\n\t_onViewReset: function () {\n\t\t// TODO fix hardcoded Earth values\n\t\tvar pxCenter = this._map.getSize()._divideBy(2),\n\t\t    pxWorldCenter = this._map.latLngToLayerPoint([0, 0]);\n\n\t\tthis._initialWorldOffset = pxWorldCenter.subtract(pxCenter).x;\n\t\tthis._worldWidth = this._map.project([0, 180]).x;\n\t},\n\n\t_onPreDrag: function () {\n\t\t// TODO refactor to be able to adjust map pane position after zoom\n\t\tvar worldWidth = this._worldWidth,\n\t\t    halfWidth = Math.round(worldWidth / 2),\n\t\t    dx = this._initialWorldOffset,\n\t\t    x = this._draggable._newPos.x,\n\t\t    newX1 = (x - halfWidth + dx) % worldWidth + halfWidth - dx,\n\t\t    newX2 = (x + halfWidth + dx) % worldWidth - halfWidth - dx,\n\t\t    newX = Math.abs(newX1 + dx) < Math.abs(newX2 + dx) ? newX1 : newX2;\n\n\t\tthis._draggable._newPos.x = newX;\n\t},\n\n\t_onDragEnd: function (e) {\n\t\tvar map = this._map,\n\t\t    options = map.options,\n\t\t    delay = +new Date() - this._lastTime,\n\n\t\t    noInertia = !options.inertia || delay > options.inertiaThreshold || !this._positions[0];\n\n\t\tmap.fire('dragend', e);\n\n\t\tif (noInertia) {\n\t\t\tmap.fire('moveend');\n\n\t\t} else {\n\n\t\t\tvar direction = this._lastPos.subtract(this._positions[0]),\n\t\t\t    duration = (this._lastTime + delay - this._times[0]) / 1000,\n\t\t\t    ease = options.easeLinearity,\n\n\t\t\t    speedVector = direction.multiplyBy(ease / duration),\n\t\t\t    speed = speedVector.distanceTo([0, 0]),\n\n\t\t\t    limitedSpeed = Math.min(options.inertiaMaxSpeed, speed),\n\t\t\t    limitedSpeedVector = speedVector.multiplyBy(limitedSpeed / speed),\n\n\t\t\t    decelerationDuration = limitedSpeed / (options.inertiaDeceleration * ease),\n\t\t\t    offset = limitedSpeedVector.multiplyBy(-decelerationDuration / 2).round();\n\n\t\t\tif (!offset.x || !offset.y) {\n\t\t\t\tmap.fire('moveend');\n\n\t\t\t} else {\n\t\t\t\toffset = map._limitOffset(offset, map.options.maxBounds);\n\n\t\t\t\tL.Util.requestAnimFrame(function () {\n\t\t\t\t\tmap.panBy(offset, {\n\t\t\t\t\t\tduration: decelerationDuration,\n\t\t\t\t\t\teaseLinearity: ease,\n\t\t\t\t\t\tnoMoveStart: true\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'dragging', L.Map.Drag);\n\n\n/*\n * L.Handler.DoubleClickZoom is used to handle double-click zoom on the map, enabled by default.\n */\n\nL.Map.mergeOptions({\n\tdoubleClickZoom: true\n});\n\nL.Map.DoubleClickZoom = L.Handler.extend({\n\taddHooks: function () {\n\t\tthis._map.on('dblclick', this._onDoubleClick, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._map.off('dblclick', this._onDoubleClick, this);\n\t},\n\n\t_onDoubleClick: function (e) {\n\t\tvar map = this._map,\n\t\t    zoom = map.getZoom() + (e.originalEvent.shiftKey ? -1 : 1);\n\n\t\tif (map.options.doubleClickZoom === 'center') {\n\t\t\tmap.setZoom(zoom);\n\t\t} else {\n\t\t\tmap.setZoomAround(e.containerPoint, zoom);\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'doubleClickZoom', L.Map.DoubleClickZoom);\n\n\n/*\n * L.Handler.ScrollWheelZoom is used by L.Map to enable mouse scroll wheel zoom on the map.\n */\n\nL.Map.mergeOptions({\n\tscrollWheelZoom: true\n});\n\nL.Map.ScrollWheelZoom = L.Handler.extend({\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._map._container, 'mousewheel', this._onWheelScroll, this);\n\t\tL.DomEvent.on(this._map._container, 'MozMousePixelScroll', L.DomEvent.preventDefault);\n\t\tthis._delta = 0;\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._map._container, 'mousewheel', this._onWheelScroll);\n\t\tL.DomEvent.off(this._map._container, 'MozMousePixelScroll', L.DomEvent.preventDefault);\n\t},\n\n\t_onWheelScroll: function (e) {\n\t\tvar delta = L.DomEvent.getWheelDelta(e);\n\n\t\tthis._delta += delta;\n\t\tthis._lastMousePos = this._map.mouseEventToContainerPoint(e);\n\n\t\tif (!this._startTime) {\n\t\t\tthis._startTime = +new Date();\n\t\t}\n\n\t\tvar left = Math.max(40 - (+new Date() - this._startTime), 0);\n\n\t\tclearTimeout(this._timer);\n\t\tthis._timer = setTimeout(L.bind(this._performZoom, this), left);\n\n\t\tL.DomEvent.preventDefault(e);\n\t\tL.DomEvent.stopPropagation(e);\n\t},\n\n\t_performZoom: function () {\n\t\tvar map = this._map,\n\t\t    delta = this._delta,\n\t\t    zoom = map.getZoom();\n\n\t\tdelta = delta > 0 ? Math.ceil(delta) : Math.floor(delta);\n\t\tdelta = Math.max(Math.min(delta, 4), -4);\n\t\tdelta = map._limitZoom(zoom + delta) - zoom;\n\n\t\tthis._delta = 0;\n\t\tthis._startTime = null;\n\n\t\tif (!delta) { return; }\n\n\t\tif (map.options.scrollWheelZoom === 'center') {\n\t\t\tmap.setZoom(zoom + delta);\n\t\t} else {\n\t\t\tmap.setZoomAround(this._lastMousePos, zoom + delta);\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'scrollWheelZoom', L.Map.ScrollWheelZoom);\n\n\n/*\r\n * Extends the event handling code with double tap support for mobile browsers.\r\n */\r\n\r\nL.extend(L.DomEvent, {\r\n\r\n\t_touchstart: L.Browser.msPointer ? 'MSPointerDown' : L.Browser.pointer ? 'pointerdown' : 'touchstart',\r\n\t_touchend: L.Browser.msPointer ? 'MSPointerUp' : L.Browser.pointer ? 'pointerup' : 'touchend',\r\n\r\n\t// inspired by Zepto touch code by Thomas Fuchs\r\n\taddDoubleTapListener: function (obj, handler, id) {\r\n\t\tvar last,\r\n\t\t    doubleTap = false,\r\n\t\t    delay = 250,\r\n\t\t    touch,\r\n\t\t    pre = '_leaflet_',\r\n\t\t    touchstart = this._touchstart,\r\n\t\t    touchend = this._touchend,\r\n\t\t    trackedTouches = [];\r\n\r\n\t\tfunction onTouchStart(e) {\r\n\t\t\tvar count;\r\n\r\n\t\t\tif (L.Browser.pointer) {\r\n\t\t\t\ttrackedTouches.push(e.pointerId);\r\n\t\t\t\tcount = trackedTouches.length;\r\n\t\t\t} else {\r\n\t\t\t\tcount = e.touches.length;\r\n\t\t\t}\r\n\t\t\tif (count > 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar now = Date.now(),\r\n\t\t\t\tdelta = now - (last || now);\r\n\r\n\t\t\ttouch = e.touches ? e.touches[0] : e;\r\n\t\t\tdoubleTap = (delta > 0 && delta <= delay);\r\n\t\t\tlast = now;\r\n\t\t}\r\n\r\n\t\tfunction onTouchEnd(e) {\r\n\t\t\tif (L.Browser.pointer) {\r\n\t\t\t\tvar idx = trackedTouches.indexOf(e.pointerId);\r\n\t\t\t\tif (idx === -1) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\ttrackedTouches.splice(idx, 1);\r\n\t\t\t}\r\n\r\n\t\t\tif (doubleTap) {\r\n\t\t\t\tif (L.Browser.pointer) {\r\n\t\t\t\t\t// work around .type being readonly with MSPointer* events\r\n\t\t\t\t\tvar newTouch = { },\r\n\t\t\t\t\t\tprop;\r\n\r\n\t\t\t\t\t// jshint forin:false\r\n\t\t\t\t\tfor (var i in touch) {\r\n\t\t\t\t\t\tprop = touch[i];\r\n\t\t\t\t\t\tif (typeof prop === 'function') {\r\n\t\t\t\t\t\t\tnewTouch[i] = prop.bind(touch);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnewTouch[i] = prop;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttouch = newTouch;\r\n\t\t\t\t}\r\n\t\t\t\ttouch.type = 'dblclick';\r\n\t\t\t\thandler(touch);\r\n\t\t\t\tlast = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tobj[pre + touchstart + id] = onTouchStart;\r\n\t\tobj[pre + touchend + id] = onTouchEnd;\r\n\r\n\t\t// on pointer we need to listen on the document, otherwise a drag starting on the map and moving off screen\r\n\t\t// will not come through to us, so we will lose track of how many touches are ongoing\r\n\t\tvar endElement = L.Browser.pointer ? document.documentElement : obj;\r\n\r\n\t\tobj.addEventListener(touchstart, onTouchStart, false);\r\n\t\tendElement.addEventListener(touchend, onTouchEnd, false);\r\n\r\n\t\tif (L.Browser.pointer) {\r\n\t\t\tendElement.addEventListener(L.DomEvent.POINTER_CANCEL, onTouchEnd, false);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tremoveDoubleTapListener: function (obj, id) {\r\n\t\tvar pre = '_leaflet_';\r\n\r\n\t\tobj.removeEventListener(this._touchstart, obj[pre + this._touchstart + id], false);\r\n\t\t(L.Browser.pointer ? document.documentElement : obj).removeEventListener(\r\n\t\t        this._touchend, obj[pre + this._touchend + id], false);\r\n\r\n\t\tif (L.Browser.pointer) {\r\n\t\t\tdocument.documentElement.removeEventListener(L.DomEvent.POINTER_CANCEL, obj[pre + this._touchend + id],\r\n\t\t\t\tfalse);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n});\r\n\n\n/*\n * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.\n */\n\nL.extend(L.DomEvent, {\n\n\t//static\n\tPOINTER_DOWN: L.Browser.msPointer ? 'MSPointerDown' : 'pointerdown',\n\tPOINTER_MOVE: L.Browser.msPointer ? 'MSPointerMove' : 'pointermove',\n\tPOINTER_UP: L.Browser.msPointer ? 'MSPointerUp' : 'pointerup',\n\tPOINTER_CANCEL: L.Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',\n\n\t_pointers: [],\n\t_pointerDocumentListener: false,\n\n\t// Provides a touch events wrapper for (ms)pointer events.\n\t// Based on changes by veproza https://github.com/CloudMade/Leaflet/pull/1019\n\t//ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890\n\n\taddPointerListener: function (obj, type, handler, id) {\n\n\t\tswitch (type) {\n\t\tcase 'touchstart':\n\t\t\treturn this.addPointerListenerStart(obj, type, handler, id);\n\t\tcase 'touchend':\n\t\t\treturn this.addPointerListenerEnd(obj, type, handler, id);\n\t\tcase 'touchmove':\n\t\t\treturn this.addPointerListenerMove(obj, type, handler, id);\n\t\tdefault:\n\t\t\tthrow 'Unknown touch event type';\n\t\t}\n\t},\n\n\taddPointerListenerStart: function (obj, type, handler, id) {\n\t\tvar pre = '_leaflet_',\n\t\t    pointers = this._pointers;\n\n\t\tvar cb = function (e) {\n\t\t\tif (e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {\n\t\t\t\tL.DomEvent.preventDefault(e);\n\t\t\t}\n\n\t\t\tvar alreadyInArray = false;\n\t\t\tfor (var i = 0; i < pointers.length; i++) {\n\t\t\t\tif (pointers[i].pointerId === e.pointerId) {\n\t\t\t\t\talreadyInArray = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!alreadyInArray) {\n\t\t\t\tpointers.push(e);\n\t\t\t}\n\n\t\t\te.touches = pointers.slice();\n\t\t\te.changedTouches = [e];\n\n\t\t\thandler(e);\n\t\t};\n\n\t\tobj[pre + 'touchstart' + id] = cb;\n\t\tobj.addEventListener(this.POINTER_DOWN, cb, false);\n\n\t\t// need to also listen for end events to keep the _pointers list accurate\n\t\t// this needs to be on the body and never go away\n\t\tif (!this._pointerDocumentListener) {\n\t\t\tvar internalCb = function (e) {\n\t\t\t\tfor (var i = 0; i < pointers.length; i++) {\n\t\t\t\t\tif (pointers[i].pointerId === e.pointerId) {\n\t\t\t\t\t\tpointers.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\t//We listen on the documentElement as any drags that end by moving the touch off the screen get fired there\n\t\t\tdocument.documentElement.addEventListener(this.POINTER_UP, internalCb, false);\n\t\t\tdocument.documentElement.addEventListener(this.POINTER_CANCEL, internalCb, false);\n\n\t\t\tthis._pointerDocumentListener = true;\n\t\t}\n\n\t\treturn this;\n\t},\n\n\taddPointerListenerMove: function (obj, type, handler, id) {\n\t\tvar pre = '_leaflet_',\n\t\t    touches = this._pointers;\n\n\t\tfunction cb(e) {\n\n\t\t\t// don't fire touch moves when mouse isn't down\n\t\t\tif ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }\n\n\t\t\tfor (var i = 0; i < touches.length; i++) {\n\t\t\t\tif (touches[i].pointerId === e.pointerId) {\n\t\t\t\t\ttouches[i] = e;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\te.touches = touches.slice();\n\t\t\te.changedTouches = [e];\n\n\t\t\thandler(e);\n\t\t}\n\n\t\tobj[pre + 'touchmove' + id] = cb;\n\t\tobj.addEventListener(this.POINTER_MOVE, cb, false);\n\n\t\treturn this;\n\t},\n\n\taddPointerListenerEnd: function (obj, type, handler, id) {\n\t\tvar pre = '_leaflet_',\n\t\t    touches = this._pointers;\n\n\t\tvar cb = function (e) {\n\t\t\tfor (var i = 0; i < touches.length; i++) {\n\t\t\t\tif (touches[i].pointerId === e.pointerId) {\n\t\t\t\t\ttouches.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\te.touches = touches.slice();\n\t\t\te.changedTouches = [e];\n\n\t\t\thandler(e);\n\t\t};\n\n\t\tobj[pre + 'touchend' + id] = cb;\n\t\tobj.addEventListener(this.POINTER_UP, cb, false);\n\t\tobj.addEventListener(this.POINTER_CANCEL, cb, false);\n\n\t\treturn this;\n\t},\n\n\tremovePointerListener: function (obj, type, id) {\n\t\tvar pre = '_leaflet_',\n\t\t    cb = obj[pre + type + id];\n\n\t\tswitch (type) {\n\t\tcase 'touchstart':\n\t\t\tobj.removeEventListener(this.POINTER_DOWN, cb, false);\n\t\t\tbreak;\n\t\tcase 'touchmove':\n\t\t\tobj.removeEventListener(this.POINTER_MOVE, cb, false);\n\t\t\tbreak;\n\t\tcase 'touchend':\n\t\t\tobj.removeEventListener(this.POINTER_UP, cb, false);\n\t\t\tobj.removeEventListener(this.POINTER_CANCEL, cb, false);\n\t\t\tbreak;\n\t\t}\n\n\t\treturn this;\n\t}\n});\n\n\n/*\n * L.Handler.TouchZoom is used by L.Map to add pinch zoom on supported mobile browsers.\n */\n\nL.Map.mergeOptions({\n\ttouchZoom: L.Browser.touch && !L.Browser.android23,\n\tbounceAtZoomLimits: true\n});\n\nL.Map.TouchZoom = L.Handler.extend({\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._map._container, 'touchstart', this._onTouchStart, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._map._container, 'touchstart', this._onTouchStart, this);\n\t},\n\n\t_onTouchStart: function (e) {\n\t\tvar map = this._map;\n\n\t\tif (!e.touches || e.touches.length !== 2 || map._animatingZoom || this._zooming) { return; }\n\n\t\tvar p1 = map.mouseEventToLayerPoint(e.touches[0]),\n\t\t    p2 = map.mouseEventToLayerPoint(e.touches[1]),\n\t\t    viewCenter = map._getCenterLayerPoint();\n\n\t\tthis._startCenter = p1.add(p2)._divideBy(2);\n\t\tthis._startDist = p1.distanceTo(p2);\n\n\t\tthis._moved = false;\n\t\tthis._zooming = true;\n\n\t\tthis._centerOffset = viewCenter.subtract(this._startCenter);\n\n\t\tif (map._panAnim) {\n\t\t\tmap._panAnim.stop();\n\t\t}\n\n\t\tL.DomEvent\n\t\t    .on(document, 'touchmove', this._onTouchMove, this)\n\t\t    .on(document, 'touchend', this._onTouchEnd, this);\n\n\t\tL.DomEvent.preventDefault(e);\n\t},\n\n\t_onTouchMove: function (e) {\n\t\tvar map = this._map;\n\n\t\tif (!e.touches || e.touches.length !== 2 || !this._zooming) { return; }\n\n\t\tvar p1 = map.mouseEventToLayerPoint(e.touches[0]),\n\t\t    p2 = map.mouseEventToLayerPoint(e.touches[1]);\n\n\t\tthis._scale = p1.distanceTo(p2) / this._startDist;\n\t\tthis._delta = p1._add(p2)._divideBy(2)._subtract(this._startCenter);\n\n\t\tif (this._scale === 1) { return; }\n\n\t\tif (!map.options.bounceAtZoomLimits) {\n\t\t\tif ((map.getZoom() === map.getMinZoom() && this._scale < 1) ||\n\t\t\t    (map.getZoom() === map.getMaxZoom() && this._scale > 1)) { return; }\n\t\t}\n\n\t\tif (!this._moved) {\n\t\t\tL.DomUtil.addClass(map._mapPane, 'leaflet-touching');\n\n\t\t\tmap\n\t\t\t    .fire('movestart')\n\t\t\t    .fire('zoomstart');\n\n\t\t\tthis._moved = true;\n\t\t}\n\n\t\tL.Util.cancelAnimFrame(this._animRequest);\n\t\tthis._animRequest = L.Util.requestAnimFrame(\n\t\t        this._updateOnMove, this, true, this._map._container);\n\n\t\tL.DomEvent.preventDefault(e);\n\t},\n\n\t_updateOnMove: function () {\n\t\tvar map = this._map,\n\t\t    origin = this._getScaleOrigin(),\n\t\t    center = map.layerPointToLatLng(origin),\n\t\t    zoom = map.getScaleZoom(this._scale);\n\n\t\tmap._animateZoom(center, zoom, this._startCenter, this._scale, this._delta, false, true);\n\t},\n\n\t_onTouchEnd: function () {\n\t\tif (!this._moved || !this._zooming) {\n\t\t\tthis._zooming = false;\n\t\t\treturn;\n\t\t}\n\n\t\tvar map = this._map;\n\n\t\tthis._zooming = false;\n\t\tL.DomUtil.removeClass(map._mapPane, 'leaflet-touching');\n\t\tL.Util.cancelAnimFrame(this._animRequest);\n\n\t\tL.DomEvent\n\t\t    .off(document, 'touchmove', this._onTouchMove)\n\t\t    .off(document, 'touchend', this._onTouchEnd);\n\n\t\tvar origin = this._getScaleOrigin(),\n\t\t    center = map.layerPointToLatLng(origin),\n\n\t\t    oldZoom = map.getZoom(),\n\t\t    floatZoomDelta = map.getScaleZoom(this._scale) - oldZoom,\n\t\t    roundZoomDelta = (floatZoomDelta > 0 ?\n\t\t            Math.ceil(floatZoomDelta) : Math.floor(floatZoomDelta)),\n\n\t\t    zoom = map._limitZoom(oldZoom + roundZoomDelta),\n\t\t    scale = map.getZoomScale(zoom) / this._scale;\n\n\t\tmap._animateZoom(center, zoom, origin, scale);\n\t},\n\n\t_getScaleOrigin: function () {\n\t\tvar centerOffset = this._centerOffset.subtract(this._delta).divideBy(this._scale);\n\t\treturn this._startCenter.add(centerOffset);\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'touchZoom', L.Map.TouchZoom);\n\n\n/*\n * L.Map.Tap is used to enable mobile hacks like quick taps and long hold.\n */\n\nL.Map.mergeOptions({\n\ttap: true,\n\ttapTolerance: 15\n});\n\nL.Map.Tap = L.Handler.extend({\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._map._container, 'touchstart', this._onDown, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._map._container, 'touchstart', this._onDown, this);\n\t},\n\n\t_onDown: function (e) {\n\t\tif (!e.touches) { return; }\n\n\t\tL.DomEvent.preventDefault(e);\n\n\t\tthis._fireClick = true;\n\n\t\t// don't simulate click or track longpress if more than 1 touch\n\t\tif (e.touches.length > 1) {\n\t\t\tthis._fireClick = false;\n\t\t\tclearTimeout(this._holdTimeout);\n\t\t\treturn;\n\t\t}\n\n\t\tvar first = e.touches[0],\n\t\t    el = first.target;\n\n\t\tthis._startPos = this._newPos = new L.Point(first.clientX, first.clientY);\n\n\t\t// if touching a link, highlight it\n\t\tif (el.tagName && el.tagName.toLowerCase() === 'a') {\n\t\t\tL.DomUtil.addClass(el, 'leaflet-active');\n\t\t}\n\n\t\t// simulate long hold but setting a timeout\n\t\tthis._holdTimeout = setTimeout(L.bind(function () {\n\t\t\tif (this._isTapValid()) {\n\t\t\t\tthis._fireClick = false;\n\t\t\t\tthis._onUp();\n\t\t\t\tthis._simulateEvent('contextmenu', first);\n\t\t\t}\n\t\t}, this), 1000);\n\n\t\tL.DomEvent\n\t\t\t.on(document, 'touchmove', this._onMove, this)\n\t\t\t.on(document, 'touchend', this._onUp, this);\n\t},\n\n\t_onUp: function (e) {\n\t\tclearTimeout(this._holdTimeout);\n\n\t\tL.DomEvent\n\t\t\t.off(document, 'touchmove', this._onMove, this)\n\t\t\t.off(document, 'touchend', this._onUp, this);\n\n\t\tif (this._fireClick && e && e.changedTouches) {\n\n\t\t\tvar first = e.changedTouches[0],\n\t\t\t    el = first.target;\n\n\t\t\tif (el && el.tagName && el.tagName.toLowerCase() === 'a') {\n\t\t\t\tL.DomUtil.removeClass(el, 'leaflet-active');\n\t\t\t}\n\n\t\t\t// simulate click if the touch didn't move too much\n\t\t\tif (this._isTapValid()) {\n\t\t\t\tthis._simulateEvent('click', first);\n\t\t\t}\n\t\t}\n\t},\n\n\t_isTapValid: function () {\n\t\treturn this._newPos.distanceTo(this._startPos) <= this._map.options.tapTolerance;\n\t},\n\n\t_onMove: function (e) {\n\t\tvar first = e.touches[0];\n\t\tthis._newPos = new L.Point(first.clientX, first.clientY);\n\t},\n\n\t_simulateEvent: function (type, e) {\n\t\tvar simulatedEvent = document.createEvent('MouseEvents');\n\n\t\tsimulatedEvent._simulated = true;\n\t\te.target._simulatedClick = true;\n\n\t\tsimulatedEvent.initMouseEvent(\n\t\t        type, true, true, window, 1,\n\t\t        e.screenX, e.screenY,\n\t\t        e.clientX, e.clientY,\n\t\t        false, false, false, false, 0, null);\n\n\t\te.target.dispatchEvent(simulatedEvent);\n\t}\n});\n\nif (L.Browser.touch && !L.Browser.pointer) {\n\tL.Map.addInitHook('addHandler', 'tap', L.Map.Tap);\n}\n\n\n/*\n * L.Handler.ShiftDragZoom is used to add shift-drag zoom interaction to the map\n  * (zoom to a selected bounding box), enabled by default.\n */\n\nL.Map.mergeOptions({\n\tboxZoom: true\n});\n\nL.Map.BoxZoom = L.Handler.extend({\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\t\tthis._container = map._container;\n\t\tthis._pane = map._panes.overlayPane;\n\t\tthis._moved = false;\n\t},\n\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._container, 'mousedown', this._onMouseDown, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._container, 'mousedown', this._onMouseDown);\n\t\tthis._moved = false;\n\t},\n\n\tmoved: function () {\n\t\treturn this._moved;\n\t},\n\n\t_onMouseDown: function (e) {\n\t\tthis._moved = false;\n\n\t\tif (!e.shiftKey || ((e.which !== 1) && (e.button !== 1))) { return false; }\n\n\t\tL.DomUtil.disableTextSelection();\n\t\tL.DomUtil.disableImageDrag();\n\n\t\tthis._startLayerPoint = this._map.mouseEventToLayerPoint(e);\n\n\t\tL.DomEvent\n\t\t    .on(document, 'mousemove', this._onMouseMove, this)\n\t\t    .on(document, 'mouseup', this._onMouseUp, this)\n\t\t    .on(document, 'keydown', this._onKeyDown, this);\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tif (!this._moved) {\n\t\t\tthis._box = L.DomUtil.create('div', 'leaflet-zoom-box', this._pane);\n\t\t\tL.DomUtil.setPosition(this._box, this._startLayerPoint);\n\n\t\t\t//TODO refactor: move cursor to styles\n\t\t\tthis._container.style.cursor = 'crosshair';\n\t\t\tthis._map.fire('boxzoomstart');\n\t\t}\n\n\t\tvar startPoint = this._startLayerPoint,\n\t\t    box = this._box,\n\n\t\t    layerPoint = this._map.mouseEventToLayerPoint(e),\n\t\t    offset = layerPoint.subtract(startPoint),\n\n\t\t    newPos = new L.Point(\n\t\t        Math.min(layerPoint.x, startPoint.x),\n\t\t        Math.min(layerPoint.y, startPoint.y));\n\n\t\tL.DomUtil.setPosition(box, newPos);\n\n\t\tthis._moved = true;\n\n\t\t// TODO refactor: remove hardcoded 4 pixels\n\t\tbox.style.width  = (Math.max(0, Math.abs(offset.x) - 4)) + 'px';\n\t\tbox.style.height = (Math.max(0, Math.abs(offset.y) - 4)) + 'px';\n\t},\n\n\t_finish: function () {\n\t\tif (this._moved) {\n\t\t\tthis._pane.removeChild(this._box);\n\t\t\tthis._container.style.cursor = '';\n\t\t}\n\n\t\tL.DomUtil.enableTextSelection();\n\t\tL.DomUtil.enableImageDrag();\n\n\t\tL.DomEvent\n\t\t    .off(document, 'mousemove', this._onMouseMove)\n\t\t    .off(document, 'mouseup', this._onMouseUp)\n\t\t    .off(document, 'keydown', this._onKeyDown);\n\t},\n\n\t_onMouseUp: function (e) {\n\n\t\tthis._finish();\n\n\t\tvar map = this._map,\n\t\t    layerPoint = map.mouseEventToLayerPoint(e);\n\n\t\tif (this._startLayerPoint.equals(layerPoint)) { return; }\n\n\t\tvar bounds = new L.LatLngBounds(\n\t\t        map.layerPointToLatLng(this._startLayerPoint),\n\t\t        map.layerPointToLatLng(layerPoint));\n\n\t\tmap.fitBounds(bounds);\n\n\t\tmap.fire('boxzoomend', {\n\t\t\tboxZoomBounds: bounds\n\t\t});\n\t},\n\n\t_onKeyDown: function (e) {\n\t\tif (e.keyCode === 27) {\n\t\t\tthis._finish();\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'boxZoom', L.Map.BoxZoom);\n\n\n/*\n * L.Map.Keyboard is handling keyboard interaction with the map, enabled by default.\n */\n\nL.Map.mergeOptions({\n\tkeyboard: true,\n\tkeyboardPanOffset: 80,\n\tkeyboardZoomOffset: 1\n});\n\nL.Map.Keyboard = L.Handler.extend({\n\n\tkeyCodes: {\n\t\tleft:    [37],\n\t\tright:   [39],\n\t\tdown:    [40],\n\t\tup:      [38],\n\t\tzoomIn:  [187, 107, 61, 171],\n\t\tzoomOut: [189, 109, 173]\n\t},\n\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\n\t\tthis._setPanOffset(map.options.keyboardPanOffset);\n\t\tthis._setZoomOffset(map.options.keyboardZoomOffset);\n\t},\n\n\taddHooks: function () {\n\t\tvar container = this._map._container;\n\n\t\t// make the container focusable by tabbing\n\t\tif (container.tabIndex === -1) {\n\t\t\tcontainer.tabIndex = '0';\n\t\t}\n\n\t\tL.DomEvent\n\t\t    .on(container, 'focus', this._onFocus, this)\n\t\t    .on(container, 'blur', this._onBlur, this)\n\t\t    .on(container, 'mousedown', this._onMouseDown, this);\n\n\t\tthis._map\n\t\t    .on('focus', this._addHooks, this)\n\t\t    .on('blur', this._removeHooks, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._removeHooks();\n\n\t\tvar container = this._map._container;\n\n\t\tL.DomEvent\n\t\t    .off(container, 'focus', this._onFocus, this)\n\t\t    .off(container, 'blur', this._onBlur, this)\n\t\t    .off(container, 'mousedown', this._onMouseDown, this);\n\n\t\tthis._map\n\t\t    .off('focus', this._addHooks, this)\n\t\t    .off('blur', this._removeHooks, this);\n\t},\n\n\t_onMouseDown: function () {\n\t\tif (this._focused) { return; }\n\n\t\tvar body = document.body,\n\t\t    docEl = document.documentElement,\n\t\t    top = body.scrollTop || docEl.scrollTop,\n\t\t    left = body.scrollLeft || docEl.scrollLeft;\n\n\t\tthis._map._container.focus();\n\n\t\twindow.scrollTo(left, top);\n\t},\n\n\t_onFocus: function () {\n\t\tthis._focused = true;\n\t\tthis._map.fire('focus');\n\t},\n\n\t_onBlur: function () {\n\t\tthis._focused = false;\n\t\tthis._map.fire('blur');\n\t},\n\n\t_setPanOffset: function (pan) {\n\t\tvar keys = this._panKeys = {},\n\t\t    codes = this.keyCodes,\n\t\t    i, len;\n\n\t\tfor (i = 0, len = codes.left.length; i < len; i++) {\n\t\t\tkeys[codes.left[i]] = [-1 * pan, 0];\n\t\t}\n\t\tfor (i = 0, len = codes.right.length; i < len; i++) {\n\t\t\tkeys[codes.right[i]] = [pan, 0];\n\t\t}\n\t\tfor (i = 0, len = codes.down.length; i < len; i++) {\n\t\t\tkeys[codes.down[i]] = [0, pan];\n\t\t}\n\t\tfor (i = 0, len = codes.up.length; i < len; i++) {\n\t\t\tkeys[codes.up[i]] = [0, -1 * pan];\n\t\t}\n\t},\n\n\t_setZoomOffset: function (zoom) {\n\t\tvar keys = this._zoomKeys = {},\n\t\t    codes = this.keyCodes,\n\t\t    i, len;\n\n\t\tfor (i = 0, len = codes.zoomIn.length; i < len; i++) {\n\t\t\tkeys[codes.zoomIn[i]] = zoom;\n\t\t}\n\t\tfor (i = 0, len = codes.zoomOut.length; i < len; i++) {\n\t\t\tkeys[codes.zoomOut[i]] = -zoom;\n\t\t}\n\t},\n\n\t_addHooks: function () {\n\t\tL.DomEvent.on(document, 'keydown', this._onKeyDown, this);\n\t},\n\n\t_removeHooks: function () {\n\t\tL.DomEvent.off(document, 'keydown', this._onKeyDown, this);\n\t},\n\n\t_onKeyDown: function (e) {\n\t\tvar key = e.keyCode,\n\t\t    map = this._map;\n\n\t\tif (key in this._panKeys) {\n\n\t\t\tif (map._panAnim && map._panAnim._inProgress) { return; }\n\n\t\t\tmap.panBy(this._panKeys[key]);\n\n\t\t\tif (map.options.maxBounds) {\n\t\t\t\tmap.panInsideBounds(map.options.maxBounds);\n\t\t\t}\n\n\t\t} else if (key in this._zoomKeys) {\n\t\t\tmap.setZoom(map.getZoom() + this._zoomKeys[key]);\n\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tL.DomEvent.stop(e);\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'keyboard', L.Map.Keyboard);\n\n\n/*\n * L.Handler.MarkerDrag is used internally by L.Marker to make the markers draggable.\n */\n\nL.Handler.MarkerDrag = L.Handler.extend({\n\tinitialize: function (marker) {\n\t\tthis._marker = marker;\n\t},\n\n\taddHooks: function () {\n\t\tvar icon = this._marker._icon;\n\t\tif (!this._draggable) {\n\t\t\tthis._draggable = new L.Draggable(icon, icon);\n\t\t}\n\n\t\tthis._draggable\n\t\t\t.on('dragstart', this._onDragStart, this)\n\t\t\t.on('drag', this._onDrag, this)\n\t\t\t.on('dragend', this._onDragEnd, this);\n\t\tthis._draggable.enable();\n\t\tL.DomUtil.addClass(this._marker._icon, 'leaflet-marker-draggable');\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._draggable\n\t\t\t.off('dragstart', this._onDragStart, this)\n\t\t\t.off('drag', this._onDrag, this)\n\t\t\t.off('dragend', this._onDragEnd, this);\n\n\t\tthis._draggable.disable();\n\t\tL.DomUtil.removeClass(this._marker._icon, 'leaflet-marker-draggable');\n\t},\n\n\tmoved: function () {\n\t\treturn this._draggable && this._draggable._moved;\n\t},\n\n\t_onDragStart: function () {\n\t\tthis._marker\n\t\t    .closePopup()\n\t\t    .fire('movestart')\n\t\t    .fire('dragstart');\n\t},\n\n\t_onDrag: function () {\n\t\tvar marker = this._marker,\n\t\t    shadow = marker._shadow,\n\t\t    iconPos = L.DomUtil.getPosition(marker._icon),\n\t\t    latlng = marker._map.layerPointToLatLng(iconPos);\n\n\t\t// update shadow position\n\t\tif (shadow) {\n\t\t\tL.DomUtil.setPosition(shadow, iconPos);\n\t\t}\n\n\t\tmarker._latlng = latlng;\n\n\t\tmarker\n\t\t    .fire('move', {latlng: latlng})\n\t\t    .fire('drag');\n\t},\n\n\t_onDragEnd: function (e) {\n\t\tthis._marker\n\t\t    .fire('moveend')\n\t\t    .fire('dragend', e);\n\t}\n});\n\n\n/*\r\n * L.Control is a base class for implementing map controls. Handles positioning.\r\n * All other controls extend from this class.\r\n */\r\n\r\nL.Control = L.Class.extend({\r\n\toptions: {\r\n\t\tposition: 'topright'\r\n\t},\r\n\r\n\tinitialize: function (options) {\r\n\t\tL.setOptions(this, options);\r\n\t},\r\n\r\n\tgetPosition: function () {\r\n\t\treturn this.options.position;\r\n\t},\r\n\r\n\tsetPosition: function (position) {\r\n\t\tvar map = this._map;\r\n\r\n\t\tif (map) {\r\n\t\t\tmap.removeControl(this);\r\n\t\t}\r\n\r\n\t\tthis.options.position = position;\r\n\r\n\t\tif (map) {\r\n\t\t\tmap.addControl(this);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tgetContainer: function () {\r\n\t\treturn this._container;\r\n\t},\r\n\r\n\taddTo: function (map) {\r\n\t\tthis._map = map;\r\n\r\n\t\tvar container = this._container = this.onAdd(map),\r\n\t\t    pos = this.getPosition(),\r\n\t\t    corner = map._controlCorners[pos];\r\n\r\n\t\tL.DomUtil.addClass(container, 'leaflet-control');\r\n\r\n\t\tif (pos.indexOf('bottom') !== -1) {\r\n\t\t\tcorner.insertBefore(container, corner.firstChild);\r\n\t\t} else {\r\n\t\t\tcorner.appendChild(container);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tremoveFrom: function (map) {\r\n\t\tvar pos = this.getPosition(),\r\n\t\t    corner = map._controlCorners[pos];\r\n\r\n\t\tcorner.removeChild(this._container);\r\n\t\tthis._map = null;\r\n\r\n\t\tif (this.onRemove) {\r\n\t\t\tthis.onRemove(map);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_refocusOnMap: function () {\r\n\t\tif (this._map) {\r\n\t\t\tthis._map.getContainer().focus();\r\n\t\t}\r\n\t}\r\n});\r\n\r\nL.control = function (options) {\r\n\treturn new L.Control(options);\r\n};\r\n\r\n\r\n// adds control-related methods to L.Map\r\n\r\nL.Map.include({\r\n\taddControl: function (control) {\r\n\t\tcontrol.addTo(this);\r\n\t\treturn this;\r\n\t},\r\n\r\n\tremoveControl: function (control) {\r\n\t\tcontrol.removeFrom(this);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_initControlPos: function () {\r\n\t\tvar corners = this._controlCorners = {},\r\n\t\t    l = 'leaflet-',\r\n\t\t    container = this._controlContainer =\r\n\t\t            L.DomUtil.create('div', l + 'control-container', this._container);\r\n\r\n\t\tfunction createCorner(vSide, hSide) {\r\n\t\t\tvar className = l + vSide + ' ' + l + hSide;\r\n\r\n\t\t\tcorners[vSide + hSide] = L.DomUtil.create('div', className, container);\r\n\t\t}\r\n\r\n\t\tcreateCorner('top', 'left');\r\n\t\tcreateCorner('top', 'right');\r\n\t\tcreateCorner('bottom', 'left');\r\n\t\tcreateCorner('bottom', 'right');\r\n\t},\r\n\r\n\t_clearControlPos: function () {\r\n\t\tthis._container.removeChild(this._controlContainer);\r\n\t}\r\n});\r\n\n\n/*\r\n * L.Control.Zoom is used for the default zoom buttons on the map.\r\n */\r\n\r\nL.Control.Zoom = L.Control.extend({\r\n\toptions: {\r\n\t\tposition: 'topleft',\r\n\t\tzoomInText: '+',\r\n\t\tzoomInTitle: 'Zoom in',\r\n\t\tzoomOutText: '-',\r\n\t\tzoomOutTitle: 'Zoom out'\r\n\t},\r\n\r\n\tonAdd: function (map) {\r\n\t\tvar zoomName = 'leaflet-control-zoom',\r\n\t\t    container = L.DomUtil.create('div', zoomName + ' leaflet-bar');\r\n\r\n\t\tthis._map = map;\r\n\r\n\t\tthis._zoomInButton  = this._createButton(\r\n\t\t        this.options.zoomInText, this.options.zoomInTitle,\r\n\t\t        zoomName + '-in',  container, this._zoomIn,  this);\r\n\t\tthis._zoomOutButton = this._createButton(\r\n\t\t        this.options.zoomOutText, this.options.zoomOutTitle,\r\n\t\t        zoomName + '-out', container, this._zoomOut, this);\r\n\r\n\t\tthis._updateDisabled();\r\n\t\tmap.on('zoomend zoomlevelschange', this._updateDisabled, this);\r\n\r\n\t\treturn container;\r\n\t},\r\n\r\n\tonRemove: function (map) {\r\n\t\tmap.off('zoomend zoomlevelschange', this._updateDisabled, this);\r\n\t},\r\n\r\n\t_zoomIn: function (e) {\r\n\t\tthis._map.zoomIn(e.shiftKey ? 3 : 1);\r\n\t},\r\n\r\n\t_zoomOut: function (e) {\r\n\t\tthis._map.zoomOut(e.shiftKey ? 3 : 1);\r\n\t},\r\n\r\n\t_createButton: function (html, title, className, container, fn, context) {\r\n\t\tvar link = L.DomUtil.create('a', className, container);\r\n\t\tlink.innerHTML = html;\r\n\t\tlink.href = '#';\r\n\t\tlink.title = title;\r\n\r\n\t\tvar stop = L.DomEvent.stopPropagation;\r\n\r\n\t\tL.DomEvent\r\n\t\t    .on(link, 'click', stop)\r\n\t\t    .on(link, 'mousedown', stop)\r\n\t\t    .on(link, 'dblclick', stop)\r\n\t\t    .on(link, 'click', L.DomEvent.preventDefault)\r\n\t\t    .on(link, 'click', fn, context)\r\n\t\t    .on(link, 'click', this._refocusOnMap, context);\r\n\r\n\t\treturn link;\r\n\t},\r\n\r\n\t_updateDisabled: function () {\r\n\t\tvar map = this._map,\r\n\t\t\tclassName = 'leaflet-disabled';\r\n\r\n\t\tL.DomUtil.removeClass(this._zoomInButton, className);\r\n\t\tL.DomUtil.removeClass(this._zoomOutButton, className);\r\n\r\n\t\tif (map._zoom === map.getMinZoom()) {\r\n\t\t\tL.DomUtil.addClass(this._zoomOutButton, className);\r\n\t\t}\r\n\t\tif (map._zoom === map.getMaxZoom()) {\r\n\t\t\tL.DomUtil.addClass(this._zoomInButton, className);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nL.Map.mergeOptions({\r\n\tzoomControl: true\r\n});\r\n\r\nL.Map.addInitHook(function () {\r\n\tif (this.options.zoomControl) {\r\n\t\tthis.zoomControl = new L.Control.Zoom();\r\n\t\tthis.addControl(this.zoomControl);\r\n\t}\r\n});\r\n\r\nL.control.zoom = function (options) {\r\n\treturn new L.Control.Zoom(options);\r\n};\r\n\r\n\n\n/*\r\n * L.Control.Attribution is used for displaying attribution on the map (added by default).\r\n */\r\n\r\nL.Control.Attribution = L.Control.extend({\r\n\toptions: {\r\n\t\tposition: 'bottomright',\r\n\t\tprefix: '<a href=\"http://leafletjs.com\" title=\"A JS library for interactive maps\">Leaflet</a>'\r\n\t},\r\n\r\n\tinitialize: function (options) {\r\n\t\tL.setOptions(this, options);\r\n\r\n\t\tthis._attributions = {};\r\n\t},\r\n\r\n\tonAdd: function (map) {\r\n\t\tthis._container = L.DomUtil.create('div', 'leaflet-control-attribution');\r\n\t\tL.DomEvent.disableClickPropagation(this._container);\r\n\r\n\t\tfor (var i in map._layers) {\r\n\t\t\tif (map._layers[i].getAttribution) {\r\n\t\t\t\tthis.addAttribution(map._layers[i].getAttribution());\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tmap\r\n\t\t    .on('layeradd', this._onLayerAdd, this)\r\n\t\t    .on('layerremove', this._onLayerRemove, this);\r\n\r\n\t\tthis._update();\r\n\r\n\t\treturn this._container;\r\n\t},\r\n\r\n\tonRemove: function (map) {\r\n\t\tmap\r\n\t\t    .off('layeradd', this._onLayerAdd)\r\n\t\t    .off('layerremove', this._onLayerRemove);\r\n\r\n\t},\r\n\r\n\tsetPrefix: function (prefix) {\r\n\t\tthis.options.prefix = prefix;\r\n\t\tthis._update();\r\n\t\treturn this;\r\n\t},\r\n\r\n\taddAttribution: function (text) {\r\n\t\tif (!text) { return; }\r\n\r\n\t\tif (!this._attributions[text]) {\r\n\t\t\tthis._attributions[text] = 0;\r\n\t\t}\r\n\t\tthis._attributions[text]++;\r\n\r\n\t\tthis._update();\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tremoveAttribution: function (text) {\r\n\t\tif (!text) { return; }\r\n\r\n\t\tif (this._attributions[text]) {\r\n\t\t\tthis._attributions[text]--;\r\n\t\t\tthis._update();\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_update: function () {\r\n\t\tif (!this._map) { return; }\r\n\r\n\t\tvar attribs = [];\r\n\r\n\t\tfor (var i in this._attributions) {\r\n\t\t\tif (this._attributions[i]) {\r\n\t\t\t\tattribs.push(i);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar prefixAndAttribs = [];\r\n\r\n\t\tif (this.options.prefix) {\r\n\t\t\tprefixAndAttribs.push(this.options.prefix);\r\n\t\t}\r\n\t\tif (attribs.length) {\r\n\t\t\tprefixAndAttribs.push(attribs.join(', '));\r\n\t\t}\r\n\r\n\t\tthis._container.innerHTML = prefixAndAttribs.join(' | ');\r\n\t},\r\n\r\n\t_onLayerAdd: function (e) {\r\n\t\tif (e.layer.getAttribution) {\r\n\t\t\tthis.addAttribution(e.layer.getAttribution());\r\n\t\t}\r\n\t},\r\n\r\n\t_onLayerRemove: function (e) {\r\n\t\tif (e.layer.getAttribution) {\r\n\t\t\tthis.removeAttribution(e.layer.getAttribution());\r\n\t\t}\r\n\t}\r\n});\r\n\r\nL.Map.mergeOptions({\r\n\tattributionControl: true\r\n});\r\n\r\nL.Map.addInitHook(function () {\r\n\tif (this.options.attributionControl) {\r\n\t\tthis.attributionControl = (new L.Control.Attribution()).addTo(this);\r\n\t}\r\n});\r\n\r\nL.control.attribution = function (options) {\r\n\treturn new L.Control.Attribution(options);\r\n};\r\n\n\n/*\n * L.Control.Scale is used for displaying metric/imperial scale on the map.\n */\n\nL.Control.Scale = L.Control.extend({\n\toptions: {\n\t\tposition: 'bottomleft',\n\t\tmaxWidth: 100,\n\t\tmetric: true,\n\t\timperial: true,\n\t\tupdateWhenIdle: false\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._map = map;\n\n\t\tvar className = 'leaflet-control-scale',\n\t\t    container = L.DomUtil.create('div', className),\n\t\t    options = this.options;\n\n\t\tthis._addScales(options, className, container);\n\n\t\tmap.on(options.updateWhenIdle ? 'moveend' : 'move', this._update, this);\n\t\tmap.whenReady(this._update, this);\n\n\t\treturn container;\n\t},\n\n\tonRemove: function (map) {\n\t\tmap.off(this.options.updateWhenIdle ? 'moveend' : 'move', this._update, this);\n\t},\n\n\t_addScales: function (options, className, container) {\n\t\tif (options.metric) {\n\t\t\tthis._mScale = L.DomUtil.create('div', className + '-line', container);\n\t\t}\n\t\tif (options.imperial) {\n\t\t\tthis._iScale = L.DomUtil.create('div', className + '-line', container);\n\t\t}\n\t},\n\n\t_update: function () {\n\t\tvar bounds = this._map.getBounds(),\n\t\t    centerLat = bounds.getCenter().lat,\n\t\t    halfWorldMeters = 6378137 * Math.PI * Math.cos(centerLat * Math.PI / 180),\n\t\t    dist = halfWorldMeters * (bounds.getNorthEast().lng - bounds.getSouthWest().lng) / 180,\n\n\t\t    size = this._map.getSize(),\n\t\t    options = this.options,\n\t\t    maxMeters = 0;\n\n\t\tif (size.x > 0) {\n\t\t\tmaxMeters = dist * (options.maxWidth / size.x);\n\t\t}\n\n\t\tthis._updateScales(options, maxMeters);\n\t},\n\n\t_updateScales: function (options, maxMeters) {\n\t\tif (options.metric && maxMeters) {\n\t\t\tthis._updateMetric(maxMeters);\n\t\t}\n\n\t\tif (options.imperial && maxMeters) {\n\t\t\tthis._updateImperial(maxMeters);\n\t\t}\n\t},\n\n\t_updateMetric: function (maxMeters) {\n\t\tvar meters = this._getRoundNum(maxMeters);\n\n\t\tthis._mScale.style.width = this._getScaleWidth(meters / maxMeters) + 'px';\n\t\tthis._mScale.innerHTML = meters < 1000 ? meters + ' m' : (meters / 1000) + ' km';\n\t},\n\n\t_updateImperial: function (maxMeters) {\n\t\tvar maxFeet = maxMeters * 3.2808399,\n\t\t    scale = this._iScale,\n\t\t    maxMiles, miles, feet;\n\n\t\tif (maxFeet > 5280) {\n\t\t\tmaxMiles = maxFeet / 5280;\n\t\t\tmiles = this._getRoundNum(maxMiles);\n\n\t\t\tscale.style.width = this._getScaleWidth(miles / maxMiles) + 'px';\n\t\t\tscale.innerHTML = miles + ' mi';\n\n\t\t} else {\n\t\t\tfeet = this._getRoundNum(maxFeet);\n\n\t\t\tscale.style.width = this._getScaleWidth(feet / maxFeet) + 'px';\n\t\t\tscale.innerHTML = feet + ' ft';\n\t\t}\n\t},\n\n\t_getScaleWidth: function (ratio) {\n\t\treturn Math.round(this.options.maxWidth * ratio) - 10;\n\t},\n\n\t_getRoundNum: function (num) {\n\t\tvar pow10 = Math.pow(10, (Math.floor(num) + '').length - 1),\n\t\t    d = num / pow10;\n\n\t\td = d >= 10 ? 10 : d >= 5 ? 5 : d >= 3 ? 3 : d >= 2 ? 2 : 1;\n\n\t\treturn pow10 * d;\n\t}\n});\n\nL.control.scale = function (options) {\n\treturn new L.Control.Scale(options);\n};\n\n\n/*\r\n * L.Control.Layers is a control to allow users to switch between different layers on the map.\r\n */\r\n\r\nL.Control.Layers = L.Control.extend({\r\n\toptions: {\r\n\t\tcollapsed: true,\r\n\t\tposition: 'topright',\r\n\t\tautoZIndex: true\r\n\t},\r\n\r\n\tinitialize: function (baseLayers, overlays, options) {\r\n\t\tL.setOptions(this, options);\r\n\r\n\t\tthis._layers = {};\r\n\t\tthis._lastZIndex = 0;\r\n\t\tthis._handlingClick = false;\r\n\r\n\t\tfor (var i in baseLayers) {\r\n\t\t\tthis._addLayer(baseLayers[i], i);\r\n\t\t}\r\n\r\n\t\tfor (i in overlays) {\r\n\t\t\tthis._addLayer(overlays[i], i, true);\r\n\t\t}\r\n\t},\r\n\r\n\tonAdd: function (map) {\r\n\t\tthis._initLayout();\r\n\t\tthis._update();\r\n\r\n\t\tmap\r\n\t\t    .on('layeradd', this._onLayerChange, this)\r\n\t\t    .on('layerremove', this._onLayerChange, this);\r\n\r\n\t\treturn this._container;\r\n\t},\r\n\r\n\tonRemove: function (map) {\r\n\t\tmap\r\n\t\t    .off('layeradd', this._onLayerChange, this)\r\n\t\t    .off('layerremove', this._onLayerChange, this);\r\n\t},\r\n\r\n\taddBaseLayer: function (layer, name) {\r\n\t\tthis._addLayer(layer, name);\r\n\t\tthis._update();\r\n\t\treturn this;\r\n\t},\r\n\r\n\taddOverlay: function (layer, name) {\r\n\t\tthis._addLayer(layer, name, true);\r\n\t\tthis._update();\r\n\t\treturn this;\r\n\t},\r\n\r\n\tremoveLayer: function (layer) {\r\n\t\tvar id = L.stamp(layer);\r\n\t\tdelete this._layers[id];\r\n\t\tthis._update();\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_initLayout: function () {\r\n\t\tvar className = 'leaflet-control-layers',\r\n\t\t    container = this._container = L.DomUtil.create('div', className);\r\n\r\n\t\t//Makes this work on IE10 Touch devices by stopping it from firing a mouseout event when the touch is released\r\n\t\tcontainer.setAttribute('aria-haspopup', true);\r\n\r\n\t\tif (!L.Browser.touch) {\r\n\t\t\tL.DomEvent\r\n\t\t\t\t.disableClickPropagation(container)\r\n\t\t\t\t.disableScrollPropagation(container);\r\n\t\t} else {\r\n\t\t\tL.DomEvent.on(container, 'click', L.DomEvent.stopPropagation);\r\n\t\t}\r\n\r\n\t\tvar form = this._form = L.DomUtil.create('form', className + '-list');\r\n\r\n\t\tif (this.options.collapsed) {\r\n\t\t\tif (!L.Browser.android) {\r\n\t\t\t\tL.DomEvent\r\n\t\t\t\t    .on(container, 'mouseover', this._expand, this)\r\n\t\t\t\t    .on(container, 'mouseout', this._collapse, this);\r\n\t\t\t}\r\n\t\t\tvar link = this._layersLink = L.DomUtil.create('a', className + '-toggle', container);\r\n\t\t\tlink.href = '#';\r\n\t\t\tlink.title = 'Layers';\r\n\r\n\t\t\tif (L.Browser.touch) {\r\n\t\t\t\tL.DomEvent\r\n\t\t\t\t    .on(link, 'click', L.DomEvent.stop)\r\n\t\t\t\t    .on(link, 'click', this._expand, this);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tL.DomEvent.on(link, 'focus', this._expand, this);\r\n\t\t\t}\r\n\t\t\t//Work around for Firefox android issue https://github.com/Leaflet/Leaflet/issues/2033\r\n\t\t\tL.DomEvent.on(form, 'click', function () {\r\n\t\t\t\tsetTimeout(L.bind(this._onInputClick, this), 0);\r\n\t\t\t}, this);\r\n\r\n\t\t\tthis._map.on('click', this._collapse, this);\r\n\t\t\t// TODO keyboard accessibility\r\n\t\t} else {\r\n\t\t\tthis._expand();\r\n\t\t}\r\n\r\n\t\tthis._baseLayersList = L.DomUtil.create('div', className + '-base', form);\r\n\t\tthis._separator = L.DomUtil.create('div', className + '-separator', form);\r\n\t\tthis._overlaysList = L.DomUtil.create('div', className + '-overlays', form);\r\n\r\n\t\tcontainer.appendChild(form);\r\n\t},\r\n\r\n\t_addLayer: function (layer, name, overlay) {\r\n\t\tvar id = L.stamp(layer);\r\n\r\n\t\tthis._layers[id] = {\r\n\t\t\tlayer: layer,\r\n\t\t\tname: name,\r\n\t\t\toverlay: overlay\r\n\t\t};\r\n\r\n\t\tif (this.options.autoZIndex && layer.setZIndex) {\r\n\t\t\tthis._lastZIndex++;\r\n\t\t\tlayer.setZIndex(this._lastZIndex);\r\n\t\t}\r\n\t},\r\n\r\n\t_update: function () {\r\n\t\tif (!this._container) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._baseLayersList.innerHTML = '';\r\n\t\tthis._overlaysList.innerHTML = '';\r\n\r\n\t\tvar baseLayersPresent = false,\r\n\t\t    overlaysPresent = false,\r\n\t\t    i, obj;\r\n\r\n\t\tfor (i in this._layers) {\r\n\t\t\tobj = this._layers[i];\r\n\t\t\tthis._addItem(obj);\r\n\t\t\toverlaysPresent = overlaysPresent || obj.overlay;\r\n\t\t\tbaseLayersPresent = baseLayersPresent || !obj.overlay;\r\n\t\t}\r\n\r\n\t\tthis._separator.style.display = overlaysPresent && baseLayersPresent ? '' : 'none';\r\n\t},\r\n\r\n\t_onLayerChange: function (e) {\r\n\t\tvar obj = this._layers[L.stamp(e.layer)];\r\n\r\n\t\tif (!obj) { return; }\r\n\r\n\t\tif (!this._handlingClick) {\r\n\t\t\tthis._update();\r\n\t\t}\r\n\r\n\t\tvar type = obj.overlay ?\r\n\t\t\t(e.type === 'layeradd' ? 'overlayadd' : 'overlayremove') :\r\n\t\t\t(e.type === 'layeradd' ? 'baselayerchange' : null);\r\n\r\n\t\tif (type) {\r\n\t\t\tthis._map.fire(type, obj);\r\n\t\t}\r\n\t},\r\n\r\n\t// IE7 bugs out if you create a radio dynamically, so you have to do it this hacky way (see http://bit.ly/PqYLBe)\r\n\t_createRadioElement: function (name, checked) {\r\n\r\n\t\tvar radioHtml = '<input type=\"radio\" class=\"leaflet-control-layers-selector\" name=\"' + name + '\"';\r\n\t\tif (checked) {\r\n\t\t\tradioHtml += ' checked=\"checked\"';\r\n\t\t}\r\n\t\tradioHtml += '/>';\r\n\r\n\t\tvar radioFragment = document.createElement('div');\r\n\t\tradioFragment.innerHTML = radioHtml;\r\n\r\n\t\treturn radioFragment.firstChild;\r\n\t},\r\n\r\n\t_addItem: function (obj) {\r\n\t\tvar label = document.createElement('label'),\r\n\t\t    input,\r\n\t\t    checked = this._map.hasLayer(obj.layer);\r\n\r\n\t\tif (obj.overlay) {\r\n\t\t\tinput = document.createElement('input');\r\n\t\t\tinput.type = 'checkbox';\r\n\t\t\tinput.className = 'leaflet-control-layers-selector';\r\n\t\t\tinput.defaultChecked = checked;\r\n\t\t} else {\r\n\t\t\tinput = this._createRadioElement('leaflet-base-layers', checked);\r\n\t\t}\r\n\r\n\t\tinput.layerId = L.stamp(obj.layer);\r\n\r\n\t\tL.DomEvent.on(input, 'click', this._onInputClick, this);\r\n\r\n\t\tvar name = document.createElement('span');\r\n\t\tname.innerHTML = ' ' + obj.name;\r\n\r\n\t\tlabel.appendChild(input);\r\n\t\tlabel.appendChild(name);\r\n\r\n\t\tvar container = obj.overlay ? this._overlaysList : this._baseLayersList;\r\n\t\tcontainer.appendChild(label);\r\n\r\n\t\treturn label;\r\n\t},\r\n\r\n\t_onInputClick: function () {\r\n\t\tvar i, input, obj,\r\n\t\t    inputs = this._form.getElementsByTagName('input'),\r\n\t\t    inputsLen = inputs.length;\r\n\r\n\t\tthis._handlingClick = true;\r\n\r\n\t\tfor (i = 0; i < inputsLen; i++) {\r\n\t\t\tinput = inputs[i];\r\n\t\t\tobj = this._layers[input.layerId];\r\n\r\n\t\t\tif (input.checked && !this._map.hasLayer(obj.layer)) {\r\n\t\t\t\tthis._map.addLayer(obj.layer);\r\n\r\n\t\t\t} else if (!input.checked && this._map.hasLayer(obj.layer)) {\r\n\t\t\t\tthis._map.removeLayer(obj.layer);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._handlingClick = false;\r\n\r\n\t\tthis._refocusOnMap();\r\n\t},\r\n\r\n\t_expand: function () {\r\n\t\tL.DomUtil.addClass(this._container, 'leaflet-control-layers-expanded');\r\n\t},\r\n\r\n\t_collapse: function () {\r\n\t\tthis._container.className = this._container.className.replace(' leaflet-control-layers-expanded', '');\r\n\t}\r\n});\r\n\r\nL.control.layers = function (baseLayers, overlays, options) {\r\n\treturn new L.Control.Layers(baseLayers, overlays, options);\r\n};\r\n\n\n/*\n * L.PosAnimation is used by Leaflet internally for pan animations.\n */\n\nL.PosAnimation = L.Class.extend({\n\tincludes: L.Mixin.Events,\n\n\trun: function (el, newPos, duration, easeLinearity) { // (HTMLElement, Point[, Number, Number])\n\t\tthis.stop();\n\n\t\tthis._el = el;\n\t\tthis._inProgress = true;\n\t\tthis._newPos = newPos;\n\n\t\tthis.fire('start');\n\n\t\tel.style[L.DomUtil.TRANSITION] = 'all ' + (duration || 0.25) +\n\t\t        's cubic-bezier(0,0,' + (easeLinearity || 0.5) + ',1)';\n\n\t\tL.DomEvent.on(el, L.DomUtil.TRANSITION_END, this._onTransitionEnd, this);\n\t\tL.DomUtil.setPosition(el, newPos);\n\n\t\t// toggle reflow, Chrome flickers for some reason if you don't do this\n\t\tL.Util.falseFn(el.offsetWidth);\n\n\t\t// there's no native way to track value updates of transitioned properties, so we imitate this\n\t\tthis._stepTimer = setInterval(L.bind(this._onStep, this), 50);\n\t},\n\n\tstop: function () {\n\t\tif (!this._inProgress) { return; }\n\n\t\t// if we just removed the transition property, the element would jump to its final position,\n\t\t// so we need to make it stay at the current position\n\n\t\tL.DomUtil.setPosition(this._el, this._getPos());\n\t\tthis._onTransitionEnd();\n\t\tL.Util.falseFn(this._el.offsetWidth); // force reflow in case we are about to start a new animation\n\t},\n\n\t_onStep: function () {\n\t\tvar stepPos = this._getPos();\n\t\tif (!stepPos) {\n\t\t\tthis._onTransitionEnd();\n\t\t\treturn;\n\t\t}\n\t\t// jshint camelcase: false\n\t\t// make L.DomUtil.getPosition return intermediate position value during animation\n\t\tthis._el._leaflet_pos = stepPos;\n\n\t\tthis.fire('step');\n\t},\n\n\t// you can't easily get intermediate values of properties animated with CSS3 Transitions,\n\t// we need to parse computed style (in case of transform it returns matrix string)\n\n\t_transformRe: /([-+]?(?:\\d*\\.)?\\d+)\\D*, ([-+]?(?:\\d*\\.)?\\d+)\\D*\\)/,\n\n\t_getPos: function () {\n\t\tvar left, top, matches,\n\t\t    el = this._el,\n\t\t    style = window.getComputedStyle(el);\n\n\t\tif (L.Browser.any3d) {\n\t\t\tmatches = style[L.DomUtil.TRANSFORM].match(this._transformRe);\n\t\t\tif (!matches) { return; }\n\t\t\tleft = parseFloat(matches[1]);\n\t\t\ttop  = parseFloat(matches[2]);\n\t\t} else {\n\t\t\tleft = parseFloat(style.left);\n\t\t\ttop  = parseFloat(style.top);\n\t\t}\n\n\t\treturn new L.Point(left, top, true);\n\t},\n\n\t_onTransitionEnd: function () {\n\t\tL.DomEvent.off(this._el, L.DomUtil.TRANSITION_END, this._onTransitionEnd, this);\n\n\t\tif (!this._inProgress) { return; }\n\t\tthis._inProgress = false;\n\n\t\tthis._el.style[L.DomUtil.TRANSITION] = '';\n\n\t\t// jshint camelcase: false\n\t\t// make sure L.DomUtil.getPosition returns the final position value after animation\n\t\tthis._el._leaflet_pos = this._newPos;\n\n\t\tclearInterval(this._stepTimer);\n\n\t\tthis.fire('step').fire('end');\n\t}\n\n});\n\n\n/*\n * Extends L.Map to handle panning animations.\n */\n\nL.Map.include({\n\n\tsetView: function (center, zoom, options) {\n\n\t\tzoom = zoom === undefined ? this._zoom : this._limitZoom(zoom);\n\t\tcenter = this._limitCenter(L.latLng(center), zoom, this.options.maxBounds);\n\t\toptions = options || {};\n\n\t\tif (this._panAnim) {\n\t\t\tthis._panAnim.stop();\n\t\t}\n\n\t\tif (this._loaded && !options.reset && options !== true) {\n\n\t\t\tif (options.animate !== undefined) {\n\t\t\t\toptions.zoom = L.extend({animate: options.animate}, options.zoom);\n\t\t\t\toptions.pan = L.extend({animate: options.animate}, options.pan);\n\t\t\t}\n\n\t\t\t// try animating pan or zoom\n\t\t\tvar animated = (this._zoom !== zoom) ?\n\t\t\t\tthis._tryAnimatedZoom && this._tryAnimatedZoom(center, zoom, options.zoom) :\n\t\t\t\tthis._tryAnimatedPan(center, options.pan);\n\n\t\t\tif (animated) {\n\t\t\t\t// prevent resize handler call, the view will refresh after animation anyway\n\t\t\t\tclearTimeout(this._sizeTimer);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\n\t\t// animation didn't start, just reset the map view\n\t\tthis._resetView(center, zoom);\n\n\t\treturn this;\n\t},\n\n\tpanBy: function (offset, options) {\n\t\toffset = L.point(offset).round();\n\t\toptions = options || {};\n\n\t\tif (!offset.x && !offset.y) {\n\t\t\treturn this;\n\t\t}\n\n\t\tif (!this._panAnim) {\n\t\t\tthis._panAnim = new L.PosAnimation();\n\n\t\t\tthis._panAnim.on({\n\t\t\t\t'step': this._onPanTransitionStep,\n\t\t\t\t'end': this._onPanTransitionEnd\n\t\t\t}, this);\n\t\t}\n\n\t\t// don't fire movestart if animating inertia\n\t\tif (!options.noMoveStart) {\n\t\t\tthis.fire('movestart');\n\t\t}\n\n\t\t// animate pan unless animate: false specified\n\t\tif (options.animate !== false) {\n\t\t\tL.DomUtil.addClass(this._mapPane, 'leaflet-pan-anim');\n\n\t\t\tvar newPos = this._getMapPanePos().subtract(offset);\n\t\t\tthis._panAnim.run(this._mapPane, newPos, options.duration || 0.25, options.easeLinearity);\n\t\t} else {\n\t\t\tthis._rawPanBy(offset);\n\t\t\tthis.fire('move').fire('moveend');\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_onPanTransitionStep: function () {\n\t\tthis.fire('move');\n\t},\n\n\t_onPanTransitionEnd: function () {\n\t\tL.DomUtil.removeClass(this._mapPane, 'leaflet-pan-anim');\n\t\tthis.fire('moveend');\n\t},\n\n\t_tryAnimatedPan: function (center, options) {\n\t\t// difference between the new and current centers in pixels\n\t\tvar offset = this._getCenterOffset(center)._floor();\n\n\t\t// don't animate too far unless animate: true specified in options\n\t\tif ((options && options.animate) !== true && !this.getSize().contains(offset)) { return false; }\n\n\t\tthis.panBy(offset, options);\n\n\t\treturn true;\n\t}\n});\n\n\n/*\n * L.PosAnimation fallback implementation that powers Leaflet pan animations\n * in browsers that don't support CSS3 Transitions.\n */\n\nL.PosAnimation = L.DomUtil.TRANSITION ? L.PosAnimation : L.PosAnimation.extend({\n\n\trun: function (el, newPos, duration, easeLinearity) { // (HTMLElement, Point[, Number, Number])\n\t\tthis.stop();\n\n\t\tthis._el = el;\n\t\tthis._inProgress = true;\n\t\tthis._duration = duration || 0.25;\n\t\tthis._easeOutPower = 1 / Math.max(easeLinearity || 0.5, 0.2);\n\n\t\tthis._startPos = L.DomUtil.getPosition(el);\n\t\tthis._offset = newPos.subtract(this._startPos);\n\t\tthis._startTime = +new Date();\n\n\t\tthis.fire('start');\n\n\t\tthis._animate();\n\t},\n\n\tstop: function () {\n\t\tif (!this._inProgress) { return; }\n\n\t\tthis._step();\n\t\tthis._complete();\n\t},\n\n\t_animate: function () {\n\t\t// animation loop\n\t\tthis._animId = L.Util.requestAnimFrame(this._animate, this);\n\t\tthis._step();\n\t},\n\n\t_step: function () {\n\t\tvar elapsed = (+new Date()) - this._startTime,\n\t\t    duration = this._duration * 1000;\n\n\t\tif (elapsed < duration) {\n\t\t\tthis._runFrame(this._easeOut(elapsed / duration));\n\t\t} else {\n\t\t\tthis._runFrame(1);\n\t\t\tthis._complete();\n\t\t}\n\t},\n\n\t_runFrame: function (progress) {\n\t\tvar pos = this._startPos.add(this._offset.multiplyBy(progress));\n\t\tL.DomUtil.setPosition(this._el, pos);\n\n\t\tthis.fire('step');\n\t},\n\n\t_complete: function () {\n\t\tL.Util.cancelAnimFrame(this._animId);\n\n\t\tthis._inProgress = false;\n\t\tthis.fire('end');\n\t},\n\n\t_easeOut: function (t) {\n\t\treturn 1 - Math.pow(1 - t, this._easeOutPower);\n\t}\n});\n\n\n/*\n * Extends L.Map to handle zoom animations.\n */\n\nL.Map.mergeOptions({\n\tzoomAnimation: true,\n\tzoomAnimationThreshold: 4\n});\n\nif (L.DomUtil.TRANSITION) {\n\n\tL.Map.addInitHook(function () {\n\t\t// don't animate on browsers without hardware-accelerated transitions or old Android/Opera\n\t\tthis._zoomAnimated = this.options.zoomAnimation && L.DomUtil.TRANSITION &&\n\t\t\t\tL.Browser.any3d && !L.Browser.android23 && !L.Browser.mobileOpera;\n\n\t\t// zoom transitions run with the same duration for all layers, so if one of transitionend events\n\t\t// happens after starting zoom animation (propagating to the map pane), we know that it ended globally\n\t\tif (this._zoomAnimated) {\n\t\t\tL.DomEvent.on(this._mapPane, L.DomUtil.TRANSITION_END, this._catchTransitionEnd, this);\n\t\t}\n\t});\n}\n\nL.Map.include(!L.DomUtil.TRANSITION ? {} : {\n\n\t_catchTransitionEnd: function (e) {\n\t\tif (this._animatingZoom && e.propertyName.indexOf('transform') >= 0) {\n\t\t\tthis._onZoomTransitionEnd();\n\t\t}\n\t},\n\n\t_nothingToAnimate: function () {\n\t\treturn !this._container.getElementsByClassName('leaflet-zoom-animated').length;\n\t},\n\n\t_tryAnimatedZoom: function (center, zoom, options) {\n\n\t\tif (this._animatingZoom) { return true; }\n\n\t\toptions = options || {};\n\n\t\t// don't animate if disabled, not supported or zoom difference is too large\n\t\tif (!this._zoomAnimated || options.animate === false || this._nothingToAnimate() ||\n\t\t        Math.abs(zoom - this._zoom) > this.options.zoomAnimationThreshold) { return false; }\n\n\t\t// offset is the pixel coords of the zoom origin relative to the current center\n\t\tvar scale = this.getZoomScale(zoom),\n\t\t    offset = this._getCenterOffset(center)._divideBy(1 - 1 / scale),\n\t\t\torigin = this._getCenterLayerPoint()._add(offset);\n\n\t\t// don't animate if the zoom origin isn't within one screen from the current center, unless forced\n\t\tif (options.animate !== true && !this.getSize().contains(offset)) { return false; }\n\n\t\tthis\n\t\t    .fire('movestart')\n\t\t    .fire('zoomstart');\n\n\t\tthis._animateZoom(center, zoom, origin, scale, null, true);\n\n\t\treturn true;\n\t},\n\n\t_animateZoom: function (center, zoom, origin, scale, delta, backwards, forTouchZoom) {\n\n\t\tif (!forTouchZoom) {\n\t\t\tthis._animatingZoom = true;\n\t\t}\n\n\t\t// put transform transition on all layers with leaflet-zoom-animated class\n\t\tL.DomUtil.addClass(this._mapPane, 'leaflet-zoom-anim');\n\n\t\t// remember what center/zoom to set after animation\n\t\tthis._animateToCenter = center;\n\t\tthis._animateToZoom = zoom;\n\n\t\t// disable any dragging during animation\n\t\tif (L.Draggable) {\n\t\t\tL.Draggable._disabled = true;\n\t\t}\n\n\t\tL.Util.requestAnimFrame(function () {\n\t\t\tthis.fire('zoomanim', {\n\t\t\t\tcenter: center,\n\t\t\t\tzoom: zoom,\n\t\t\t\torigin: origin,\n\t\t\t\tscale: scale,\n\t\t\t\tdelta: delta,\n\t\t\t\tbackwards: backwards\n\t\t\t});\n\t\t\t// horrible hack to work around a Chrome bug https://github.com/Leaflet/Leaflet/issues/3689\n\t\t\tsetTimeout(L.bind(this._onZoomTransitionEnd, this), 250);\n\t\t}, this);\n\t},\n\n\t_onZoomTransitionEnd: function () {\n\t\tif (!this._animatingZoom) { return; }\n\n\t\tthis._animatingZoom = false;\n\n\t\tL.DomUtil.removeClass(this._mapPane, 'leaflet-zoom-anim');\n\n\t\tL.Util.requestAnimFrame(function () {\n\t\t\tthis._resetView(this._animateToCenter, this._animateToZoom, true, true);\n\n\t\t\tif (L.Draggable) {\n\t\t\t\tL.Draggable._disabled = false;\n\t\t\t}\n\t\t}, this);\n\t}\n});\n\n\n/*\n\tZoom animation logic for L.TileLayer.\n*/\n\nL.TileLayer.include({\n\t_animateZoom: function (e) {\n\t\tif (!this._animating) {\n\t\t\tthis._animating = true;\n\t\t\tthis._prepareBgBuffer();\n\t\t}\n\n\t\tvar bg = this._bgBuffer,\n\t\t    transform = L.DomUtil.TRANSFORM,\n\t\t    initialTransform = e.delta ? L.DomUtil.getTranslateString(e.delta) : bg.style[transform],\n\t\t    scaleStr = L.DomUtil.getScaleString(e.scale, e.origin);\n\n\t\tbg.style[transform] = e.backwards ?\n\t\t\t\tscaleStr + ' ' + initialTransform :\n\t\t\t\tinitialTransform + ' ' + scaleStr;\n\t},\n\n\t_endZoomAnim: function () {\n\t\tvar front = this._tileContainer,\n\t\t    bg = this._bgBuffer;\n\n\t\tfront.style.visibility = '';\n\t\tfront.parentNode.appendChild(front); // Bring to fore\n\n\t\t// force reflow\n\t\tL.Util.falseFn(bg.offsetWidth);\n\n\t\tvar zoom = this._map.getZoom();\n\t\tif (zoom > this.options.maxZoom || zoom < this.options.minZoom) {\n\t\t\tthis._clearBgBuffer();\n\t\t}\n\n\t\tthis._animating = false;\n\t},\n\n\t_clearBgBuffer: function () {\n\t\tvar map = this._map;\n\n\t\tif (map && !map._animatingZoom && !map.touchZoom._zooming) {\n\t\t\tthis._bgBuffer.innerHTML = '';\n\t\t\tthis._bgBuffer.style[L.DomUtil.TRANSFORM] = '';\n\t\t}\n\t},\n\n\t_prepareBgBuffer: function () {\n\n\t\tvar front = this._tileContainer,\n\t\t    bg = this._bgBuffer;\n\n\t\t// if foreground layer doesn't have many tiles but bg layer does,\n\t\t// keep the existing bg layer and just zoom it some more\n\n\t\tvar bgLoaded = this._getLoadedTilesPercentage(bg),\n\t\t    frontLoaded = this._getLoadedTilesPercentage(front);\n\n\t\tif (bg && bgLoaded > 0.5 && frontLoaded < 0.5) {\n\n\t\t\tfront.style.visibility = 'hidden';\n\t\t\tthis._stopLoadingImages(front);\n\t\t\treturn;\n\t\t}\n\n\t\t// prepare the buffer to become the front tile pane\n\t\tbg.style.visibility = 'hidden';\n\t\tbg.style[L.DomUtil.TRANSFORM] = '';\n\n\t\t// switch out the current layer to be the new bg layer (and vice-versa)\n\t\tthis._tileContainer = bg;\n\t\tbg = this._bgBuffer = front;\n\n\t\tthis._stopLoadingImages(bg);\n\n\t\t//prevent bg buffer from clearing right after zoom\n\t\tclearTimeout(this._clearBgBufferTimer);\n\t},\n\n\t_getLoadedTilesPercentage: function (container) {\n\t\tvar tiles = container.getElementsByTagName('img'),\n\t\t    i, len, count = 0;\n\n\t\tfor (i = 0, len = tiles.length; i < len; i++) {\n\t\t\tif (tiles[i].complete) {\n\t\t\t\tcount++;\n\t\t\t}\n\t\t}\n\t\treturn count / len;\n\t},\n\n\t// stops loading all tiles in the background layer\n\t_stopLoadingImages: function (container) {\n\t\tvar tiles = Array.prototype.slice.call(container.getElementsByTagName('img')),\n\t\t    i, len, tile;\n\n\t\tfor (i = 0, len = tiles.length; i < len; i++) {\n\t\t\ttile = tiles[i];\n\n\t\t\tif (!tile.complete) {\n\t\t\t\ttile.onload = L.Util.falseFn;\n\t\t\t\ttile.onerror = L.Util.falseFn;\n\t\t\t\ttile.src = L.Util.emptyImageUrl;\n\n\t\t\t\ttile.parentNode.removeChild(tile);\n\t\t\t}\n\t\t}\n\t}\n});\n\n\n/*\r\n * Provides L.Map with convenient shortcuts for using browser geolocation features.\r\n */\r\n\r\nL.Map.include({\r\n\t_defaultLocateOptions: {\r\n\t\twatch: false,\r\n\t\tsetView: false,\r\n\t\tmaxZoom: Infinity,\r\n\t\ttimeout: 10000,\r\n\t\tmaximumAge: 0,\r\n\t\tenableHighAccuracy: false\r\n\t},\r\n\r\n\tlocate: function (/*Object*/ options) {\r\n\r\n\t\toptions = this._locateOptions = L.extend(this._defaultLocateOptions, options);\r\n\r\n\t\tif (!navigator.geolocation) {\r\n\t\t\tthis._handleGeolocationError({\r\n\t\t\t\tcode: 0,\r\n\t\t\t\tmessage: 'Geolocation not supported.'\r\n\t\t\t});\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar onResponse = L.bind(this._handleGeolocationResponse, this),\r\n\t\t\tonError = L.bind(this._handleGeolocationError, this);\r\n\r\n\t\tif (options.watch) {\r\n\t\t\tthis._locationWatchId =\r\n\t\t\t        navigator.geolocation.watchPosition(onResponse, onError, options);\r\n\t\t} else {\r\n\t\t\tnavigator.geolocation.getCurrentPosition(onResponse, onError, options);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\tstopLocate: function () {\r\n\t\tif (navigator.geolocation) {\r\n\t\t\tnavigator.geolocation.clearWatch(this._locationWatchId);\r\n\t\t}\r\n\t\tif (this._locateOptions) {\r\n\t\t\tthis._locateOptions.setView = false;\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_handleGeolocationError: function (error) {\r\n\t\tvar c = error.code,\r\n\t\t    message = error.message ||\r\n\t\t            (c === 1 ? 'permission denied' :\r\n\t\t            (c === 2 ? 'position unavailable' : 'timeout'));\r\n\r\n\t\tif (this._locateOptions.setView && !this._loaded) {\r\n\t\t\tthis.fitWorld();\r\n\t\t}\r\n\r\n\t\tthis.fire('locationerror', {\r\n\t\t\tcode: c,\r\n\t\t\tmessage: 'Geolocation error: ' + message + '.'\r\n\t\t});\r\n\t},\r\n\r\n\t_handleGeolocationResponse: function (pos) {\r\n\t\tvar lat = pos.coords.latitude,\r\n\t\t    lng = pos.coords.longitude,\r\n\t\t    latlng = new L.LatLng(lat, lng),\r\n\r\n\t\t    latAccuracy = 180 * pos.coords.accuracy / 40075017,\r\n\t\t    lngAccuracy = latAccuracy / Math.cos(L.LatLng.DEG_TO_RAD * lat),\r\n\r\n\t\t    bounds = L.latLngBounds(\r\n\t\t            [lat - latAccuracy, lng - lngAccuracy],\r\n\t\t            [lat + latAccuracy, lng + lngAccuracy]),\r\n\r\n\t\t    options = this._locateOptions;\r\n\r\n\t\tif (options.setView) {\r\n\t\t\tvar zoom = Math.min(this.getBoundsZoom(bounds), options.maxZoom);\r\n\t\t\tthis.setView(latlng, zoom);\r\n\t\t}\r\n\r\n\t\tvar data = {\r\n\t\t\tlatlng: latlng,\r\n\t\t\tbounds: bounds,\r\n\t\t\ttimestamp: pos.timestamp\r\n\t\t};\r\n\r\n\t\tfor (var i in pos.coords) {\r\n\t\t\tif (typeof pos.coords[i] === 'number') {\r\n\t\t\t\tdata[i] = pos.coords[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.fire('locationfound', data);\r\n\t}\r\n});\r\n\n\n}(window, document));","module.exports = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n","\n// Copyright (C) 2010 Google Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview\n * Implements RFC 3986 for parsing/formatting URIs.\n *\n * @author mikesamuel@gmail.com\n * \\@provides URI\n * \\@overrides window\n */\n\nvar URI = (function () {\n\n/**\n * creates a uri from the string form.  The parser is relaxed, so special\n * characters that aren't escaped but don't cause ambiguities will not cause\n * parse failures.\n *\n * @return {URI|null}\n */\nfunction parse(uriStr) {\n  var m = ('' + uriStr).match(URI_RE_);\n  if (!m) { return null; }\n  return new URI(\n      nullIfAbsent(m[1]),\n      nullIfAbsent(m[2]),\n      nullIfAbsent(m[3]),\n      nullIfAbsent(m[4]),\n      nullIfAbsent(m[5]),\n      nullIfAbsent(m[6]),\n      nullIfAbsent(m[7]));\n}\n\n\n/**\n * creates a uri from the given parts.\n *\n * @param scheme {string} an unencoded scheme such as \"http\" or null\n * @param credentials {string} unencoded user credentials or null\n * @param domain {string} an unencoded domain name or null\n * @param port {number} a port number in [1, 32768].\n *    -1 indicates no port, as does null.\n * @param path {string} an unencoded path\n * @param query {Array.<string>|string|null} a list of unencoded cgi\n *   parameters where even values are keys and odds the corresponding values\n *   or an unencoded query.\n * @param fragment {string} an unencoded fragment without the \"#\" or null.\n * @return {URI}\n */\nfunction create(scheme, credentials, domain, port, path, query, fragment) {\n  var uri = new URI(\n      encodeIfExists2(scheme, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_),\n      encodeIfExists2(\n          credentials, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_),\n      encodeIfExists(domain),\n      port > 0 ? port.toString() : null,\n      encodeIfExists2(path, URI_DISALLOWED_IN_PATH_),\n      null,\n      encodeIfExists(fragment));\n  if (query) {\n    if ('string' === typeof query) {\n      uri.setRawQuery(query.replace(/[^?&=0-9A-Za-z_\\-~.%]/g, encodeOne));\n    } else {\n      uri.setAllParameters(query);\n    }\n  }\n  return uri;\n}\nfunction encodeIfExists(unescapedPart) {\n  if ('string' == typeof unescapedPart) {\n    return encodeURIComponent(unescapedPart);\n  }\n  return null;\n};\n/**\n * if unescapedPart is non null, then escapes any characters in it that aren't\n * valid characters in a url and also escapes any special characters that\n * appear in extra.\n *\n * @param unescapedPart {string}\n * @param extra {RegExp} a character set of characters in [\\01-\\177].\n * @return {string|null} null iff unescapedPart == null.\n */\nfunction encodeIfExists2(unescapedPart, extra) {\n  if ('string' == typeof unescapedPart) {\n    return encodeURI(unescapedPart).replace(extra, encodeOne);\n  }\n  return null;\n};\n/** converts a character in [\\01-\\177] to its url encoded equivalent. */\nfunction encodeOne(ch) {\n  var n = ch.charCodeAt(0);\n  return '%' + '0123456789ABCDEF'.charAt((n >> 4) & 0xf) +\n      '0123456789ABCDEF'.charAt(n & 0xf);\n}\n\n/**\n * {@updoc\n *  $ normPath('foo/./bar')\n *  # 'foo/bar'\n *  $ normPath('./foo')\n *  # 'foo'\n *  $ normPath('foo/.')\n *  # 'foo'\n *  $ normPath('foo//bar')\n *  # 'foo/bar'\n * }\n */\nfunction normPath(path) {\n  return path.replace(/(^|\\/)\\.(?:\\/|$)/g, '$1').replace(/\\/{2,}/g, '/');\n}\n\nvar PARENT_DIRECTORY_HANDLER = new RegExp(\n    ''\n    // A path break\n    + '(/|^)'\n    // followed by a non .. path element\n    // (cannot be . because normPath is used prior to this RegExp)\n    + '(?:[^./][^/]*|\\\\.{2,}(?:[^./][^/]*)|\\\\.{3,}[^/]*)'\n    // followed by .. followed by a path break.\n    + '/\\\\.\\\\.(?:/|$)');\n\nvar PARENT_DIRECTORY_HANDLER_RE = new RegExp(PARENT_DIRECTORY_HANDLER);\n\nvar EXTRA_PARENT_PATHS_RE = /^(?:\\.\\.\\/)*(?:\\.\\.$)?/;\n\n/**\n * Normalizes its input path and collapses all . and .. sequences except for\n * .. sequences that would take it above the root of the current parent\n * directory.\n * {@updoc\n *  $ collapse_dots('foo/../bar')\n *  # 'bar'\n *  $ collapse_dots('foo/./bar')\n *  # 'foo/bar'\n *  $ collapse_dots('foo/../bar/./../../baz')\n *  # 'baz'\n *  $ collapse_dots('../foo')\n *  # '../foo'\n *  $ collapse_dots('../foo').replace(EXTRA_PARENT_PATHS_RE, '')\n *  # 'foo'\n * }\n */\nfunction collapse_dots(path) {\n  if (path === null) { return null; }\n  var p = normPath(path);\n  // Only /../ left to flatten\n  var r = PARENT_DIRECTORY_HANDLER_RE;\n  // We replace with $1 which matches a / before the .. because this\n  // guarantees that:\n  // (1) we have at most 1 / between the adjacent place,\n  // (2) always have a slash if there is a preceding path section, and\n  // (3) we never turn a relative path into an absolute path.\n  for (var q; (q = p.replace(r, '$1')) != p; p = q) {};\n  return p;\n}\n\n/**\n * resolves a relative url string to a base uri.\n * @return {URI}\n */\nfunction resolve(baseUri, relativeUri) {\n  // there are several kinds of relative urls:\n  // 1. //foo - replaces everything from the domain on.  foo is a domain name\n  // 2. foo - replaces the last part of the path, the whole query and fragment\n  // 3. /foo - replaces the the path, the query and fragment\n  // 4. ?foo - replace the query and fragment\n  // 5. #foo - replace the fragment only\n\n  var absoluteUri = baseUri.clone();\n  // we satisfy these conditions by looking for the first part of relativeUri\n  // that is not blank and applying defaults to the rest\n\n  var overridden = relativeUri.hasScheme();\n\n  if (overridden) {\n    absoluteUri.setRawScheme(relativeUri.getRawScheme());\n  } else {\n    overridden = relativeUri.hasCredentials();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawCredentials(relativeUri.getRawCredentials());\n  } else {\n    overridden = relativeUri.hasDomain();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawDomain(relativeUri.getRawDomain());\n  } else {\n    overridden = relativeUri.hasPort();\n  }\n\n  var rawPath = relativeUri.getRawPath();\n  var simplifiedPath = collapse_dots(rawPath);\n  if (overridden) {\n    absoluteUri.setPort(relativeUri.getPort());\n    simplifiedPath = simplifiedPath\n        && simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, '');\n  } else {\n    overridden = !!rawPath;\n    if (overridden) {\n      // resolve path properly\n      if (simplifiedPath.charCodeAt(0) !== 0x2f /* / */) {  // path is relative\n        var absRawPath = collapse_dots(absoluteUri.getRawPath() || '')\n            .replace(EXTRA_PARENT_PATHS_RE, '');\n        var slash = absRawPath.lastIndexOf('/') + 1;\n        simplifiedPath = collapse_dots(\n            (slash ? absRawPath.substring(0, slash) : '')\n            + collapse_dots(rawPath))\n            .replace(EXTRA_PARENT_PATHS_RE, '');\n      }\n    } else {\n      simplifiedPath = simplifiedPath\n          && simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, '');\n      if (simplifiedPath !== rawPath) {\n        absoluteUri.setRawPath(simplifiedPath);\n      }\n    }\n  }\n\n  if (overridden) {\n    absoluteUri.setRawPath(simplifiedPath);\n  } else {\n    overridden = relativeUri.hasQuery();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawQuery(relativeUri.getRawQuery());\n  } else {\n    overridden = relativeUri.hasFragment();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawFragment(relativeUri.getRawFragment());\n  }\n\n  return absoluteUri;\n}\n\n/**\n * a mutable URI.\n *\n * This class contains setters and getters for the parts of the URI.\n * The <tt>getXYZ</tt>/<tt>setXYZ</tt> methods return the decoded part -- so\n * <code>uri.parse('/foo%20bar').getPath()</code> will return the decoded path,\n * <tt>/foo bar</tt>.\n *\n * <p>The raw versions of fields are available too.\n * <code>uri.parse('/foo%20bar').getRawPath()</code> will return the raw path,\n * <tt>/foo%20bar</tt>.  Use the raw setters with care, since\n * <code>URI::toString</code> is not guaranteed to return a valid url if a\n * raw setter was used.\n *\n * <p>All setters return <tt>this</tt> and so may be chained, a la\n * <code>uri.parse('/foo').setFragment('part').toString()</code>.\n *\n * <p>You should not use this constructor directly -- please prefer the factory\n * functions {@link uri.parse}, {@link uri.create}, {@link uri.resolve}\n * instead.</p>\n *\n * <p>The parameters are all raw (assumed to be properly escaped) parts, and\n * any (but not all) may be null.  Undefined is not allowed.</p>\n *\n * @constructor\n */\nfunction URI(\n    rawScheme,\n    rawCredentials, rawDomain, port,\n    rawPath, rawQuery, rawFragment) {\n  this.scheme_ = rawScheme;\n  this.credentials_ = rawCredentials;\n  this.domain_ = rawDomain;\n  this.port_ = port;\n  this.path_ = rawPath;\n  this.query_ = rawQuery;\n  this.fragment_ = rawFragment;\n  /**\n   * @type {Array|null}\n   */\n  this.paramCache_ = null;\n}\n\n/** returns the string form of the url. */\nURI.prototype.toString = function () {\n  var out = [];\n  if (null !== this.scheme_) { out.push(this.scheme_, ':'); }\n  if (null !== this.domain_) {\n    out.push('//');\n    if (null !== this.credentials_) { out.push(this.credentials_, '@'); }\n    out.push(this.domain_);\n    if (null !== this.port_) { out.push(':', this.port_.toString()); }\n  }\n  if (null !== this.path_) { out.push(this.path_); }\n  if (null !== this.query_) { out.push('?', this.query_); }\n  if (null !== this.fragment_) { out.push('#', this.fragment_); }\n  return out.join('');\n};\n\nURI.prototype.clone = function () {\n  return new URI(this.scheme_, this.credentials_, this.domain_, this.port_,\n                 this.path_, this.query_, this.fragment_);\n};\n\nURI.prototype.getScheme = function () {\n  // HTML5 spec does not require the scheme to be lowercased but\n  // all common browsers except Safari lowercase the scheme.\n  return this.scheme_ && decodeURIComponent(this.scheme_).toLowerCase();\n};\nURI.prototype.getRawScheme = function () {\n  return this.scheme_;\n};\nURI.prototype.setScheme = function (newScheme) {\n  this.scheme_ = encodeIfExists2(\n      newScheme, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_);\n  return this;\n};\nURI.prototype.setRawScheme = function (newScheme) {\n  this.scheme_ = newScheme ? newScheme : null;\n  return this;\n};\nURI.prototype.hasScheme = function () {\n  return null !== this.scheme_;\n};\n\n\nURI.prototype.getCredentials = function () {\n  return this.credentials_ && decodeURIComponent(this.credentials_);\n};\nURI.prototype.getRawCredentials = function () {\n  return this.credentials_;\n};\nURI.prototype.setCredentials = function (newCredentials) {\n  this.credentials_ = encodeIfExists2(\n      newCredentials, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_);\n\n  return this;\n};\nURI.prototype.setRawCredentials = function (newCredentials) {\n  this.credentials_ = newCredentials ? newCredentials : null;\n  return this;\n};\nURI.prototype.hasCredentials = function () {\n  return null !== this.credentials_;\n};\n\n\nURI.prototype.getDomain = function () {\n  return this.domain_ && decodeURIComponent(this.domain_);\n};\nURI.prototype.getRawDomain = function () {\n  return this.domain_;\n};\nURI.prototype.setDomain = function (newDomain) {\n  return this.setRawDomain(newDomain && encodeURIComponent(newDomain));\n};\nURI.prototype.setRawDomain = function (newDomain) {\n  this.domain_ = newDomain ? newDomain : null;\n  // Maintain the invariant that paths must start with a slash when the URI\n  // is not path-relative.\n  return this.setRawPath(this.path_);\n};\nURI.prototype.hasDomain = function () {\n  return null !== this.domain_;\n};\n\n\nURI.prototype.getPort = function () {\n  return this.port_ && decodeURIComponent(this.port_);\n};\nURI.prototype.setPort = function (newPort) {\n  if (newPort) {\n    newPort = Number(newPort);\n    if (newPort !== (newPort & 0xffff)) {\n      throw new Error('Bad port number ' + newPort);\n    }\n    this.port_ = '' + newPort;\n  } else {\n    this.port_ = null;\n  }\n  return this;\n};\nURI.prototype.hasPort = function () {\n  return null !== this.port_;\n};\n\n\nURI.prototype.getPath = function () {\n  return this.path_ && decodeURIComponent(this.path_);\n};\nURI.prototype.getRawPath = function () {\n  return this.path_;\n};\nURI.prototype.setPath = function (newPath) {\n  return this.setRawPath(encodeIfExists2(newPath, URI_DISALLOWED_IN_PATH_));\n};\nURI.prototype.setRawPath = function (newPath) {\n  if (newPath) {\n    newPath = String(newPath);\n    this.path_ = \n      // Paths must start with '/' unless this is a path-relative URL.\n      (!this.domain_ || /^\\//.test(newPath)) ? newPath : '/' + newPath;\n  } else {\n    this.path_ = null;\n  }\n  return this;\n};\nURI.prototype.hasPath = function () {\n  return null !== this.path_;\n};\n\n\nURI.prototype.getQuery = function () {\n  // From http://www.w3.org/Addressing/URL/4_URI_Recommentations.html\n  // Within the query string, the plus sign is reserved as shorthand notation\n  // for a space.\n  return this.query_ && decodeURIComponent(this.query_).replace(/\\+/g, ' ');\n};\nURI.prototype.getRawQuery = function () {\n  return this.query_;\n};\nURI.prototype.setQuery = function (newQuery) {\n  this.paramCache_ = null;\n  this.query_ = encodeIfExists(newQuery);\n  return this;\n};\nURI.prototype.setRawQuery = function (newQuery) {\n  this.paramCache_ = null;\n  this.query_ = newQuery ? newQuery : null;\n  return this;\n};\nURI.prototype.hasQuery = function () {\n  return null !== this.query_;\n};\n\n/**\n * sets the query given a list of strings of the form\n * [ key0, value0, key1, value1, ... ].\n *\n * <p><code>uri.setAllParameters(['a', 'b', 'c', 'd']).getQuery()</code>\n * will yield <code>'a=b&c=d'</code>.\n */\nURI.prototype.setAllParameters = function (params) {\n  if (typeof params === 'object') {\n    if (!(params instanceof Array)\n        && (params instanceof Object\n            || Object.prototype.toString.call(params) !== '[object Array]')) {\n      var newParams = [];\n      var i = -1;\n      for (var k in params) {\n        var v = params[k];\n        if ('string' === typeof v) {\n          newParams[++i] = k;\n          newParams[++i] = v;\n        }\n      }\n      params = newParams;\n    }\n  }\n  this.paramCache_ = null;\n  var queryBuf = [];\n  var separator = '';\n  for (var j = 0; j < params.length;) {\n    var k = params[j++];\n    var v = params[j++];\n    queryBuf.push(separator, encodeURIComponent(k.toString()));\n    separator = '&';\n    if (v) {\n      queryBuf.push('=', encodeURIComponent(v.toString()));\n    }\n  }\n  this.query_ = queryBuf.join('');\n  return this;\n};\nURI.prototype.checkParameterCache_ = function () {\n  if (!this.paramCache_) {\n    var q = this.query_;\n    if (!q) {\n      this.paramCache_ = [];\n    } else {\n      var cgiParams = q.split(/[&\\?]/);\n      var out = [];\n      var k = -1;\n      for (var i = 0; i < cgiParams.length; ++i) {\n        var m = cgiParams[i].match(/^([^=]*)(?:=(.*))?$/);\n        // From http://www.w3.org/Addressing/URL/4_URI_Recommentations.html\n        // Within the query string, the plus sign is reserved as shorthand\n        // notation for a space.\n        out[++k] = decodeURIComponent(m[1]).replace(/\\+/g, ' ');\n        out[++k] = decodeURIComponent(m[2] || '').replace(/\\+/g, ' ');\n      }\n      this.paramCache_ = out;\n    }\n  }\n};\n/**\n * sets the values of the named cgi parameters.\n *\n * <p>So, <code>uri.parse('foo?a=b&c=d&e=f').setParameterValues('c', ['new'])\n * </code> yields <tt>foo?a=b&c=new&e=f</tt>.</p>\n *\n * @param key {string}\n * @param values {Array.<string>} the new values.  If values is a single string\n *   then it will be treated as the sole value.\n */\nURI.prototype.setParameterValues = function (key, values) {\n  // be nice and avoid subtle bugs where [] operator on string performs charAt\n  // on some browsers and crashes on IE\n  if (typeof values === 'string') {\n    values = [ values ];\n  }\n\n  this.checkParameterCache_();\n  var newValueIndex = 0;\n  var pc = this.paramCache_;\n  var params = [];\n  for (var i = 0, k = 0; i < pc.length; i += 2) {\n    if (key === pc[i]) {\n      if (newValueIndex < values.length) {\n        params.push(key, values[newValueIndex++]);\n      }\n    } else {\n      params.push(pc[i], pc[i + 1]);\n    }\n  }\n  while (newValueIndex < values.length) {\n    params.push(key, values[newValueIndex++]);\n  }\n  this.setAllParameters(params);\n  return this;\n};\nURI.prototype.removeParameter = function (key) {\n  return this.setParameterValues(key, []);\n};\n/**\n * returns the parameters specified in the query part of the uri as a list of\n * keys and values like [ key0, value0, key1, value1, ... ].\n *\n * @return {Array.<string>}\n */\nURI.prototype.getAllParameters = function () {\n  this.checkParameterCache_();\n  return this.paramCache_.slice(0, this.paramCache_.length);\n};\n/**\n * returns the value<b>s</b> for a given cgi parameter as a list of decoded\n * query parameter values.\n * @return {Array.<string>}\n */\nURI.prototype.getParameterValues = function (paramNameUnescaped) {\n  this.checkParameterCache_();\n  var values = [];\n  for (var i = 0; i < this.paramCache_.length; i += 2) {\n    if (paramNameUnescaped === this.paramCache_[i]) {\n      values.push(this.paramCache_[i + 1]);\n    }\n  }\n  return values;\n};\n/**\n * returns a map of cgi parameter names to (non-empty) lists of values.\n * @return {Object.<string,Array.<string>>}\n */\nURI.prototype.getParameterMap = function (paramNameUnescaped) {\n  this.checkParameterCache_();\n  var paramMap = {};\n  for (var i = 0; i < this.paramCache_.length; i += 2) {\n    var key = this.paramCache_[i++],\n      value = this.paramCache_[i++];\n    if (!(key in paramMap)) {\n      paramMap[key] = [value];\n    } else {\n      paramMap[key].push(value);\n    }\n  }\n  return paramMap;\n};\n/**\n * returns the first value for a given cgi parameter or null if the given\n * parameter name does not appear in the query string.\n * If the given parameter name does appear, but has no '<tt>=</tt>' following\n * it, then the empty string will be returned.\n * @return {string|null}\n */\nURI.prototype.getParameterValue = function (paramNameUnescaped) {\n  this.checkParameterCache_();\n  for (var i = 0; i < this.paramCache_.length; i += 2) {\n    if (paramNameUnescaped === this.paramCache_[i]) {\n      return this.paramCache_[i + 1];\n    }\n  }\n  return null;\n};\n\nURI.prototype.getFragment = function () {\n  return this.fragment_ && decodeURIComponent(this.fragment_);\n};\nURI.prototype.getRawFragment = function () {\n  return this.fragment_;\n};\nURI.prototype.setFragment = function (newFragment) {\n  this.fragment_ = newFragment ? encodeURIComponent(newFragment) : null;\n  return this;\n};\nURI.prototype.setRawFragment = function (newFragment) {\n  this.fragment_ = newFragment ? newFragment : null;\n  return this;\n};\nURI.prototype.hasFragment = function () {\n  return null !== this.fragment_;\n};\n\nfunction nullIfAbsent(matchPart) {\n  return ('string' == typeof matchPart) && (matchPart.length > 0)\n         ? matchPart\n         : null;\n}\n\n\n\n\n/**\n * a regular expression for breaking a URI into its component parts.\n *\n * <p>http://www.gbiv.com/protocols/uri/rfc/rfc3986.html#RFC2234 says\n * As the \"first-match-wins\" algorithm is identical to the \"greedy\"\n * disambiguation method used by POSIX regular expressions, it is natural and\n * commonplace to use a regular expression for parsing the potential five\n * components of a URI reference.\n *\n * <p>The following line is the regular expression for breaking-down a\n * well-formed URI reference into its components.\n *\n * <pre>\n * ^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?\n *  12            3  4          5       6  7        8 9\n * </pre>\n *\n * <p>The numbers in the second line above are only to assist readability; they\n * indicate the reference points for each subexpression (i.e., each paired\n * parenthesis). We refer to the value matched for subexpression <n> as $<n>.\n * For example, matching the above expression to\n * <pre>\n *     http://www.ics.uci.edu/pub/ietf/uri/#Related\n * </pre>\n * results in the following subexpression matches:\n * <pre>\n *    $1 = http:\n *    $2 = http\n *    $3 = //www.ics.uci.edu\n *    $4 = www.ics.uci.edu\n *    $5 = /pub/ietf/uri/\n *    $6 = <undefined>\n *    $7 = <undefined>\n *    $8 = #Related\n *    $9 = Related\n * </pre>\n * where <undefined> indicates that the component is not present, as is the\n * case for the query component in the above example. Therefore, we can\n * determine the value of the five components as\n * <pre>\n *    scheme    = $2\n *    authority = $4\n *    path      = $5\n *    query     = $7\n *    fragment  = $9\n * </pre>\n *\n * <p>msamuel: I have modified the regular expression slightly to expose the\n * credentials, domain, and port separately from the authority.\n * The modified version yields\n * <pre>\n *    $1 = http              scheme\n *    $2 = <undefined>       credentials -\\\n *    $3 = www.ics.uci.edu   domain       | authority\n *    $4 = <undefined>       port        -/\n *    $5 = /pub/ietf/uri/    path\n *    $6 = <undefined>       query without ?\n *    $7 = Related           fragment without #\n * </pre>\n */\nvar URI_RE_ = new RegExp(\n      \"^\" +\n      \"(?:\" +\n        \"([^:/?#]+)\" +         // scheme\n      \":)?\" +\n      \"(?://\" +\n        \"(?:([^/?#]*)@)?\" +    // credentials\n        \"([^/?#:@]*)\" +        // domain\n        \"(?::([0-9]+))?\" +     // port\n      \")?\" +\n      \"([^?#]+)?\" +            // path\n      \"(?:\\\\?([^#]*))?\" +      // query\n      \"(?:#(.*))?\" +           // fragment\n      \"$\"\n      );\n\nvar URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_ = /[#\\/\\?@]/g;\nvar URI_DISALLOWED_IN_PATH_ = /[\\#\\?]/g;\n\nURI.parse = parse;\nURI.create = create;\nURI.resolve = resolve;\nURI.collapse_dots = collapse_dots;  // Visible for testing.\n\n// lightweight string-based api for loadModuleMaker\nURI.utils = {\n  mimeTypeOf: function (uri) {\n    var uriObj = parse(uri);\n    if (/\\.html$/.test(uriObj.getPath())) {\n      return 'text/html';\n    } else {\n      return 'application/javascript';\n    }\n  },\n  resolve: function (base, uri) {\n    if (base) {\n      return resolve(parse(base), parse(uri)).toString();\n    } else {\n      return '' + uri;\n    }\n  }\n};\n\n\nreturn URI;\n})();\n\n// Copyright Google Inc.\n// Licensed under the Apache Licence Version 2.0\n// Autogenerated at Mon Feb 25 13:05:42 EST 2013\n// @overrides window\n// @provides html4\nvar html4 = {};\nhtml4.atype = {\n  'NONE': 0,\n  'URI': 1,\n  'URI_FRAGMENT': 11,\n  'SCRIPT': 2,\n  'STYLE': 3,\n  'HTML': 12,\n  'ID': 4,\n  'IDREF': 5,\n  'IDREFS': 6,\n  'GLOBAL_NAME': 7,\n  'LOCAL_NAME': 8,\n  'CLASSES': 9,\n  'FRAME_TARGET': 10,\n  'MEDIA_QUERY': 13\n};\nhtml4[ 'atype' ] = html4.atype;\nhtml4.ATTRIBS = {\n  '*::class': 9,\n  '*::dir': 0,\n  '*::draggable': 0,\n  '*::hidden': 0,\n  '*::id': 4,\n  '*::inert': 0,\n  '*::itemprop': 0,\n  '*::itemref': 6,\n  '*::itemscope': 0,\n  '*::lang': 0,\n  '*::onblur': 2,\n  '*::onchange': 2,\n  '*::onclick': 2,\n  '*::ondblclick': 2,\n  '*::onfocus': 2,\n  '*::onkeydown': 2,\n  '*::onkeypress': 2,\n  '*::onkeyup': 2,\n  '*::onload': 2,\n  '*::onmousedown': 2,\n  '*::onmousemove': 2,\n  '*::onmouseout': 2,\n  '*::onmouseover': 2,\n  '*::onmouseup': 2,\n  '*::onreset': 2,\n  '*::onscroll': 2,\n  '*::onselect': 2,\n  '*::onsubmit': 2,\n  '*::onunload': 2,\n  '*::spellcheck': 0,\n  '*::style': 3,\n  '*::title': 0,\n  '*::translate': 0,\n  'a::accesskey': 0,\n  'a::coords': 0,\n  'a::href': 1,\n  'a::hreflang': 0,\n  'a::name': 7,\n  'a::onblur': 2,\n  'a::onfocus': 2,\n  'a::shape': 0,\n  'a::tabindex': 0,\n  'a::target': 10,\n  'a::type': 0,\n  'area::accesskey': 0,\n  'area::alt': 0,\n  'area::coords': 0,\n  'area::href': 1,\n  'area::nohref': 0,\n  'area::onblur': 2,\n  'area::onfocus': 2,\n  'area::shape': 0,\n  'area::tabindex': 0,\n  'area::target': 10,\n  'audio::controls': 0,\n  'audio::loop': 0,\n  'audio::mediagroup': 5,\n  'audio::muted': 0,\n  'audio::preload': 0,\n  'bdo::dir': 0,\n  'blockquote::cite': 1,\n  'br::clear': 0,\n  'button::accesskey': 0,\n  'button::disabled': 0,\n  'button::name': 8,\n  'button::onblur': 2,\n  'button::onfocus': 2,\n  'button::tabindex': 0,\n  'button::type': 0,\n  'button::value': 0,\n  'canvas::height': 0,\n  'canvas::width': 0,\n  'caption::align': 0,\n  'col::align': 0,\n  'col::char': 0,\n  'col::charoff': 0,\n  'col::span': 0,\n  'col::valign': 0,\n  'col::width': 0,\n  'colgroup::align': 0,\n  'colgroup::char': 0,\n  'colgroup::charoff': 0,\n  'colgroup::span': 0,\n  'colgroup::valign': 0,\n  'colgroup::width': 0,\n  'command::checked': 0,\n  'command::command': 5,\n  'command::disabled': 0,\n  'command::icon': 1,\n  'command::label': 0,\n  'command::radiogroup': 0,\n  'command::type': 0,\n  'data::value': 0,\n  'del::cite': 1,\n  'del::datetime': 0,\n  'details::open': 0,\n  'dir::compact': 0,\n  'div::align': 0,\n  'dl::compact': 0,\n  'fieldset::disabled': 0,\n  'font::color': 0,\n  'font::face': 0,\n  'font::size': 0,\n  'form::accept': 0,\n  'form::action': 1,\n  'form::autocomplete': 0,\n  'form::enctype': 0,\n  'form::method': 0,\n  'form::name': 7,\n  'form::novalidate': 0,\n  'form::onreset': 2,\n  'form::onsubmit': 2,\n  'form::target': 10,\n  'h1::align': 0,\n  'h2::align': 0,\n  'h3::align': 0,\n  'h4::align': 0,\n  'h5::align': 0,\n  'h6::align': 0,\n  'hr::align': 0,\n  'hr::noshade': 0,\n  'hr::size': 0,\n  'hr::width': 0,\n  'iframe::align': 0,\n  'iframe::frameborder': 0,\n  'iframe::height': 0,\n  'iframe::marginheight': 0,\n  'iframe::marginwidth': 0,\n  'iframe::width': 0,\n  'img::align': 0,\n  'img::alt': 0,\n  'img::border': 0,\n  'img::height': 0,\n  'img::hspace': 0,\n  'img::ismap': 0,\n  'img::name': 7,\n  'img::src': 1,\n  'img::usemap': 11,\n  'img::vspace': 0,\n  'img::width': 0,\n  'input::accept': 0,\n  'input::accesskey': 0,\n  'input::align': 0,\n  'input::alt': 0,\n  'input::autocomplete': 0,\n  'input::checked': 0,\n  'input::disabled': 0,\n  'input::inputmode': 0,\n  'input::ismap': 0,\n  'input::list': 5,\n  'input::max': 0,\n  'input::maxlength': 0,\n  'input::min': 0,\n  'input::multiple': 0,\n  'input::name': 8,\n  'input::onblur': 2,\n  'input::onchange': 2,\n  'input::onfocus': 2,\n  'input::onselect': 2,\n  'input::placeholder': 0,\n  'input::readonly': 0,\n  'input::required': 0,\n  'input::size': 0,\n  'input::src': 1,\n  'input::step': 0,\n  'input::tabindex': 0,\n  'input::type': 0,\n  'input::usemap': 11,\n  'input::value': 0,\n  'ins::cite': 1,\n  'ins::datetime': 0,\n  'label::accesskey': 0,\n  'label::for': 5,\n  'label::onblur': 2,\n  'label::onfocus': 2,\n  'legend::accesskey': 0,\n  'legend::align': 0,\n  'li::type': 0,\n  'li::value': 0,\n  'map::name': 7,\n  'menu::compact': 0,\n  'menu::label': 0,\n  'menu::type': 0,\n  'meter::high': 0,\n  'meter::low': 0,\n  'meter::max': 0,\n  'meter::min': 0,\n  'meter::value': 0,\n  'ol::compact': 0,\n  'ol::reversed': 0,\n  'ol::start': 0,\n  'ol::type': 0,\n  'optgroup::disabled': 0,\n  'optgroup::label': 0,\n  'option::disabled': 0,\n  'option::label': 0,\n  'option::selected': 0,\n  'option::value': 0,\n  'output::for': 6,\n  'output::name': 8,\n  'p::align': 0,\n  'pre::width': 0,\n  'progress::max': 0,\n  'progress::min': 0,\n  'progress::value': 0,\n  'q::cite': 1,\n  'select::autocomplete': 0,\n  'select::disabled': 0,\n  'select::multiple': 0,\n  'select::name': 8,\n  'select::onblur': 2,\n  'select::onchange': 2,\n  'select::onfocus': 2,\n  'select::required': 0,\n  'select::size': 0,\n  'select::tabindex': 0,\n  'source::type': 0,\n  'table::align': 0,\n  'table::bgcolor': 0,\n  'table::border': 0,\n  'table::cellpadding': 0,\n  'table::cellspacing': 0,\n  'table::frame': 0,\n  'table::rules': 0,\n  'table::summary': 0,\n  'table::width': 0,\n  'tbody::align': 0,\n  'tbody::char': 0,\n  'tbody::charoff': 0,\n  'tbody::valign': 0,\n  'td::abbr': 0,\n  'td::align': 0,\n  'td::axis': 0,\n  'td::bgcolor': 0,\n  'td::char': 0,\n  'td::charoff': 0,\n  'td::colspan': 0,\n  'td::headers': 6,\n  'td::height': 0,\n  'td::nowrap': 0,\n  'td::rowspan': 0,\n  'td::scope': 0,\n  'td::valign': 0,\n  'td::width': 0,\n  'textarea::accesskey': 0,\n  'textarea::autocomplete': 0,\n  'textarea::cols': 0,\n  'textarea::disabled': 0,\n  'textarea::inputmode': 0,\n  'textarea::name': 8,\n  'textarea::onblur': 2,\n  'textarea::onchange': 2,\n  'textarea::onfocus': 2,\n  'textarea::onselect': 2,\n  'textarea::placeholder': 0,\n  'textarea::readonly': 0,\n  'textarea::required': 0,\n  'textarea::rows': 0,\n  'textarea::tabindex': 0,\n  'textarea::wrap': 0,\n  'tfoot::align': 0,\n  'tfoot::char': 0,\n  'tfoot::charoff': 0,\n  'tfoot::valign': 0,\n  'th::abbr': 0,\n  'th::align': 0,\n  'th::axis': 0,\n  'th::bgcolor': 0,\n  'th::char': 0,\n  'th::charoff': 0,\n  'th::colspan': 0,\n  'th::headers': 6,\n  'th::height': 0,\n  'th::nowrap': 0,\n  'th::rowspan': 0,\n  'th::scope': 0,\n  'th::valign': 0,\n  'th::width': 0,\n  'thead::align': 0,\n  'thead::char': 0,\n  'thead::charoff': 0,\n  'thead::valign': 0,\n  'tr::align': 0,\n  'tr::bgcolor': 0,\n  'tr::char': 0,\n  'tr::charoff': 0,\n  'tr::valign': 0,\n  'track::default': 0,\n  'track::kind': 0,\n  'track::label': 0,\n  'track::srclang': 0,\n  'ul::compact': 0,\n  'ul::type': 0,\n  'video::controls': 0,\n  'video::height': 0,\n  'video::loop': 0,\n  'video::mediagroup': 5,\n  'video::muted': 0,\n  'video::poster': 1,\n  'video::preload': 0,\n  'video::width': 0\n};\nhtml4[ 'ATTRIBS' ] = html4.ATTRIBS;\nhtml4.eflags = {\n  'OPTIONAL_ENDTAG': 1,\n  'EMPTY': 2,\n  'CDATA': 4,\n  'RCDATA': 8,\n  'UNSAFE': 16,\n  'FOLDABLE': 32,\n  'SCRIPT': 64,\n  'STYLE': 128,\n  'VIRTUALIZED': 256\n};\nhtml4[ 'eflags' ] = html4.eflags;\n// these are bitmasks of the eflags above.\nhtml4.ELEMENTS = {\n  'a': 0,\n  'abbr': 0,\n  'acronym': 0,\n  'address': 0,\n  'applet': 272,\n  'area': 2,\n  'article': 0,\n  'aside': 0,\n  'audio': 0,\n  'b': 0,\n  'base': 274,\n  'basefont': 274,\n  'bdi': 0,\n  'bdo': 0,\n  'big': 0,\n  'blockquote': 0,\n  'body': 305,\n  'br': 2,\n  'button': 0,\n  'canvas': 0,\n  'caption': 0,\n  'center': 0,\n  'cite': 0,\n  'code': 0,\n  'col': 2,\n  'colgroup': 1,\n  'command': 2,\n  'data': 0,\n  'datalist': 0,\n  'dd': 1,\n  'del': 0,\n  'details': 0,\n  'dfn': 0,\n  'dialog': 272,\n  'dir': 0,\n  'div': 0,\n  'dl': 0,\n  'dt': 1,\n  'em': 0,\n  'fieldset': 0,\n  'figcaption': 0,\n  'figure': 0,\n  'font': 0,\n  'footer': 0,\n  'form': 0,\n  'frame': 274,\n  'frameset': 272,\n  'h1': 0,\n  'h2': 0,\n  'h3': 0,\n  'h4': 0,\n  'h5': 0,\n  'h6': 0,\n  'head': 305,\n  'header': 0,\n  'hgroup': 0,\n  'hr': 2,\n  'html': 305,\n  'i': 0,\n  'iframe': 16,\n  'img': 2,\n  'input': 2,\n  'ins': 0,\n  'isindex': 274,\n  'kbd': 0,\n  'keygen': 274,\n  'label': 0,\n  'legend': 0,\n  'li': 1,\n  'link': 274,\n  'map': 0,\n  'mark': 0,\n  'menu': 0,\n  'meta': 274,\n  'meter': 0,\n  'nav': 0,\n  'nobr': 0,\n  'noembed': 276,\n  'noframes': 276,\n  'noscript': 276,\n  'object': 272,\n  'ol': 0,\n  'optgroup': 0,\n  'option': 1,\n  'output': 0,\n  'p': 1,\n  'param': 274,\n  'pre': 0,\n  'progress': 0,\n  'q': 0,\n  's': 0,\n  'samp': 0,\n  'script': 84,\n  'section': 0,\n  'select': 0,\n  'small': 0,\n  'source': 2,\n  'span': 0,\n  'strike': 0,\n  'strong': 0,\n  'style': 148,\n  'sub': 0,\n  'summary': 0,\n  'sup': 0,\n  'table': 0,\n  'tbody': 1,\n  'td': 1,\n  'textarea': 8,\n  'tfoot': 1,\n  'th': 1,\n  'thead': 1,\n  'time': 0,\n  'title': 280,\n  'tr': 1,\n  'track': 2,\n  'tt': 0,\n  'u': 0,\n  'ul': 0,\n  'var': 0,\n  'video': 0,\n  'wbr': 2\n};\nhtml4[ 'ELEMENTS' ] = html4.ELEMENTS;\nhtml4.ELEMENT_DOM_INTERFACES = {\n  'a': 'HTMLAnchorElement',\n  'abbr': 'HTMLElement',\n  'acronym': 'HTMLElement',\n  'address': 'HTMLElement',\n  'applet': 'HTMLAppletElement',\n  'area': 'HTMLAreaElement',\n  'article': 'HTMLElement',\n  'aside': 'HTMLElement',\n  'audio': 'HTMLAudioElement',\n  'b': 'HTMLElement',\n  'base': 'HTMLBaseElement',\n  'basefont': 'HTMLBaseFontElement',\n  'bdi': 'HTMLElement',\n  'bdo': 'HTMLElement',\n  'big': 'HTMLElement',\n  'blockquote': 'HTMLQuoteElement',\n  'body': 'HTMLBodyElement',\n  'br': 'HTMLBRElement',\n  'button': 'HTMLButtonElement',\n  'canvas': 'HTMLCanvasElement',\n  'caption': 'HTMLTableCaptionElement',\n  'center': 'HTMLElement',\n  'cite': 'HTMLElement',\n  'code': 'HTMLElement',\n  'col': 'HTMLTableColElement',\n  'colgroup': 'HTMLTableColElement',\n  'command': 'HTMLCommandElement',\n  'data': 'HTMLElement',\n  'datalist': 'HTMLDataListElement',\n  'dd': 'HTMLElement',\n  'del': 'HTMLModElement',\n  'details': 'HTMLDetailsElement',\n  'dfn': 'HTMLElement',\n  'dialog': 'HTMLDialogElement',\n  'dir': 'HTMLDirectoryElement',\n  'div': 'HTMLDivElement',\n  'dl': 'HTMLDListElement',\n  'dt': 'HTMLElement',\n  'em': 'HTMLElement',\n  'fieldset': 'HTMLFieldSetElement',\n  'figcaption': 'HTMLElement',\n  'figure': 'HTMLElement',\n  'font': 'HTMLFontElement',\n  'footer': 'HTMLElement',\n  'form': 'HTMLFormElement',\n  'frame': 'HTMLFrameElement',\n  'frameset': 'HTMLFrameSetElement',\n  'h1': 'HTMLHeadingElement',\n  'h2': 'HTMLHeadingElement',\n  'h3': 'HTMLHeadingElement',\n  'h4': 'HTMLHeadingElement',\n  'h5': 'HTMLHeadingElement',\n  'h6': 'HTMLHeadingElement',\n  'head': 'HTMLHeadElement',\n  'header': 'HTMLElement',\n  'hgroup': 'HTMLElement',\n  'hr': 'HTMLHRElement',\n  'html': 'HTMLHtmlElement',\n  'i': 'HTMLElement',\n  'iframe': 'HTMLIFrameElement',\n  'img': 'HTMLImageElement',\n  'input': 'HTMLInputElement',\n  'ins': 'HTMLModElement',\n  'isindex': 'HTMLUnknownElement',\n  'kbd': 'HTMLElement',\n  'keygen': 'HTMLKeygenElement',\n  'label': 'HTMLLabelElement',\n  'legend': 'HTMLLegendElement',\n  'li': 'HTMLLIElement',\n  'link': 'HTMLLinkElement',\n  'map': 'HTMLMapElement',\n  'mark': 'HTMLElement',\n  'menu': 'HTMLMenuElement',\n  'meta': 'HTMLMetaElement',\n  'meter': 'HTMLMeterElement',\n  'nav': 'HTMLElement',\n  'nobr': 'HTMLElement',\n  'noembed': 'HTMLElement',\n  'noframes': 'HTMLElement',\n  'noscript': 'HTMLElement',\n  'object': 'HTMLObjectElement',\n  'ol': 'HTMLOListElement',\n  'optgroup': 'HTMLOptGroupElement',\n  'option': 'HTMLOptionElement',\n  'output': 'HTMLOutputElement',\n  'p': 'HTMLParagraphElement',\n  'param': 'HTMLParamElement',\n  'pre': 'HTMLPreElement',\n  'progress': 'HTMLProgressElement',\n  'q': 'HTMLQuoteElement',\n  's': 'HTMLElement',\n  'samp': 'HTMLElement',\n  'script': 'HTMLScriptElement',\n  'section': 'HTMLElement',\n  'select': 'HTMLSelectElement',\n  'small': 'HTMLElement',\n  'source': 'HTMLSourceElement',\n  'span': 'HTMLSpanElement',\n  'strike': 'HTMLElement',\n  'strong': 'HTMLElement',\n  'style': 'HTMLStyleElement',\n  'sub': 'HTMLElement',\n  'summary': 'HTMLElement',\n  'sup': 'HTMLElement',\n  'table': 'HTMLTableElement',\n  'tbody': 'HTMLTableSectionElement',\n  'td': 'HTMLTableDataCellElement',\n  'textarea': 'HTMLTextAreaElement',\n  'tfoot': 'HTMLTableSectionElement',\n  'th': 'HTMLTableHeaderCellElement',\n  'thead': 'HTMLTableSectionElement',\n  'time': 'HTMLTimeElement',\n  'title': 'HTMLTitleElement',\n  'tr': 'HTMLTableRowElement',\n  'track': 'HTMLTrackElement',\n  'tt': 'HTMLElement',\n  'u': 'HTMLElement',\n  'ul': 'HTMLUListElement',\n  'var': 'HTMLElement',\n  'video': 'HTMLVideoElement',\n  'wbr': 'HTMLElement'\n};\nhtml4[ 'ELEMENT_DOM_INTERFACES' ] = html4.ELEMENT_DOM_INTERFACES;\nhtml4.ueffects = {\n  'NOT_LOADED': 0,\n  'SAME_DOCUMENT': 1,\n  'NEW_DOCUMENT': 2\n};\nhtml4[ 'ueffects' ] = html4.ueffects;\nhtml4.URIEFFECTS = {\n  'a::href': 2,\n  'area::href': 2,\n  'blockquote::cite': 0,\n  'command::icon': 1,\n  'del::cite': 0,\n  'form::action': 2,\n  'img::src': 1,\n  'input::src': 1,\n  'ins::cite': 0,\n  'q::cite': 0,\n  'video::poster': 1\n};\nhtml4[ 'URIEFFECTS' ] = html4.URIEFFECTS;\nhtml4.ltypes = {\n  'UNSANDBOXED': 2,\n  'SANDBOXED': 1,\n  'DATA': 0\n};\nhtml4[ 'ltypes' ] = html4.ltypes;\nhtml4.LOADERTYPES = {\n  'a::href': 2,\n  'area::href': 2,\n  'blockquote::cite': 2,\n  'command::icon': 1,\n  'del::cite': 2,\n  'form::action': 2,\n  'img::src': 1,\n  'input::src': 1,\n  'ins::cite': 2,\n  'q::cite': 2,\n  'video::poster': 1\n};\nhtml4[ 'LOADERTYPES' ] = html4.LOADERTYPES;\n\n// Copyright (C) 2006 Google Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview\n * An HTML sanitizer that can satisfy a variety of security policies.\n *\n * <p>\n * The HTML sanitizer is built around a SAX parser and HTML element and\n * attributes schemas.\n *\n * If the cssparser is loaded, inline styles are sanitized using the\n * css property and value schemas.  Else they are remove during\n * sanitization.\n *\n * If it exists, uses parseCssDeclarations, sanitizeCssProperty,  cssSchema\n *\n * @author mikesamuel@gmail.com\n * @author jasvir@gmail.com\n * \\@requires html4, URI\n * \\@overrides window\n * \\@provides html, html_sanitize\n */\n\n// The Turkish i seems to be a non-issue, but abort in case it is.\nif ('I'.toLowerCase() !== 'i') { throw 'I/i problem'; }\n\n/**\n * \\@namespace\n */\nvar html = (function(html4) {\n\n  // For closure compiler\n  var parseCssDeclarations, sanitizeCssProperty, cssSchema;\n  if ('undefined' !== typeof window) {\n    parseCssDeclarations = window['parseCssDeclarations'];\n    sanitizeCssProperty = window['sanitizeCssProperty'];\n    cssSchema = window['cssSchema'];\n  }\n\n  // The keys of this object must be 'quoted' or JSCompiler will mangle them!\n  // This is a partial list -- lookupEntity() uses the host browser's parser\n  // (when available) to implement full entity lookup.\n  // Note that entities are in general case-sensitive; the uppercase ones are\n  // explicitly defined by HTML5 (presumably as compatibility).\n  var ENTITIES = {\n    'lt': '<',\n    'LT': '<',\n    'gt': '>',\n    'GT': '>',\n    'amp': '&',\n    'AMP': '&',\n    'quot': '\"',\n    'apos': '\\'',\n    'nbsp': '\\240'\n  };\n\n  // Patterns for types of entity/character reference names.\n  var decimalEscapeRe = /^#(\\d+)$/;\n  var hexEscapeRe = /^#x([0-9A-Fa-f]+)$/;\n  // contains every entity per http://www.w3.org/TR/2011/WD-html5-20110113/named-character-references.html\n  var safeEntityNameRe = /^[A-Za-z][A-za-z0-9]+$/;\n  // Used as a hook to invoke the browser's entity parsing. <textarea> is used\n  // because its content is parsed for entities but not tags.\n  // TODO(kpreid): This retrieval is a kludge and leads to silent loss of\n  // functionality if the document isn't available.\n  var entityLookupElement =\n      ('undefined' !== typeof window && window['document'])\n          ? window['document'].createElement('textarea') : null;\n  /**\n   * Decodes an HTML entity.\n   *\n   * {\\@updoc\n   * $ lookupEntity('lt')\n   * # '<'\n   * $ lookupEntity('GT')\n   * # '>'\n   * $ lookupEntity('amp')\n   * # '&'\n   * $ lookupEntity('nbsp')\n   * # '\\xA0'\n   * $ lookupEntity('apos')\n   * # \"'\"\n   * $ lookupEntity('quot')\n   * # '\"'\n   * $ lookupEntity('#xa')\n   * # '\\n'\n   * $ lookupEntity('#10')\n   * # '\\n'\n   * $ lookupEntity('#x0a')\n   * # '\\n'\n   * $ lookupEntity('#010')\n   * # '\\n'\n   * $ lookupEntity('#x00A')\n   * # '\\n'\n   * $ lookupEntity('Pi')      // Known failure\n   * # '\\u03A0'\n   * $ lookupEntity('pi')      // Known failure\n   * # '\\u03C0'\n   * }\n   *\n   * @param {string} name the content between the '&' and the ';'.\n   * @return {string} a single unicode code-point as a string.\n   */\n  function lookupEntity(name) {\n    // TODO: entity lookup as specified by HTML5 actually depends on the\n    // presence of the \";\".\n    if (ENTITIES.hasOwnProperty(name)) { return ENTITIES[name]; }\n    var m = name.match(decimalEscapeRe);\n    if (m) {\n      return String.fromCharCode(parseInt(m[1], 10));\n    } else if (!!(m = name.match(hexEscapeRe))) {\n      return String.fromCharCode(parseInt(m[1], 16));\n    } else if (entityLookupElement && safeEntityNameRe.test(name)) {\n      entityLookupElement.innerHTML = '&' + name + ';';\n      var text = entityLookupElement.textContent;\n      ENTITIES[name] = text;\n      return text;\n    } else {\n      return '&' + name + ';';\n    }\n  }\n\n  function decodeOneEntity(_, name) {\n    return lookupEntity(name);\n  }\n\n  var nulRe = /\\0/g;\n  function stripNULs(s) {\n    return s.replace(nulRe, '');\n  }\n\n  var ENTITY_RE_1 = /&(#[0-9]+|#[xX][0-9A-Fa-f]+|\\w+);/g;\n  var ENTITY_RE_2 = /^(#[0-9]+|#[xX][0-9A-Fa-f]+|\\w+);/;\n  /**\n   * The plain text of a chunk of HTML CDATA which possibly containing.\n   *\n   * {\\@updoc\n   * $ unescapeEntities('')\n   * # ''\n   * $ unescapeEntities('hello World!')\n   * # 'hello World!'\n   * $ unescapeEntities('1 &lt; 2 &amp;&AMP; 4 &gt; 3&#10;')\n   * # '1 < 2 && 4 > 3\\n'\n   * $ unescapeEntities('&lt;&lt <- unfinished entity&gt;')\n   * # '<&lt <- unfinished entity>'\n   * $ unescapeEntities('/foo?bar=baz&copy=true')  // & often unescaped in URLS\n   * # '/foo?bar=baz&copy=true'\n   * $ unescapeEntities('pi=&pi;&#x3c0;, Pi=&Pi;\\u03A0') // FIXME: known failure\n   * # 'pi=\\u03C0\\u03c0, Pi=\\u03A0\\u03A0'\n   * }\n   *\n   * @param {string} s a chunk of HTML CDATA.  It must not start or end inside\n   *     an HTML entity.\n   */\n  function unescapeEntities(s) {\n    return s.replace(ENTITY_RE_1, decodeOneEntity);\n  }\n\n  var ampRe = /&/g;\n  var looseAmpRe = /&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi;\n  var ltRe = /[<]/g;\n  var gtRe = />/g;\n  var quotRe = /\\\"/g;\n\n  /**\n   * Escapes HTML special characters in attribute values.\n   *\n   * {\\@updoc\n   * $ escapeAttrib('')\n   * # ''\n   * $ escapeAttrib('\"<<&==&>>\"')  // Do not just escape the first occurrence.\n   * # '&#34;&lt;&lt;&amp;&#61;&#61;&amp;&gt;&gt;&#34;'\n   * $ escapeAttrib('Hello <World>!')\n   * # 'Hello &lt;World&gt;!'\n   * }\n   */\n  function escapeAttrib(s) {\n    return ('' + s).replace(ampRe, '&amp;').replace(ltRe, '&lt;')\n        .replace(gtRe, '&gt;').replace(quotRe, '&#34;');\n  }\n\n  /**\n   * Escape entities in RCDATA that can be escaped without changing the meaning.\n   * {\\@updoc\n   * $ normalizeRCData('1 < 2 &&amp; 3 > 4 &amp;& 5 &lt; 7&8')\n   * # '1 &lt; 2 &amp;&amp; 3 &gt; 4 &amp;&amp; 5 &lt; 7&amp;8'\n   * }\n   */\n  function normalizeRCData(rcdata) {\n    return rcdata\n        .replace(looseAmpRe, '&amp;$1')\n        .replace(ltRe, '&lt;')\n        .replace(gtRe, '&gt;');\n  }\n\n  // TODO(felix8a): validate sanitizer regexs against the HTML5 grammar at\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/syntax.html\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/parsing.html\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/tokenization.html\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/tree-construction.html\n\n  // We initially split input so that potentially meaningful characters\n  // like '<' and '>' are separate tokens, using a fast dumb process that\n  // ignores quoting.  Then we walk that token stream, and when we see a\n  // '<' that's the start of a tag, we use ATTR_RE to extract tag\n  // attributes from the next token.  That token will never have a '>'\n  // character.  However, it might have an unbalanced quote character, and\n  // when we see that, we combine additional tokens to balance the quote.\n\n  var ATTR_RE = new RegExp(\n    '^\\\\s*' +\n    '([-.:\\\\w]+)' +             // 1 = Attribute name\n    '(?:' + (\n      '\\\\s*(=)\\\\s*' +           // 2 = Is there a value?\n      '(' + (                   // 3 = Attribute value\n        // TODO(felix8a): maybe use backref to match quotes\n        '(\\\")[^\\\"]*(\\\"|$)' +    // 4, 5 = Double-quoted string\n        '|' +\n        '(\\')[^\\']*(\\'|$)' +    // 6, 7 = Single-quoted string\n        '|' +\n        // Positive lookahead to prevent interpretation of\n        // <foo a= b=c> as <foo a='b=c'>\n        // TODO(felix8a): might be able to drop this case\n        '(?=[a-z][-\\\\w]*\\\\s*=)' +\n        '|' +\n        // Unquoted value that isn't an attribute name\n        // (since we didn't match the positive lookahead above)\n        '[^\\\"\\'\\\\s]*' ) +\n      ')' ) +\n    ')?',\n    'i');\n\n  // false on IE<=8, true on most other browsers\n  var splitWillCapture = ('a,b'.split(/(,)/).length === 3);\n\n  // bitmask for tags with special parsing, like <script> and <textarea>\n  var EFLAGS_TEXT = html4.eflags['CDATA'] | html4.eflags['RCDATA'];\n\n  /**\n   * Given a SAX-like event handler, produce a function that feeds those\n   * events and a parameter to the event handler.\n   *\n   * The event handler has the form:{@code\n   * {\n   *   // Name is an upper-case HTML tag name.  Attribs is an array of\n   *   // alternating upper-case attribute names, and attribute values.  The\n   *   // attribs array is reused by the parser.  Param is the value passed to\n   *   // the saxParser.\n   *   startTag: function (name, attribs, param) { ... },\n   *   endTag:   function (name, param) { ... },\n   *   pcdata:   function (text, param) { ... },\n   *   rcdata:   function (text, param) { ... },\n   *   cdata:    function (text, param) { ... },\n   *   startDoc: function (param) { ... },\n   *   endDoc:   function (param) { ... }\n   * }}\n   *\n   * @param {Object} handler a record containing event handlers.\n   * @return {function(string, Object)} A function that takes a chunk of HTML\n   *     and a parameter.  The parameter is passed on to the handler methods.\n   */\n  function makeSaxParser(handler) {\n    // Accept quoted or unquoted keys (Closure compat)\n    var hcopy = {\n      cdata: handler.cdata || handler['cdata'],\n      comment: handler.comment || handler['comment'],\n      endDoc: handler.endDoc || handler['endDoc'],\n      endTag: handler.endTag || handler['endTag'],\n      pcdata: handler.pcdata || handler['pcdata'],\n      rcdata: handler.rcdata || handler['rcdata'],\n      startDoc: handler.startDoc || handler['startDoc'],\n      startTag: handler.startTag || handler['startTag']\n    };\n    return function(htmlText, param) {\n      return parse(htmlText, hcopy, param);\n    };\n  }\n\n  // Parsing strategy is to split input into parts that might be lexically\n  // meaningful (every \">\" becomes a separate part), and then recombine\n  // parts if we discover they're in a different context.\n\n  // TODO(felix8a): Significant performance regressions from -legacy,\n  // tested on\n  //    Chrome 18.0\n  //    Firefox 11.0\n  //    IE 6, 7, 8, 9\n  //    Opera 11.61\n  //    Safari 5.1.3\n  // Many of these are unusual patterns that are linearly slower and still\n  // pretty fast (eg 1ms to 5ms), so not necessarily worth fixing.\n\n  // TODO(felix8a): \"<script> && && && ... <\\/script>\" is slower on all\n  // browsers.  The hotspot is htmlSplit.\n\n  // TODO(felix8a): \"<p title='>>>>...'><\\/p>\" is slower on all browsers.\n  // This is partly htmlSplit, but the hotspot is parseTagAndAttrs.\n\n  // TODO(felix8a): \"<a><\\/a><a><\\/a>...\" is slower on IE9.\n  // \"<a>1<\\/a><a>1<\\/a>...\" is faster, \"<a><\\/a>2<a><\\/a>2...\" is faster.\n\n  // TODO(felix8a): \"<p<p<p...\" is slower on IE[6-8]\n\n  var continuationMarker = {};\n  function parse(htmlText, handler, param) {\n    var m, p, tagName;\n    var parts = htmlSplit(htmlText);\n    var state = {\n      noMoreGT: false,\n      noMoreEndComments: false\n    };\n    parseCPS(handler, parts, 0, state, param);\n  }\n\n  function continuationMaker(h, parts, initial, state, param) {\n    return function () {\n      parseCPS(h, parts, initial, state, param);\n    };\n  }\n\n  function parseCPS(h, parts, initial, state, param) {\n    try {\n      if (h.startDoc && initial == 0) { h.startDoc(param); }\n      var m, p, tagName;\n      for (var pos = initial, end = parts.length; pos < end;) {\n        var current = parts[pos++];\n        var next = parts[pos];\n        switch (current) {\n        case '&':\n          if (ENTITY_RE_2.test(next)) {\n            if (h.pcdata) {\n              h.pcdata('&' + next, param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n            pos++;\n          } else {\n            if (h.pcdata) { h.pcdata(\"&amp;\", param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<\\/':\n          if (m = /^([-\\w:]+)[^\\'\\\"]*/.exec(next)) {\n            if (m[0].length === next.length && parts[pos + 1] === '>') {\n              // fast case, no attribute parsing needed\n              pos += 2;\n              tagName = m[1].toLowerCase();\n              if (h.endTag) {\n                h.endTag(tagName, param, continuationMarker,\n                  continuationMaker(h, parts, pos, state, param));\n              }\n            } else {\n              // slow case, need to parse attributes\n              // TODO(felix8a): do we really care about misparsing this?\n              pos = parseEndTag(\n                parts, pos, h, param, continuationMarker, state);\n            }\n          } else {\n            if (h.pcdata) {\n              h.pcdata('&lt;/', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<':\n          if (m = /^([-\\w:]+)\\s*\\/?/.exec(next)) {\n            if (m[0].length === next.length && parts[pos + 1] === '>') {\n              // fast case, no attribute parsing needed\n              pos += 2;\n              tagName = m[1].toLowerCase();\n              if (h.startTag) {\n                h.startTag(tagName, [], param, continuationMarker,\n                  continuationMaker(h, parts, pos, state, param));\n              }\n              // tags like <script> and <textarea> have special parsing\n              var eflags = html4.ELEMENTS[tagName];\n              if (eflags & EFLAGS_TEXT) {\n                var tag = { name: tagName, next: pos, eflags: eflags };\n                pos = parseText(\n                  parts, tag, h, param, continuationMarker, state);\n              }\n            } else {\n              // slow case, need to parse attributes\n              pos = parseStartTag(\n                parts, pos, h, param, continuationMarker, state);\n            }\n          } else {\n            if (h.pcdata) {\n              h.pcdata('&lt;', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<\\!--':\n          // The pathological case is n copies of '<\\!--' without '-->', and\n          // repeated failure to find '-->' is quadratic.  We avoid that by\n          // remembering when search for '-->' fails.\n          if (!state.noMoreEndComments) {\n            // A comment <\\!--x--> is split into three tokens:\n            //   '<\\!--', 'x--', '>'\n            // We want to find the next '>' token that has a preceding '--'.\n            // pos is at the 'x--'.\n            for (p = pos + 1; p < end; p++) {\n              if (parts[p] === '>' && /--$/.test(parts[p - 1])) { break; }\n            }\n            if (p < end) {\n              if (h.comment) {\n                var comment = parts.slice(pos, p).join('');\n                h.comment(\n                  comment.substr(0, comment.length - 2), param,\n                  continuationMarker,\n                  continuationMaker(h, parts, p + 1, state, param));\n              }\n              pos = p + 1;\n            } else {\n              state.noMoreEndComments = true;\n            }\n          }\n          if (state.noMoreEndComments) {\n            if (h.pcdata) {\n              h.pcdata('&lt;!--', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<\\!':\n          if (!/^\\w/.test(next)) {\n            if (h.pcdata) {\n              h.pcdata('&lt;!', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          } else {\n            // similar to noMoreEndComment logic\n            if (!state.noMoreGT) {\n              for (p = pos + 1; p < end; p++) {\n                if (parts[p] === '>') { break; }\n              }\n              if (p < end) {\n                pos = p + 1;\n              } else {\n                state.noMoreGT = true;\n              }\n            }\n            if (state.noMoreGT) {\n              if (h.pcdata) {\n                h.pcdata('&lt;!', param, continuationMarker,\n                  continuationMaker(h, parts, pos, state, param));\n              }\n            }\n          }\n          break;\n        case '<?':\n          // similar to noMoreEndComment logic\n          if (!state.noMoreGT) {\n            for (p = pos + 1; p < end; p++) {\n              if (parts[p] === '>') { break; }\n            }\n            if (p < end) {\n              pos = p + 1;\n            } else {\n              state.noMoreGT = true;\n            }\n          }\n          if (state.noMoreGT) {\n            if (h.pcdata) {\n              h.pcdata('&lt;?', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '>':\n          if (h.pcdata) {\n            h.pcdata(\"&gt;\", param, continuationMarker,\n              continuationMaker(h, parts, pos, state, param));\n          }\n          break;\n        case '':\n          break;\n        default:\n          if (h.pcdata) {\n            h.pcdata(current, param, continuationMarker,\n              continuationMaker(h, parts, pos, state, param));\n          }\n          break;\n        }\n      }\n      if (h.endDoc) { h.endDoc(param); }\n    } catch (e) {\n      if (e !== continuationMarker) { throw e; }\n    }\n  }\n\n  // Split str into parts for the html parser.\n  function htmlSplit(str) {\n    // can't hoist this out of the function because of the re.exec loop.\n    var re = /(<\\/|<\\!--|<[!?]|[&<>])/g;\n    str += '';\n    if (splitWillCapture) {\n      return str.split(re);\n    } else {\n      var parts = [];\n      var lastPos = 0;\n      var m;\n      while ((m = re.exec(str)) !== null) {\n        parts.push(str.substring(lastPos, m.index));\n        parts.push(m[0]);\n        lastPos = m.index + m[0].length;\n      }\n      parts.push(str.substring(lastPos));\n      return parts;\n    }\n  }\n\n  function parseEndTag(parts, pos, h, param, continuationMarker, state) {\n    var tag = parseTagAndAttrs(parts, pos);\n    // drop unclosed tags\n    if (!tag) { return parts.length; }\n    if (h.endTag) {\n      h.endTag(tag.name, param, continuationMarker,\n        continuationMaker(h, parts, pos, state, param));\n    }\n    return tag.next;\n  }\n\n  function parseStartTag(parts, pos, h, param, continuationMarker, state) {\n    var tag = parseTagAndAttrs(parts, pos);\n    // drop unclosed tags\n    if (!tag) { return parts.length; }\n    if (h.startTag) {\n      h.startTag(tag.name, tag.attrs, param, continuationMarker,\n        continuationMaker(h, parts, tag.next, state, param));\n    }\n    // tags like <script> and <textarea> have special parsing\n    if (tag.eflags & EFLAGS_TEXT) {\n      return parseText(parts, tag, h, param, continuationMarker, state);\n    } else {\n      return tag.next;\n    }\n  }\n\n  var endTagRe = {};\n\n  // Tags like <script> and <textarea> are flagged as CDATA or RCDATA,\n  // which means everything is text until we see the correct closing tag.\n  function parseText(parts, tag, h, param, continuationMarker, state) {\n    var end = parts.length;\n    if (!endTagRe.hasOwnProperty(tag.name)) {\n      endTagRe[tag.name] = new RegExp('^' + tag.name + '(?:[\\\\s\\\\/]|$)', 'i');\n    }\n    var re = endTagRe[tag.name];\n    var first = tag.next;\n    var p = tag.next + 1;\n    for (; p < end; p++) {\n      if (parts[p - 1] === '<\\/' && re.test(parts[p])) { break; }\n    }\n    if (p < end) { p -= 1; }\n    var buf = parts.slice(first, p).join('');\n    if (tag.eflags & html4.eflags['CDATA']) {\n      if (h.cdata) {\n        h.cdata(buf, param, continuationMarker,\n          continuationMaker(h, parts, p, state, param));\n      }\n    } else if (tag.eflags & html4.eflags['RCDATA']) {\n      if (h.rcdata) {\n        h.rcdata(normalizeRCData(buf), param, continuationMarker,\n          continuationMaker(h, parts, p, state, param));\n      }\n    } else {\n      throw new Error('bug');\n    }\n    return p;\n  }\n\n  // at this point, parts[pos-1] is either \"<\" or \"<\\/\".\n  function parseTagAndAttrs(parts, pos) {\n    var m = /^([-\\w:]+)/.exec(parts[pos]);\n    var tag = {};\n    tag.name = m[1].toLowerCase();\n    tag.eflags = html4.ELEMENTS[tag.name];\n    var buf = parts[pos].substr(m[0].length);\n    // Find the next '>'.  We optimistically assume this '>' is not in a\n    // quoted context, and further down we fix things up if it turns out to\n    // be quoted.\n    var p = pos + 1;\n    var end = parts.length;\n    for (; p < end; p++) {\n      if (parts[p] === '>') { break; }\n      buf += parts[p];\n    }\n    if (end <= p) { return void 0; }\n    var attrs = [];\n    while (buf !== '') {\n      m = ATTR_RE.exec(buf);\n      if (!m) {\n        // No attribute found: skip garbage\n        buf = buf.replace(/^[\\s\\S][^a-z\\s]*/, '');\n\n      } else if ((m[4] && !m[5]) || (m[6] && !m[7])) {\n        // Unterminated quote: slurp to the next unquoted '>'\n        var quote = m[4] || m[6];\n        var sawQuote = false;\n        var abuf = [buf, parts[p++]];\n        for (; p < end; p++) {\n          if (sawQuote) {\n            if (parts[p] === '>') { break; }\n          } else if (0 <= parts[p].indexOf(quote)) {\n            sawQuote = true;\n          }\n          abuf.push(parts[p]);\n        }\n        // Slurp failed: lose the garbage\n        if (end <= p) { break; }\n        // Otherwise retry attribute parsing\n        buf = abuf.join('');\n        continue;\n\n      } else {\n        // We have an attribute\n        var aName = m[1].toLowerCase();\n        var aValue = m[2] ? decodeValue(m[3]) : '';\n        attrs.push(aName, aValue);\n        buf = buf.substr(m[0].length);\n      }\n    }\n    tag.attrs = attrs;\n    tag.next = p + 1;\n    return tag;\n  }\n\n  function decodeValue(v) {\n    var q = v.charCodeAt(0);\n    if (q === 0x22 || q === 0x27) { // \" or '\n      v = v.substr(1, v.length - 2);\n    }\n    return unescapeEntities(stripNULs(v));\n  }\n\n  /**\n   * Returns a function that strips unsafe tags and attributes from html.\n   * @param {function(string, Array.<string>): ?Array.<string>} tagPolicy\n   *     A function that takes (tagName, attribs[]), where tagName is a key in\n   *     html4.ELEMENTS and attribs is an array of alternating attribute names\n   *     and values.  It should return a record (as follows), or null to delete\n   *     the element.  It's okay for tagPolicy to modify the attribs array,\n   *     but the same array is reused, so it should not be held between calls.\n   *     Record keys:\n   *        attribs: (required) Sanitized attributes array.\n   *        tagName: Replacement tag name.\n   * @return {function(string, Array)} A function that sanitizes a string of\n   *     HTML and appends result strings to the second argument, an array.\n   */\n  function makeHtmlSanitizer(tagPolicy) {\n    var stack;\n    var ignoring;\n    var emit = function (text, out) {\n      if (!ignoring) { out.push(text); }\n    };\n    return makeSaxParser({\n      'startDoc': function(_) {\n        stack = [];\n        ignoring = false;\n      },\n      'startTag': function(tagNameOrig, attribs, out) {\n        if (ignoring) { return; }\n        if (!html4.ELEMENTS.hasOwnProperty(tagNameOrig)) { return; }\n        var eflagsOrig = html4.ELEMENTS[tagNameOrig];\n        if (eflagsOrig & html4.eflags['FOLDABLE']) {\n          return;\n        }\n\n        var decision = tagPolicy(tagNameOrig, attribs);\n        if (!decision) {\n          ignoring = !(eflagsOrig & html4.eflags['EMPTY']);\n          return;\n        } else if (typeof decision !== 'object') {\n          throw new Error('tagPolicy did not return object (old API?)');\n        }\n        if ('attribs' in decision) {\n          attribs = decision['attribs'];\n        } else {\n          throw new Error('tagPolicy gave no attribs');\n        }\n        var eflagsRep;\n        var tagNameRep;\n        if ('tagName' in decision) {\n          tagNameRep = decision['tagName'];\n          eflagsRep = html4.ELEMENTS[tagNameRep];\n        } else {\n          tagNameRep = tagNameOrig;\n          eflagsRep = eflagsOrig;\n        }\n        // TODO(mikesamuel): relying on tagPolicy not to insert unsafe\n        // attribute names.\n\n        // If this is an optional-end-tag element and either this element or its\n        // previous like sibling was rewritten, then insert a close tag to\n        // preserve structure.\n        if (eflagsOrig & html4.eflags['OPTIONAL_ENDTAG']) {\n          var onStack = stack[stack.length - 1];\n          if (onStack && onStack.orig === tagNameOrig &&\n              (onStack.rep !== tagNameRep || tagNameOrig !== tagNameRep)) {\n                out.push('<\\/', onStack.rep, '>');\n          }\n        }\n\n        if (!(eflagsOrig & html4.eflags['EMPTY'])) {\n          stack.push({orig: tagNameOrig, rep: tagNameRep});\n        }\n\n        out.push('<', tagNameRep);\n        for (var i = 0, n = attribs.length; i < n; i += 2) {\n          var attribName = attribs[i],\n              value = attribs[i + 1];\n          if (value !== null && value !== void 0) {\n            out.push(' ', attribName, '=\"', escapeAttrib(value), '\"');\n          }\n        }\n        out.push('>');\n\n        if ((eflagsOrig & html4.eflags['EMPTY'])\n            && !(eflagsRep & html4.eflags['EMPTY'])) {\n          // replacement is non-empty, synthesize end tag\n          out.push('<\\/', tagNameRep, '>');\n        }\n      },\n      'endTag': function(tagName, out) {\n        if (ignoring) {\n          ignoring = false;\n          return;\n        }\n        if (!html4.ELEMENTS.hasOwnProperty(tagName)) { return; }\n        var eflags = html4.ELEMENTS[tagName];\n        if (!(eflags & (html4.eflags['EMPTY'] | html4.eflags['FOLDABLE']))) {\n          var index;\n          if (eflags & html4.eflags['OPTIONAL_ENDTAG']) {\n            for (index = stack.length; --index >= 0;) {\n              var stackElOrigTag = stack[index].orig;\n              if (stackElOrigTag === tagName) { break; }\n              if (!(html4.ELEMENTS[stackElOrigTag] &\n                    html4.eflags['OPTIONAL_ENDTAG'])) {\n                // Don't pop non optional end tags looking for a match.\n                return;\n              }\n            }\n          } else {\n            for (index = stack.length; --index >= 0;) {\n              if (stack[index].orig === tagName) { break; }\n            }\n          }\n          if (index < 0) { return; }  // Not opened.\n          for (var i = stack.length; --i > index;) {\n            var stackElRepTag = stack[i].rep;\n            if (!(html4.ELEMENTS[stackElRepTag] &\n                  html4.eflags['OPTIONAL_ENDTAG'])) {\n              out.push('<\\/', stackElRepTag, '>');\n            }\n          }\n          if (index < stack.length) {\n            tagName = stack[index].rep;\n          }\n          stack.length = index;\n          out.push('<\\/', tagName, '>');\n        }\n      },\n      'pcdata': emit,\n      'rcdata': emit,\n      'cdata': emit,\n      'endDoc': function(out) {\n        for (; stack.length; stack.length--) {\n          out.push('<\\/', stack[stack.length - 1].rep, '>');\n        }\n      }\n    });\n  }\n\n  var ALLOWED_URI_SCHEMES = /^(?:https?|mailto|data)$/i;\n\n  function safeUri(uri, effect, ltype, hints, naiveUriRewriter) {\n    if (!naiveUriRewriter) { return null; }\n    try {\n      var parsed = URI.parse('' + uri);\n      if (parsed) {\n        if (!parsed.hasScheme() ||\n            ALLOWED_URI_SCHEMES.test(parsed.getScheme())) {\n          var safe = naiveUriRewriter(parsed, effect, ltype, hints);\n          return safe ? safe.toString() : null;\n        }\n      }\n    } catch (e) {\n      return null;\n    }\n    return null;\n  }\n\n  function log(logger, tagName, attribName, oldValue, newValue) {\n    if (!attribName) {\n      logger(tagName + \" removed\", {\n        change: \"removed\",\n        tagName: tagName\n      });\n    }\n    if (oldValue !== newValue) {\n      var changed = \"changed\";\n      if (oldValue && !newValue) {\n        changed = \"removed\";\n      } else if (!oldValue && newValue)  {\n        changed = \"added\";\n      }\n      logger(tagName + \".\" + attribName + \" \" + changed, {\n        change: changed,\n        tagName: tagName,\n        attribName: attribName,\n        oldValue: oldValue,\n        newValue: newValue\n      });\n    }\n  }\n\n  function lookupAttribute(map, tagName, attribName) {\n    var attribKey;\n    attribKey = tagName + '::' + attribName;\n    if (map.hasOwnProperty(attribKey)) {\n      return map[attribKey];\n    }\n    attribKey = '*::' + attribName;\n    if (map.hasOwnProperty(attribKey)) {\n      return map[attribKey];\n    }\n    return void 0;\n  }\n  function getAttributeType(tagName, attribName) {\n    return lookupAttribute(html4.ATTRIBS, tagName, attribName);\n  }\n  function getLoaderType(tagName, attribName) {\n    return lookupAttribute(html4.LOADERTYPES, tagName, attribName);\n  }\n  function getUriEffect(tagName, attribName) {\n    return lookupAttribute(html4.URIEFFECTS, tagName, attribName);\n  }\n\n  /**\n   * Sanitizes attributes on an HTML tag.\n   * @param {string} tagName An HTML tag name in lowercase.\n   * @param {Array.<?string>} attribs An array of alternating names and values.\n   * @param {?function(?string): ?string} opt_naiveUriRewriter A transform to\n   *     apply to URI attributes; it can return a new string value, or null to\n   *     delete the attribute.  If unspecified, URI attributes are deleted.\n   * @param {function(?string): ?string} opt_nmTokenPolicy A transform to apply\n   *     to attributes containing HTML names, element IDs, and space-separated\n   *     lists of classes; it can return a new string value, or null to delete\n   *     the attribute.  If unspecified, these attributes are kept unchanged.\n   * @return {Array.<?string>} The sanitized attributes as a list of alternating\n   *     names and values, where a null value means to omit the attribute.\n   */\n  function sanitizeAttribs(tagName, attribs,\n    opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {\n    // TODO(felix8a): it's obnoxious that domado duplicates much of this\n    // TODO(felix8a): maybe consistently enforce constraints like target=\n    for (var i = 0; i < attribs.length; i += 2) {\n      var attribName = attribs[i];\n      var value = attribs[i + 1];\n      var oldValue = value;\n      var atype = null, attribKey;\n      if ((attribKey = tagName + '::' + attribName,\n           html4.ATTRIBS.hasOwnProperty(attribKey)) ||\n          (attribKey = '*::' + attribName,\n           html4.ATTRIBS.hasOwnProperty(attribKey))) {\n        atype = html4.ATTRIBS[attribKey];\n      }\n      if (atype !== null) {\n        switch (atype) {\n          case html4.atype['NONE']: break;\n          case html4.atype['SCRIPT']:\n            value = null;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['STYLE']:\n            if ('undefined' === typeof parseCssDeclarations) {\n              value = null;\n              if (opt_logger) {\n                log(opt_logger, tagName, attribName, oldValue, value);\n\t      }\n              break;\n            }\n            var sanitizedDeclarations = [];\n            parseCssDeclarations(\n                value,\n                {\n                  declaration: function (property, tokens) {\n                    var normProp = property.toLowerCase();\n                    var schema = cssSchema[normProp];\n                    if (!schema) {\n                      return;\n                    }\n                    sanitizeCssProperty(\n                        normProp, schema, tokens,\n                        opt_naiveUriRewriter\n                        ? function (url) {\n                            return safeUri(\n                                url, html4.ueffects.SAME_DOCUMENT,\n                                html4.ltypes.SANDBOXED,\n                                {\n                                  \"TYPE\": \"CSS\",\n                                  \"CSS_PROP\": normProp\n                                }, opt_naiveUriRewriter);\n                          }\n                        : null);\n                    sanitizedDeclarations.push(property + ': ' + tokens.join(' '));\n                  }\n                });\n            value = sanitizedDeclarations.length > 0 ?\n              sanitizedDeclarations.join(' ; ') : null;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['ID']:\n          case html4.atype['IDREF']:\n          case html4.atype['IDREFS']:\n          case html4.atype['GLOBAL_NAME']:\n          case html4.atype['LOCAL_NAME']:\n          case html4.atype['CLASSES']:\n            value = opt_nmTokenPolicy ? opt_nmTokenPolicy(value) : value;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['URI']:\n            value = safeUri(value,\n              getUriEffect(tagName, attribName),\n              getLoaderType(tagName, attribName),\n              {\n                \"TYPE\": \"MARKUP\",\n                \"XML_ATTR\": attribName,\n                \"XML_TAG\": tagName\n              }, opt_naiveUriRewriter);\n              if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['URI_FRAGMENT']:\n            if (value && '#' === value.charAt(0)) {\n              value = value.substring(1);  // remove the leading '#'\n              value = opt_nmTokenPolicy ? opt_nmTokenPolicy(value) : value;\n              if (value !== null && value !== void 0) {\n                value = '#' + value;  // restore the leading '#'\n              }\n            } else {\n              value = null;\n            }\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          default:\n            value = null;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n        }\n      } else {\n        value = null;\n        if (opt_logger) {\n          log(opt_logger, tagName, attribName, oldValue, value);\n        }\n      }\n      attribs[i + 1] = value;\n    }\n    return attribs;\n  }\n\n  /**\n   * Creates a tag policy that omits all tags marked UNSAFE in html4-defs.js\n   * and applies the default attribute sanitizer with the supplied policy for\n   * URI attributes and NMTOKEN attributes.\n   * @param {?function(?string): ?string} opt_naiveUriRewriter A transform to\n   *     apply to URI attributes.  If not given, URI attributes are deleted.\n   * @param {function(?string): ?string} opt_nmTokenPolicy A transform to apply\n   *     to attributes containing HTML names, element IDs, and space-separated\n   *     lists of classes.  If not given, such attributes are left unchanged.\n   * @return {function(string, Array.<?string>)} A tagPolicy suitable for\n   *     passing to html.sanitize.\n   */\n  function makeTagPolicy(\n    opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {\n    return function(tagName, attribs) {\n      if (!(html4.ELEMENTS[tagName] & html4.eflags['UNSAFE'])) {\n        return {\n          'attribs': sanitizeAttribs(tagName, attribs,\n            opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)\n        };\n      } else {\n        if (opt_logger) {\n          log(opt_logger, tagName, undefined, undefined, undefined);\n        }\n      }\n    };\n  }\n\n  /**\n   * Sanitizes HTML tags and attributes according to a given policy.\n   * @param {string} inputHtml The HTML to sanitize.\n   * @param {function(string, Array.<?string>)} tagPolicy A function that\n   *     decides which tags to accept and sanitizes their attributes (see\n   *     makeHtmlSanitizer above for details).\n   * @return {string} The sanitized HTML.\n   */\n  function sanitizeWithPolicy(inputHtml, tagPolicy) {\n    var outputArray = [];\n    makeHtmlSanitizer(tagPolicy)(inputHtml, outputArray);\n    return outputArray.join('');\n  }\n\n  /**\n   * Strips unsafe tags and attributes from HTML.\n   * @param {string} inputHtml The HTML to sanitize.\n   * @param {?function(?string): ?string} opt_naiveUriRewriter A transform to\n   *     apply to URI attributes.  If not given, URI attributes are deleted.\n   * @param {function(?string): ?string} opt_nmTokenPolicy A transform to apply\n   *     to attributes containing HTML names, element IDs, and space-separated\n   *     lists of classes.  If not given, such attributes are left unchanged.\n   */\n  function sanitize(inputHtml,\n    opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {\n    var tagPolicy = makeTagPolicy(\n      opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger);\n    return sanitizeWithPolicy(inputHtml, tagPolicy);\n  }\n\n  // Export both quoted and unquoted names for Closure linkage.\n  var html = {};\n  html.escapeAttrib = html['escapeAttrib'] = escapeAttrib;\n  html.makeHtmlSanitizer = html['makeHtmlSanitizer'] = makeHtmlSanitizer;\n  html.makeSaxParser = html['makeSaxParser'] = makeSaxParser;\n  html.makeTagPolicy = html['makeTagPolicy'] = makeTagPolicy;\n  html.normalizeRCData = html['normalizeRCData'] = normalizeRCData;\n  html.sanitize = html['sanitize'] = sanitize;\n  html.sanitizeAttribs = html['sanitizeAttribs'] = sanitizeAttribs;\n  html.sanitizeWithPolicy = html['sanitizeWithPolicy'] = sanitizeWithPolicy;\n  html.unescapeEntities = html['unescapeEntities'] = unescapeEntities;\n  return html;\n})(html4);\n\nvar html_sanitize = html['sanitize'];\n\n// Loosen restrictions of Caja's\n// html-sanitizer to allow for styling\nhtml4.ATTRIBS['*::style'] = 0;\nhtml4.ELEMENTS['style'] = 0;\nhtml4.ATTRIBS['a::target'] = 0;\nhtml4.ELEMENTS['video'] = 0;\nhtml4.ATTRIBS['video::src'] = 0;\nhtml4.ATTRIBS['video::poster'] = 0;\nhtml4.ATTRIBS['video::controls'] = 0;\nhtml4.ELEMENTS['audio'] = 0;\nhtml4.ATTRIBS['audio::src'] = 0;\nhtml4.ATTRIBS['video::autoplay'] = 0;\nhtml4.ATTRIBS['video::controls'] = 0;\n\nif (typeof module !== 'undefined') {\n    module.exports = html_sanitize;\n}\n","function corslite(url, callback, cors) {\n    var sent = false;\n\n    if (typeof window.XMLHttpRequest === 'undefined') {\n        return callback(Error('Browser not supported'));\n    }\n\n    if (typeof cors === 'undefined') {\n        var m = url.match(/^\\s*https?:\\/\\/[^\\/]*/);\n        cors = m && (m[0] !== location.protocol + '//' + location.domain +\n                (location.port ? ':' + location.port : ''));\n    }\n\n    var x = new window.XMLHttpRequest();\n\n    function isSuccessful(status) {\n        return status >= 200 && status < 300 || status === 304;\n    }\n\n    if (cors && !('withCredentials' in x)) {\n        // IE8-9\n        x = new window.XDomainRequest();\n\n        // Ensure callback is never called synchronously, i.e., before\n        // x.send() returns (this has been observed in the wild).\n        // See https://github.com/mapbox/mapbox.js/issues/472\n        var original = callback;\n        callback = function() {\n            if (sent) {\n                original.apply(this, arguments);\n            } else {\n                var that = this, args = arguments;\n                setTimeout(function() {\n                    original.apply(that, args);\n                }, 0);\n            }\n        }\n    }\n\n    function loaded() {\n        if (\n            // XDomainRequest\n            x.status === undefined ||\n            // modern browsers\n            isSuccessful(x.status)) callback.call(x, null, x);\n        else callback.call(x, x, null);\n    }\n\n    // Both `onreadystatechange` and `onload` can fire. `onreadystatechange`\n    // has [been supported for longer](http://stackoverflow.com/a/9181508/229001).\n    if ('onload' in x) {\n        x.onload = loaded;\n    } else {\n        x.onreadystatechange = function readystate() {\n            if (x.readyState === 4) {\n                loaded();\n            }\n        };\n    }\n\n    // Call the callback with the XMLHttpRequest object as an error and prevent\n    // it from ever being called again by reassigning it to `noop`\n    x.onerror = function error(evt) {\n        // XDomainRequest provides no evt parameter\n        callback.call(this, evt || true, null);\n        callback = function() { };\n    };\n\n    // IE9 must have onprogress be set to a unique function.\n    x.onprogress = function() { };\n\n    x.ontimeout = function(evt) {\n        callback.call(this, evt, null);\n        callback = function() { };\n    };\n\n    x.onabort = function(evt) {\n        callback.call(this, evt, null);\n        callback = function() { };\n    };\n\n    // GET is the only supported HTTP Verb by XDomainRequest and is the\n    // only one supported here.\n    x.open('GET', url, true);\n\n    // Send the request. Sending data is not supported.\n    x.send(null);\n    sent = true;\n\n    return x;\n}\n\nif (typeof module !== 'undefined') module.exports = corslite;\n"]}